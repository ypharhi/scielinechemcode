/*!
 * 
 * SpreadJS Library 14.1.4
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
!function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],a):"object"==typeof exports?exports.Spread=a(require("@grapecity/spread-sheets")):a(GC)}(function(a){a="object"==typeof a?a:{},a.Spread=a.Spread||{},a.Spread.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/pivot/pivot-all-entry.js")}({"./dist/plugins/pivot/pivot-all-entry.js":function(b,c,d){a=a||{},a.Pivot=d("./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js"),a.Spread=a.Spread||{},a.Spread.Pivot=d("./dist/plugins/pivot/pivot-table-entry.js"),b.exports=a.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js"))},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.filterField=0]="filterField",a[a.rowField=1]="rowField",a[a.columnField=2]="columnField",a[a.valueField=3]="valueField"}(d=b.PivotTableFieldType||(b.PivotTableFieldType={})),function(a){a[a.filterField=0]="filterField",a[a.axisField=1]="axisField",a[a.legendField=2]="legendField",a[a.valueField=3]="valueField"}(e=b.PivotChartFieldType||(b.PivotChartFieldType={})),function(a){a[a.fieldAndAreaStacked=0]="fieldAndAreaStacked",a[a.fieldAndAreaBySide=1]="fieldAndAreaBySide",a[a.fieldOnly=2]="fieldOnly",a[a.areaOnlyGrid=3]="areaOnlyGrid",a[a.areaOnlyTable=4]="areaOnlyTable"}(f=b.PivotPanelDirectionEnum||(b.PivotPanelDirectionEnum={})),function(a){a[a.compact=0]="compact",a[a.outline=1]="outline",a[a.tabular=2]="tabular"}(g=b.PivotTableLayoutType||(b.PivotTableLayoutType={})),function(a){a[a.all=0]="all",a[a.button=1]="button",a[a.data=2]="data",a[a.none=3]="none",a[a.normal=4]="normal",a[a.corner=5]="corner",a[a.topEnd=6]="topEnd",a[a.topRight=7]="topRight"}(h=b.PivotAreaType||(b.PivotAreaType={})),function(a){a[a.row=0]="row",a[a.col=1]="col"}(i=b.PivotAreaAxisType||(b.PivotAreaAxisType={})),function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col",a[a.both=3]="both"}(j=b.GrandTotalPosition||(b.GrandTotalPosition={})),function(a){a[a.none=0]="none",a[a.top=1]="top",a[a.bottom=2]="bottom"}(k=b.SubtotalsPosition||(b.SubtotalsPosition={})),function(a){a[a.downThenOver=0]="downThenOver",a[a.overThenDown=1]="overThenDown"}(l=b.DisplayFields||(b.DisplayFields={})),function(a){a[a.fields=1]="fields",a[a.options=2]="options",a[a.filter=4]="filter",a[a.sort=8]="sort",a[a.layout=16]="layout",a[a.showValueAs=32]="showValueAs",a[a.group=64]="group",a[a.styles=128]="styles",a[a.collapse=256]="collapse",a[a.theme=512]="theme",a[a.position=1024]="position"}(m=b.SerializeIndex||(b.SerializeIndex={})),function(a){a[a.fields=1]="fields",a[a.area=2]="area",a[a.viewList=4]="viewList"}(n=b.PivotPanelSection||(b.PivotPanelSection={})),function(a){a[a.stack=0]="stack",a[a.flow=1]="flow"}(o=b.PivotPanelLayoutType||(b.PivotPanelLayoutType={})),function(a){a[a.pt=1]="pt",a[a.value=2]="value"}(p=b.overlapCheck||(b.overlapCheck={}))},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__assign||function(){return D=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},D.apply(this,arguments)},E=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=g.Common.D,l=g.Common.l,m=f.GC$.isEmptyObject,n=new g.Common.ResourceManager(i.SR),o=n.getResource.bind(n),p=g.Common.l,q=g.Common.u.Ob,r=p.Ra,s=p.Xb,t=null,u=g.Common.j.Fa,v=Math.min,w=Math.max,x=void 0,b.throwError=function(a){throw Error(a)},y=function(a){var b,c,e,f,g,h=t,i=a.autoFilter&&a.autoFilter.filterItemMap&&a.autoFilter.filterItemMap[0]&&a.autoFilter.filterItemMap[0].conditions&&a.autoFilter.filterItemMap[0].conditions[0];if(i){switch(i.conType){case 0:i.item1||i.item2?(b=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=b[0],g=b[1]):f=i.expected,h={conType:d.PivotConditionType.caption,operator:i.compareType,val:[f,g]};break;case 1:c=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=c[0],g=c[1],!f||f instanceof Date||(f=s(f)),!g||g instanceof Date||(g=s(g)),h={conType:d.PivotConditionType.date,val:[f,g],operator:i.compareType,isWholeDay:i.isWholeDay};break;case 3:h={conType:d.PivotConditionType.top10,val:i.expected,type:i.compareType,operator:i.type};break;case 2:e=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=e[0],g=e[1],h={conType:d.PivotConditionType.value,val:i.expected?[i.expected]:[f,g],operator:i.compareType}}return h}},z=function(a){var b,c,e,f,g,h,i,j,k,l=t;switch(a.conType){case d.PivotConditionType.caption:b=a.val,c=b[0],e=b[1],l=new d.PivotFilterCaptionCondition(a.operator,c,e);break;case d.PivotConditionType.date:f=a.val,g=f[0],h=f[1],l=new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h);break;case d.PivotConditionType.top10:l=new d.PivotFilterTop10Condition(a.operator,a.type,a.val);break;case d.PivotConditionType.value:i=a.val,j=i[0],k=i[1],l=new d.PivotFilterValueCondition(a.operator,j,k)}return l};function F(a,b,c){var e=-1,f=a.slice();return c&&f.splice(c.valuePositionIndex,0,c),d.vhc(f,function(a,c){if(e===-1&&a.Cj===b)return e=c,!0}),e}b.iNc=F;function G(a,b){var c;return d.vhc(a,function(a,d){if(a.Cj===b)return c=a,!0}),c}function H(a,b){var c;return d.vhc(a,function(a,d){if(a.whc===b)return c=a,!0}),c}A=function(){function a(a,b,c){var d=this;a&&a.textItem&&this.updateLabelTextItem(a.textItem,c.allowMultipleFiltersPerField),a&&a.condition&&this.updateLabelCondition(a.condition,c.allowMultipleFiltersPerField),b&&this.updateValueCondition(b),d.selectMultipleItems=c||{allowMultipleFiltersPerField:!0},d.iOa=!1}return a.prototype.Bhc=function(){var a=this,b=a.labelFilter;if(b){if(b.condition)return!0;if(b.textItem&&!b.textItem.isAll)return!0}return!1},a.prototype.getSlicerItemInfo=function(){var a,b=this.selectMultipleItems,c=this.labelFilter,d=!1,e="";return c&&c.textItem&&c.textItem.list&&(a=c.textItem.list.length,1===a?e=c.textItem.list[0]:a>1&&(d=!0)),{selectMultipleItems:b.allowMultipleFiltersPerField,hasMoreThanOneSelect:d,text:e}},a.prototype.Chc=function(){return!!this.valueFilter},a.prototype.evaluateLabelCondition=function(a){var b,c,e=this;return!e.labelFilter||!e.labelFilter.condition||(b=e.labelFilter.condition,c=a,b.glc===d.PivotConditionType.date&&(c=new Date(a)),e.labelFilter.condition.evaluate(c))},a.prototype.isInLabelFilterItem=function(a){var b=this;return!b.labelFilter||!b.labelFilter.textItem||b.labelFilter.textItem.list.indexOf(a)>-1},a.prototype.updateLabelCondition=function(a,b){var c=this;u(c.labelFilter)&&(c.labelFilter={}),u(a)||(c.labelFilter.condition=z(a)),b||(c.labelFilter.textItem=t),c.iOa=!0},a.prototype.updateLabelTextItem=function(a,b){var c=this;u(c.labelFilter)&&(c.labelFilter={}),u(a)||(c.labelFilter.textItem=a),b||(c.labelFilter.condition=t),c.iOa=!0},a.prototype.updateValueCondition=function(a){var b=this;u(b.valueFilter)&&(b.valueFilter={}),b.valueFilter.condition=z(a.condition),b.valueFilter.conditionByName=a.conditionByName},a.prototype.isMatchedLabelItem=function(a){return this.evaluateLabelCondition(a+"")&&this.isInLabelFilterItem(a)},a.prototype.no=function(){var a=this;a.labelFilter=t,a.valueFilter=t,a.selectMultipleItems=t},a}(),b.PivotViewFilter=A,B=function(){function a(a,b,c,d){var e,f=this;f.whc=b,u(c)?f.Cj=b:f.Cj=c,e=a.jNc(b),f.bGb=e.startValue,f.kNc=e.endValue,f.mi=a.xhc(b),f.OFc=a.lNc(b),f.zhc=a.Ahc(b),f._items=f.CDc(a.yhc(b)),f.ny=a.mNc(b),f.nNc=d}return a.prototype.oNc=function(a){var b=this,c=b.whc,d=a.jNc(c);b.bGb=d.startValue,b.kNc=d.endValue,b.mi=a.xhc(c),b.zhc=a.Ahc(c),b._items=b.CDc(a.yhc(c))},a.prototype.CDc=function(a){var b,c,d=this,e=[],f=d.zhc;for(b=0;b<a.length;b++)c=b,f&&f.length>0&&(c=f[a[b]]),e.push({indexValue:c,value:a[b]});return e},a.prototype.isFilter=function(){var a=this.getFilterInfo();return!!a&&(a.Bhc()||a.Chc())},a.prototype.getFilterInfo=function(){return this.Dhc},a.prototype.setFilterInfo=function(a,b){!u(b)&&u(a)?(u(this.Dhc)&&(this.Dhc={}),1===b?this.Dhc.labelFilter=t:2===b?this.Dhc.valueFilter=t:this.Dhc=t):this.Dhc=a,this.Dhc&&u(this.Dhc.labelFilter)&&u(this.Dhc.valueFilter)&&(this.Dhc=t)},a.prototype.getSubTotalType=function(){return this.Fhc},a.prototype.setSubTotalType=function(a){this.Fhc!==a&&(this.Fhc=a)},a.prototype.getSortInfo=function(){return this.zZ},a.prototype.setSortInfo=function(a){this.zZ=a,this.oDc=a&&a.sortType},a.prototype.toPivotViewSubTotalFields=function(){var a,b,c=t;return this.pNc&&(a=this.whc,b=E(this.pNc,[]),c=D({subtotalType:this.Fhc,cacheName:a,fieldName:this.Cj},b)),{subTotalType:this.Fhc,cacheName:this.whc,valueFieldName:this.Cj,index:this.mi,showDataAs:c}},a.prototype.toPivotViewQueryField=function(a,b,c){var d,e,f,g,h,i,j,k,l=this;return l.Dhc&&l.Dhc.valueFilter&&(d=l.Dhc.valueFilter),e=1===a||2===a,f=2===a,h=l.zZ,l.Dhc&&l.Dhc.Bhc()?(i=void 0,j=!1,k=!1,m(b.rlc)||u(c)||!u(b.tnb)||(j=!0,k=b.Tlc instanceof Date),i=j?k?l.sIc(b,c):l.tIc(b,c):l.VFc(b),{isDim:e,isHeader:f,sourceName:l.whc,displayName:l.Cj,items:i,index:l.mi,isALL:!1,valueFilter:d,sortInfo:h}):{isDim:e,isHeader:f,sourceName:l.whc,displayName:l.Cj,items:g,index:l.mi,isALL:!0,valueFilter:d,sortInfo:h}},a.prototype.VFc=function(a){var b=this,c=[],e=a.getFieldsItemList(),f=a.dic;return d.vhc(e,function(a){if(b.Dhc.isMatchedLabelItem(a,!1)){var d=m(f)?a:f[a];c.push(d)}}),c},a.prototype.tIc=function(a,b){var c,e=this,f=[],g=b.Yic,h=a.getFieldsItemList(),i={},j=e.Dhc;d.vhc(g,function(b){var c=a.Zkc(b);j.evaluateLabelCondition(b+"")?i[c]=!0:i[c]!==!0&&(i[c]=!1)}),d.vhc(h,function(a){j.isInLabelFilterItem(a+"")&&i[a]||(i[a]=!1)});for(c in i)i.hasOwnProperty(c)&&i[c]&&f.push(c);return f},a.prototype.sIc=function(a,b){var c,e=this,f=[],g=b.Yic,h=a.getFieldsItemList(),i=b.hlc,j=b.dic,k={},l=e.Dhc;d.vhc(h,function(a){k[a]=[]}),d.vhc(g,function(b){var c=a.Zkc(b);l.evaluateLabelCondition(b+"")&&(k[c]=d.uIc(k[c],i[j[b]]))}),d.vhc(h,function(a){l.isInLabelFilterItem(a+"")||(k[a].length=0)});for(c in k)k.hasOwnProperty(c)&&k[c].length>0&&f.push(k[c]);return f},a.prototype.Ghc=function(a){},a.prototype.mDc=function(a){switch(a){case e.PivotTableFieldType.rowField:return"axisRow";case e.PivotTableFieldType.columnField:return"axisCol";case e.PivotTableFieldType.filterField:return"axisPage";case e.PivotTableFieldType.valueField:return"axisValues"}},a.prototype.EDc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.indexValue===a)return c},a.prototype.qNc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.value===a)return c},a.prototype.KWc=function(a,b){var c,d,e=this,f=b||e._items;for(c=0;c<f.length;c++)if(d=f[c],d&&d.value===a)return c},a.prototype.WDc=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=[],m=!1,n=a.length,o=[];for(e=0;e<n;e++)if(f=a[e],g=f.indexValue,!u(g)){if(h=k.EDc(g),u(h))continue;u(f.childItems)||(h.childItems=f.childItems),u(f.expanded)||(h.expanded=f.expanded),u(f.drillAcross)||(h.drillAcross=f.drillAcross),u(f.calculatedMember)||(h.calculatedMember=f.calculatedMember),f.hidden===!0?m=!0:l.push(h.value),u(f.missing)||(h.missing=f.missing),u(f.caption)||(h.caption=f.caption),u(f.character)||(h.character=f.character),f.collapse===!0&&c.setCollapse(b,h.value,!0),u(f.type)||(h.type=f.type),o.push(h)}k._items=o,m&&(i=k.Dhc,u(i)&&(i=new A(t,t,c.rNc),k.Dhc=i),j={isAll:!1,list:l},i.updateLabelTextItem(j,c.rNc.allowMultipleFiltersPerField))},a.prototype.fromJson=function(a,b){var c,e,f,g,h,i=this;i.Lqa=a,u(a.name)||(i.Cj=a.name),u(a.items)||(c=b.qo.getPivotCacheByName(b.Ihc),e=c.getField(i.whc),f=e&&2===e.ny&&!u(e.Vlc),i.WDc(a.items,i.Cj,b,f)),u(a.sortType)||(g=a.sortType,h={},"ascending"===g?h.sortType=d.SortType.asc:"descending"===g&&(h.sortType=d.SortType.desc),i.zZ=h,i.oDc=h.sortType),u(a.fld)||(i.mi=a.fld),u(a.baseField)||(i.baseField=a.baseField),u(a.measureFilter)||(i.nDc=a.measureFilter),u(a.numberFormat)||(i.nNc=a.numberFormat),u(a.showAll)||(i.sNc=a.showAll)},a.prototype.XDc=function(a,b,c,d,e,f,g){var h,i,k,l=this,m=g||l._items,n=[],o=0;for(d&&e&&m&&m[0]&&m[0].value!=="<"+j.formatDateToString(e)&&(n.push({indexValue:0}),o=1),h=0;h<m.length;h++)i=m[h],k={},u(i.childItems)||(k.childItems=i.childItems),u(i.expanded)||(k.expanded=i.expanded),u(i.drillAcross)||(k.drillAcross=i.drillAcross),u(i.calculatedMember)||(k.calculatedMember=i.calculatedMember),c[i.value]===!0&&(k.hidden=!0),u(i.missing)||(k.missing=i.missing),u(i.caption)||(k.caption=i.caption),u(i.character)||(k.character=i.character),b&&b[i.value]===!0&&(k.collapse=!0),u(i.type)||(k.type=i.type),u(i.indexValue)||(k.indexValue=d?i.indexValue+o:i.indexValue),n.push(k);return d&&f&&m&&m[m.length-1]&&m[m.length-1].value!==">"+j.formatDateToString(f)&&n.push({indexValue:n.length}),a&&n.push({type:"default"}),n},a.prototype.LWc=function(a){var b,c,d,e,f,g=this,h=a.tNc(g.whc),i=h&&h.bOc();if(i){b=[],c=h.getFieldsItemList(),d=0;for(e in i)i.hasOwnProperty(e)&&(f=i[e],b[f]={indexValue:d,value:c[e]},d+=1)}return b},a.prototype.toJson=function(a){var b,c,f,g,h,i,j,k,l,m,n=this,o=n.Lqa?n.Lqa:{},p=a.layoutType(),q=a.vic;switch(p){case e.PivotTableLayoutType.outline:o.compact=!1,delete o.outline;break;case e.PivotTableLayoutType.tabular:o.compact=!1,o.outline=!1;break;case e.PivotTableLayoutType.compact:delete o.outline,delete o.compact}if(b=a.vic,o.axis=n.mDc(b.Ohc[n.Cj]),u(a.options.subTotalsPosition)||(o.defaultSubtotal=a.options.subTotalsPosition!==e.SubtotalsPosition.none&&x),o.insertBlankRow=a.options.insertBlankLineAfterEachItem,u(n.nDc)||(o.measureFilter=n.nDc),u(n.whc)||(o.name=n.whc),u(n.oDc)||(c=void 0,n.oDc===d.SortType.asc?c="ascending":n.oDc===d.SortType.desc&&(c="descending"),o.sortType=c),o.subtotalTop=a.options.subTotalsPosition!==e.SubtotalsPosition.bottom&&x,u(n.mi)||(o.fld=n.mi),u(n.nNc)||(o.numberFormat=n.nNc),o.showAll=!!n.sNc&&n.sNc,!u(n._items)&&K(n.Cj,q)&&n._items.length>0){if(f=q.Xhc&&q.Xhc[n.Cj],g=q.getLabelFilterInfo(n.Cj),h=g&&g.textItem&&g.textItem.list,i={},h&&h.length>0){for(j=0;j<n._items.length;j++)i[n._items[j].value]=!0;for(j=0;j<h.length;j++)i[h[j]]=!1}k=q.tNc(n.whc),l=k&&2===k.ny&&!u(k.Vlc),m=n.LWc(q),o.items=n.XDc(a.options.subTotalsPosition!==e.SubtotalsPosition.none,f,i,l,k.Tlc,k.Ulc,m)}return o},a.prototype.Hhc=function(){var a=this;a.zZ=t,a._items=t,a.zhc=t,a.nNc=t,a.pNc=t,a.Lqa=t,u(a.Dhc)||a.Dhc.no()},a}(),b.PivotViewField=B,C=function(){function a(a,b,c,d){var e=this;e.Cj=a,e.Ihc=b,e.qo=c,e.wu=d,e.Jhc=[],e.Khc=[],e.Lhc=[],e.Mhc=[],e.Nhc=[],e.Ohc={},e.zZ={},e.AFc=[],e.rNc={allowMultipleFiltersPerField:!0}}return a.prototype.uNc=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc);return b.getDataRefer()},a.prototype.vNc=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc),c=[];return b&&(c=b.getHeaderList()),c},a.prototype.wNc=function(a,b,c){var d=this,e=d.AFc,f=e.indexOf(a);f>-1&&e.splice(f,1),b&&(u(c)?e.push(a):e.splice(c,0,a))},a.prototype.setSigmaValuePosition=function(a,b){var c=this,e=c.getSigmaValuePosition(),f=e.positionType,g=e.positionIndex;u(a)||a!==d.DataPosition.row&&a!==d.DataPosition.col||(c.Qhc=a),!u(b)&&b>=0&&(c.Rhc=b),c.RVa({position:f,valuesIndex:g,type:"updateValuePosition"})},a.prototype.getSigmaValuePosition=function(){var a=this,b=a.Mhc.length>1,c=a.Rhc;return{positionType:a.Qhc,positionIndex:c,display:b}},a.prototype.xNc=function(a,b){var c,d=this,e=d.getFieldInfoByName(a);if(e){if(c=e.getSubTotalType(),1===arguments.length)return c;if(c===b)return;e.setSubTotalType(b),d.Ehc=!0,this.RVa({fieldName:a,subtotalType:c,type:"subTotalType"})}},a.prototype.yNc=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;if(!u(a)){for(b=a.fieldsInfo,c=0;c<=3;c++)n.yDc(c);for(n.setSigmaValuePosition(a.valueInfo.positionType,a.valueInfo.positionIndex),d=0;d<4;d++)for(e=b[d],f=0;f<e.length;f++)g=e[f],h=g.sourceName,i=g.displayName,j=g.subtotal,n.addFieldByName(h,i,d,j);for(c=0;c<4;c++)for(e=b[c],f=0;f<e.length;f++)g=e[f],h=g.sourceName,k=g.valueFilter,l=g.labelFilter,m=g.sortInfo,!l||u(l.condition)&&u(l.textItem)||n.setLabelFilterInfo(h,l),k&&!u(k.condition)&&n.setValueFilterInfo(h,k),u(m)||n.setSortInfo(h,m)}},a.prototype.zNc=function(){var a,b,c,d,e,f,g=this,h=[],i=g.getSigmaValuePosition();for(a=0;a<4;a++){for(b=g.Shc(a),c=[],d=0;d<b.length;d++)e=b[d],f={sourceName:e.whc,displayName:e.Cj},f.subtotal=e.Fhc,f.labelFilter=g.getLabelFilterInfo(e.Cj),f.valueFilter=g.getValueFilterInfo(e.Cj),f.sortInfo=e.zZ,c.push(f);h[a]=c}return{fieldsInfo:h,valueInfo:i}},a.prototype.ANc=function(a){var b,c,e,f,g,h,i,j=this,l=j.hic,m=l._Fc,n={},o=[],p=!0,q={},r={},s=j.qo.getPivotCacheByName(j.Ihc);if(!u(l)){if(d.vhc(a,function(a){b=j.BNc(a.fieldName),r[a.fieldName]=b.ny,q[a.fieldName]=u(b.IDc)?b.Yic:b.Ykc,n[a.fieldName]=a.fieldItem}),u(n))c=!0;else{for(f=0,g=l.hic;f<g.length;f++){h=g[f],p=!0,e=h.path;for(i in n)if(k(n,i)&&q[i][e[m[i]]]!==n[i]){p=!1;break}p&&(o=o.concat(h.indexes))}c=!1}return s.CNc(o,c)}},a.prototype.BNc=function(a){var b=this;return b.tNc(b.getFieldInfoByName(a).whc)},a.prototype.DNc=function(a){var b=this,c=b.Ihc,d=b.qo.getPivotCacheByName(c),e=b.Cj,f={cmd:"updatePivotCache",sheetName:a.name(),cmdOption:{pivotCacheName:c,pivotCache:d,ptName:e}};b.wu.execute(f),b.HL=x},a.prototype.ENc=function(){var a=this;a.FNc(),a.Ehc=!0,a.Thc()},a.prototype.FNc=function(){var a,b=this,c=b.Shc(),d=c.length,e=b.Ihc,f=b.qo.getPivotCacheByName(e);for(a=0;a<d;a++)f.$Sb(c[a].whc)?c[a].oNc(b):(b.xDc(c[a].Cj),b.XWc(c[a].Cj))},a.prototype.XWc=function(a){var b,c=this,d=c.HL;if(d&&d.length>0)for(b=d.length-1;b>=0;b--)d[b].Cj===a&&d.splice(b,1)},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldNameList=function(){return this.qo.getPivotCacheByName(this.Ihc).getAllFieldsNames()},a.prototype.clone=function(){var b=this,c=new a(b.Cj,b.Ihc,b.qo,b.wu),d=j.GNc(b.Jhc),e=j.GNc(b.Khc),f=j.GNc(b.Lhc),g=j.GNc(b.Mhc),h=j.GNc(b.Ohc);return c.Jhc=d?d:[],c.Khc=e?e:[],c.Lhc=f?f:[],c.Mhc=g?g:[],c.Ohc=h?h:[],c.Nhc=[].concat(b.Nhc),c.Qhc=b.Qhc,c.Rhc=b.Rhc,c},a.prototype.getAllFieldInfo=function(){var a=this,b=a.getAllFieldNameList(),c=[];return d.vhc(b,function(b){var d=a.pDc(b);d?c.push({fieldName:d.Cj,sourceName:b,isFilter:d.isFilter(),isDims:!0}):c.push({fieldName:b,sourceName:b,isFilter:!1,isDims:!1})}),c},a.prototype.getFieldInfoByName=function(a){var b=this,c=b.Ohc[a],d=b.Shc(c);return d?G(d,a):t},a.prototype.HNc=function(a){var b,c,d=this,e=d.HL;if(e)for(b=e.length,c=0;c<b;c++)if(a===e[c].Cj)return e[c]},a.prototype.pDc=function(a){var b=this,c=b.Shc();return c?H(c,a):t},a.prototype.addPivotView=function(a){this.Nhc.push(a),this.Thc()},a.prototype.removePivotView=function(a){var b,c;for(b=0;b<this.Nhc.length;b++)if(c=this.Nhc[b],c===a)return void this.Nhc.splice(b,1);0===this.Nhc.length&&this.dispose()},a.prototype.Thc=function(a){var b,c,d;for(b=0;b<this.Nhc.length;b++)c=this.Nhc[b],d=c instanceof h.PivotTable,a&&d||d&&c.Lia>0||c.paint(a)},a.prototype.Uhc=function(){var a,b;for(a=0;a<this.Nhc.length;a++)b=this.Nhc[a],b instanceof h.PivotTable&&b.adjustRange()},a.prototype.INc=function(a,b){var c=this.qo.getPivotCacheByName(this.Ihc),d=c.$Sb(a);return u(d)||(b=d.Cj),b},a.prototype.JNc=function(a,b,c){var e=this.qo.getPivotCacheByName(this.Ihc),f=e.$Sb(a);return u(c)&&(c=f.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count),u(f)||(b=f.Cj),o()["SubtotalType_Prefix_"+c]+b},a.prototype.Whc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc),c=b.$Sb(a);return c.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count},a.prototype.getSortInfo=function(a){return this.zZ[a]},a.prototype.setSortInfo=function(a,b){var c,e=this,f=j.GNc(e.zZ[a]),g=e.getFieldInfoByName(a);b&&b.sortValueFieldName&&(c=e.getFieldInfoByName(b.sortValueFieldName),b.cacheName=c&&c.whc,b.sortValueSubtotalText=d.SubtotalType[c.Fhc]),e.zZ[a]=b,g.setSortInfo(b),this.Ehc=!0,e.RVa({type:"setSortInfo",fieldName:a,sortInfo:f})},a.prototype.clearSortInfo=function(a){var b,c=this,d=j.GNc(c.zZ[a]);delete c.zZ[a],b=c.getFieldInfoByName(a),b.setSortInfo(t),this.Ehc=!0,c.RVa({type:"setSortInfo",fieldName:a,sortInfo:d})},a.prototype.setCollapse=function(a,b,c){var d,e=this.Xhc;e||(e=this.Xhc={}),e[a]||(e[a]={}),d=e[a][b],e[a][b]=c,this.RVa({fieldName:a,item:b,isCollapse:d,type:"setCollapse"})},a.prototype.getCollapse=function(a,b){var c=this.Xhc;return c&&c[a]?c[a][b]:t},a.prototype.addField=function(a,c,f){var g,h,i,j;(c>3||c<0)&&b.throwError("wrong area code"),g=this,h=g.Shc(c),g.OWc(a.Cj)&&c!==e.PivotTableFieldType.valueField||(u(f)?f=h.length:(i=this.getSigmaValuePosition(),j={1:d.DataPosition.row,2:d.DataPosition.col},i.display&&j[c]===i.positionType&&(f<=i.positionIndex?g.setSigmaValuePosition(i.positionType,i.positionIndex+1):f--)),g.$hc(h,a,c,f),g.Ohc[a.Cj]=c,0!==c&&(g.Ehc=!0))},a.prototype.KNc=function(a){var b,c,d,e=2,f=this;if(!u(a)){for(b=a.substr(a.length-1,1),c="_",isNaN(+b)&&(c=""),d=a;f.Ohc[a]&&!(e>100);)a=d+c+e,e++;return a}},a.prototype.changeFieldName=function(a,b){var c=a.Cj,d=this.Ohc[a.Cj];return b=q(b),!(u(b)||""===b||!b)&&(this.Ohc[c]===e.PivotTableFieldType.valueField&&this.changeValueFilterName(c,b),this.changeValueArray(c,b),c&&b&&b.length>0&&(a.Cj=b,delete this.Ohc[c],this.Ohc[a.Cj]=d),this.RVa({fieldName:b,oldFieldName:c,type:"changeFieldName"}),!0)},a.prototype.changeValueArray=function(a,b){var c=this,e=c.AFc;d.vhc(e,function(c,d){c===a&&(e[d]=b)})},a.prototype.changeValueFilterName=function(a,b){var c,d,e=this;for(d=0;d<4;d++)c=e.Shc(d),c.forEach(function(c){c.Dhc&&c.Dhc.valueFilter&&c.Dhc.valueFilter.conditionByName===a&&(c.Dhc.valueFilter.conditionByName=b)})},a.prototype.isFieldExist=function(a){return!u(this.Ohc[a])},a.prototype.isFieldActualExist=function(a){var b,c,d=this.qo.Plc[this.Ihc];if(!u(d)){for(b=d.ulc,c=0;c<b.length;c++)if(b[c].name===a)return!0;return!1}},a.prototype.RFc=function(a){var b=this.getFieldInfoByName(a);return this.mNc(b.whc)},a.prototype.mNc=function(a){var b=this.tNc(a);return b.ny},a.prototype.SFc=function(a){var b=this.getFieldInfoByName(a),c=this.tNc(b.whc);return c.plc()},a.prototype.refreshShowDataAs=function(a,b,c){var d,e,f,g=this,i=g.Nhc;for(d=0,e=i;d<e.length;d++)f=e[d],f instanceof h.PivotTable&&f.MWc(a,b,c)},a.prototype.changeFieldArea=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o=this,p=o.Ohc[a],q=o.BNc(a);if((!q||u(q.Yw)||b===e.PivotTableFieldType.valueField)&&!(p<0||u(p)||o.OWc(a)&&b!==e.PivotTableFieldType.valueField)){if(f=o.Shc(p),g=F(f,a),h=o.getSigmaValuePosition(),h.display&&h.positionType===b-1&&h.positionIndex===g&&g===c&&p===b)return void o.setSigmaValuePosition(h.positionType,h.positionIndex+1);d=o.getFieldInfoByName(a),d&&o.refreshShowDataAs(a,!1,b),b===e.PivotTableFieldType.valueField&&p!==e.PivotTableFieldType.valueField&&(i=o.KNc(o.JNc(d.whc,a)),o.changeFieldName(d,i),o.xNc(d.Cj,o.Whc(d.whc))),b!==e.PivotTableFieldType.valueField&&p===e.PivotTableFieldType.valueField&&(o.clearValueFilterOfValueField(d.Cj),o.xNc(d.Cj,t)),d=o.xDc(d.Cj),h=o.getSigmaValuePosition(),j=h.display,k=h.positionType,l=h.positionIndex,b===p&&g<c&&(m=v(g,c),n=w(g,c),j&&k===b-1&&l<=m&&l>n&&c--),b!==e.PivotTableFieldType.valueField&&p===e.PivotTableFieldType.valueField&&(d.Cj=d.whc),o.addField(d,b,c),b===e.PivotTableFieldType.filterField&&o.Uhc()}},a.prototype.removeFieldOrSigmaByName=function(a){var b=this,c;return a===o().sigmaValue?(b.yDc(e.PivotTableFieldType.valueField),o().sigmaValue):(c=b.getFieldInfoByName(a),c&&b.refreshShowDataAs(a,!0),c=b.xDc(a))},a.prototype.xDc=function(a){var b,c,e=this,f=e.Ohc[a],g=e.Shc(f),h=F(g,a);if(!(u(f)||h<0))return b=e.getSigmaValuePosition(),c={1:d.DataPosition.row,2:d.DataPosition.col},b.display&&b.positionType===c[f]&&b.positionIndex>h&&e.setSigmaValuePosition(b.positionType,b.positionIndex-1),e.LNc(a)},a.prototype.LNc=function(a){var b=this,c=b.Ohc[a],d=b.Shc(c),e=F(d,a);return delete b.Ohc[a],b.Ehc=!0,b.MNc(c,e)},a.prototype.EWc=function(a){var b=this,c=b.Shc(e.PivotTableFieldType.valueField);d.vhc(c,function(c){c.pNc&&c.pNc.baseFieldName===a&&(d.vhc(b.Nhc,function(a){0===a.FWc&&j.GWc(a,c.Cj,c.pNc.showDataAs)}),delete c.pNc)})},a.prototype.clearValueFilterOfValueField=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.rowField;c<=e.PivotTableFieldType.columnField;c++)for(b=f.Shc(c),d=b.length-1;d>=0;d--)u(b[d].Dhc)||u(b[d].Dhc.valueFilter)||b[d].Dhc.valueFilter.conditionByName!==a||f.clearFilterInfo(b[d].Cj,2);f.Ehc=!0},a.prototype.yDc=function(a){var b,c=this,d=c.Shc(a);if(!u(d)&&d.length>0){for(b=d.length-1;b>=0;b--)c.refreshShowDataAs(d[b].Cj,!0),c.xDc(d[b].Cj);c.Ehc=!0}},a.prototype.$hc=function(a,b,c,f){var g,h=this;u(f)?a.push(b):(g=a.length,f=v(g,f),f=w(0,f),a.splice(f,0,b)),c===e.PivotTableFieldType.valueField&&(u(h.Qhc)&&(h.Qhc=d.DataPosition.col),u(h.Rhc)&&(h.Rhc=0)),h.RVa({fieldName:b.Cj,area:c,index:f,type:"removeField"})},a.prototype.MNc=function(a,b){var c,d,e,f,g=this,h=g.Shc(a);return u(b)||b<0||b>=h.length?void 0:(c=h.splice(b,1)[0],u(c)||(d=void 0,e=void 0,f=c.Dhc,f&&(f.labelFilter&&(d=f.labelFilter.condition?f.labelFilter.condition.toJSON():{textItem:D({},f.labelFilter.textItem)}),e=f.valueFilter?{conditionByName:f.valueFilter.conditionByName,condition:f.valueFilter.condition.toJSON()}:t),g.RVa({fieldName:c.Cj,sourceName:c.whc,labelFilter:d,valueFilter:e,sortInfo:j.GNc(c.zZ),subtotalType:c.Fhc,valueFilterIndex:this.AFc.indexOf(c.Cj),area:a,index:b,type:"addField"})),c)},a.prototype.NNc=function(a){var b=this,c=b.qo.getPivotCacheByName(b.Ihc);c.removeCalcField(a),b.Ehc=!0},a.prototype.Shc=function(a){var b=this;switch(a){case 0:return b.Lhc;case 1:return b.Jhc;case 2:return b.Khc;case 3:return b.Mhc;default:return[].concat(this.Jhc,this.Khc,this.Lhc,this.Mhc)}},a.prototype.getLabelQueryField=function(){var a=this,b=a.cic(),c=[];return d.vhc(b,function(b){var d=a.qo.getPivotCacheByName(a.Ihc),e=d.$Sb(b.whc),f=u(e.IDc)?void 0:d.$Sb(e.IDc);b.Dhc&&b.Dhc.iOa&&(a.Ehc=!0,b.Dhc.iOa=!1),c.push(b.toPivotViewQueryField(a.Ohc[b.Cj],e,f))}),c},a.prototype.eic=function(){var a={};return d.vhc(this.Jhc,function(b){var c=b.Cj;a[c]=1}),d.vhc(this.Khc,function(b){var c=b.Cj;a[c]=2}),a},a.prototype.getSubtotalQueryField=function(){var a=this.fic(),b=[],c={};return d.vhc(a,function(a){b.push(a.toPivotViewSubTotalFields()),c[a.Cj]=a.getSubTotalType()}),{valueFieldsSubtotalMap:c,queryFields:b}},a.prototype.getSortMap=function(a){var b=this,c={},e={};return d.vhc(a,function(a){var f,g,h,i,j,k,l,m=a.sourceName,n=a.sortInfo,o={};if(!u(n))if(n.customSortInfo){if(f=b.tNc(m),g=f.ny,h=f.plc(),i=f.TFc(),j=n.customSortInfo(h.concat(),{sortType:d.SortType.custom,isDate:g===d.PivotDataType.date}),j&&j.length>0){for(k=0,l=j.length;k<l;k++)o[i[j[k]]]=k;c[m]=o}}else e[m]=n.sortType}),{customSortMap:c,normalSortMap:e}},a.prototype.cic=function(){return[].concat(this.Jhc,this.Khc,this.Lhc)},a.prototype.fic=function(){return this.Mhc},a.prototype.xhc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).mi},a.prototype.lNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc).$Sb(a);return b.OFc?b.OFc:b.mi},a.prototype.jNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc).$Sb(a);return u(b)?{}:{startValue:b.Tlc,endValue:b.Ulc}},a.prototype.yhc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).getFieldsItemList()},a.prototype.Ahc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).dic},a.prototype.tNc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a)},a.prototype.queryItem=function(){var a,b,c,d,e,f=this,g=f.getLabelQueryField(),h=f.getSubtotalQueryField(),i=h.valueFieldsSubtotalMap,j=h.queryFields,k=f.getSortMap(g),l=k.customSortMap,m=k.normalSortMap,n=f.Ihc,o=f.qo,p=f.getSigmaValuePosition();return(f.Ehc||u(f.hic))&&(f.hic=o.queryItem(n,g,j,p),f.Ehc=!1),a=f.iic(g),b=a.list,c=a.header,d=a.rowHeader,e={valuePositionInfo:p,valueFieldLength:j.length},f.hic&&f.hic.BFc(f.qo.Plc[n],b,c,d,g,e,f.ZDc(),i,f.AFc,this.toShowDataAsContextList(j),l,m)},a.prototype.toShowDataAsContextList=function(a){var b=this,c=[],e=this.qo.getPivotCacheByName(this.Ihc);return d.vhc(a,function(a){var d,f,g,h,i,j,k,l,m,n,o,p;a.showDataAs&&(d=a.showDataAs,f=d.showDataAs,g=d.cacheName,h=d.baseFieldItemType,i=d.baseFieldName,j=d.baseFieldItem,k=d.fieldName,l=d.subtotalType,m=void 0,i&&j&&(n=b.getFieldInfoByName(i),o=e.$Sb(n.whc),p=o.TFc(),m=p?p[j]:j),c.push({showDataAs:f,cacheName:g,fieldName:k,baseFieldName:i,baseFieldItemType:h,baseFieldItem:j,subtotalType:l,baseFieldItemShared:m}))}),c},a.prototype.ZDc=function(){var a,b,c,d,e,f,g,h,i=this,j={};for(a in i.Xhc)if(i.Xhc.hasOwnProperty(a)){if(b=i.qo.getPivotCacheByName(i.Ihc),u(b))continue;if(c=i.getFieldInfoByName(a),u(c))continue;if(d=b.$Sb(c.whc),u(d))continue;if(e=d.TFc(),f=i.Xhc[a],g=void 0,u(e))j[a]=D({},f);else{for(h in f)f.hasOwnProperty(h)&&(g||(g={}),g[e[h]]=f[h]);j[a]=g}}return j},a.prototype.iic=function(a){var b=[],c=[],e=[];return d.vhc(a,function(a){var d=a.displayName,f=a.isDim,g=a.isHeader;f&&(b.push(d),g||e.push(d)),g&&c.push(d)}),{list:b,header:c,rowHeader:e}},a.prototype.jic=function(a,b){var c=this,e=this.qo,f=e.getPivotCacheByName(c.Ihc);return b?d.kic([f.lic(a),f.mic(b)]).length>0:f.lic(a).length>0},a.prototype.nic=function(a){var b=a.cmdOption.pivotName,c=this.oic(b);return!u(c)&&!u(c.qo)&&(a.sheetName=c.qo.name(),void this.wu.execute(a))},a.prototype.oic=function(a){var b,c,d,e=this.Nhc;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.Cj===a&&d instanceof h.PivotTable)return d;return t},a.prototype.ONc=function(){var a,b=this.Nhc;for(a=0;a<b.length;a++)if(b[a]instanceof h.PivotTable)return{sheet:b[a].qo,ptName:b[a].Cj}},a.prototype.pic=function(){var a=this,b=a.getAllFieldInfo().slice(0),c=a.Shc(0).slice(0),d=a.Shc(1).slice(0),e=a.Shc(2).slice(0),f=a.Shc(3).slice(0),g=a.getSigmaValuePosition();return{allField:b,rowField:d,colField:e,valueField:f,filterField:c,valuePosition:g}},a.prototype.addFieldByName=function(a,c,d,f,g,h){var i,j,k,l,m,n,p,r=this;for((d>3||d<0)&&b.throwError("wrong area code"),j=r.tNc(a),k=e.PivotTableFieldType.columnField;k>=e.PivotTableFieldType.filterField;k--)if(i=r.Shc(k),l=H(i,a),!u(l)&&d!==e.PivotTableFieldType.valueField)return void r.changeFieldArea(l.Cj,d,g);c=q(c),u(j)||c===o().sigmaValue||(m=new B(r,a,c,h),d===e.PivotTableFieldType.valueField&&(!u(c)&&u(r.Ohc[c])||(n=r.JNc(a,c,f),
p=r.KNc(n),r.changeFieldName(m,p)),u(f)?m.setSubTotalType(r.Whc(a)):m.setSubTotalType(f)),r.addField(m,d,g),d===e.PivotTableFieldType.filterField&&r.Uhc())},a.prototype.PWc=function(a,b,c,d,e,f){var g,h,i,j=this,k=j.tNc(a);b=q(b),u(k)||b===o().sigmaValue||(g=new B(j,a,b,f),!u(b)&&u(j.Ohc[b])||(h=j.JNc(a,b,d),i=j.KNc(h),j.changeFieldName(g,i)),u(d)?g.setSubTotalType(j.Whc(a)):g.setSubTotalType(d),j.addField(g,c,e))},a.prototype.RUa=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;switch(u(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),b=a.type){case"updateValuePosition":c=a.position,d=a.valuesIndex,this.setSigmaValuePosition(c,d);break;case"subTotalType":this.xNc(a.fieldName,a.subtotalType);break;case"setSortInfo":u(a.sortInfo)?this.clearSortInfo(a.fieldName):this.setSortInfo(a.fieldName,a.sortInfo);break;case"setCollapse":this.setCollapse(a.fieldName,a.item,a.isCollapse);break;case"changeFieldName":e=this.getFieldInfoByName(a.fieldName),e&&(this.changeFieldName(e,a.oldFieldName),this.Ehc=!0);break;case"removeField":this.MNc(a.area,a.index),delete this.Ohc[a.fieldName];break;case"addField":f=a.fieldName,g=a.sourceName,h=a.labelFilter,i=a.valueFilter,j=a.sortInfo,k=a.subtotalType,l=a.area,m=a.index,n=a.valueFilterIndex,o=new B(this,g,f),p=this.Shc(l),this.$hc(p,o,l,m),this.Ohc[f]=l,this.xNc(f,k),this.Ohc[o.Cj]=l,u(h)||this.setLabelFilterInfo(f,h),u(i)||this.setValueFilterInfo(f,i,n),u(j)||this.setSortInfo(a.fieldName,a.sortInfo),0!==l&&(this.Ehc=!0);break;case"setLabelFilter":u(a.filterInfo)?this.clearFilterInfo(a.fieldName,1):this.setLabelFilterInfo(a.fieldName,a.filterInfo);break;case"setValueFilter":u(a.filterInfo)?this.clearFilterInfo(a.fieldName,2):this.setValueFilterInfo(a.fieldName,a.filterInfo,a.index);break;case"group":q=a.oldGroupInfo,r=a.groupSourceFieldName,q?this.uic(q):this.WFc(r);break;case"ungroup":this.uic(a.groupInfo);break;case"addValueFilter":u(a.filter)?this.clearFilterInfo(a.fieldName,2):this.setValueFilterInfo(a.fieldName,a.filter,a.index)}},a.prototype.RVa=function(a){var b,c,e,f=this.ONc(),g=f&&f.sheet;g&&(b=g.getParent(),d.vhc(this.Nhc,function(a){if(a instanceof h.PivotTable)return c=a,!0}),u(b.PNc)&&c&&c.getRange&&(b.PNc={range:c&&c.getRange()}),e=g.ITa,e.QNc(this,a))},a.prototype.getLabelFilterInfo=function(a){var b,c,d,e=this.getFieldInfoByName(a),f=e.getFilterInfo();if(!u(f)&&(b=e.getFilterInfo().labelFilter,!u(b)))return b&&b.condition&&(c=b.condition.toJSON()),b&&b.textItem&&(d=b.textItem),{condition:c,textItem:d}},a.prototype.setLabelFilterInfo=function(a,b){var c,d,e=this,f=e.getFieldInfoByName(a);u(f)||!u(b)&&Object.keys(b).length<1||(c=f.getFilterInfo(),c&&c.labelFilter&&(d={},c.labelFilter.condition&&(d.condition=c.labelFilter.condition.toJSON()),c.labelFilter.textItem&&(d.textItem=D({},c.labelFilter.textItem))),u(b)?f.setFilterInfo(t,1):(c||(c=new A(b,t,e.rNc),f.Dhc=c),b.condition?(1===b.condition.conType&&e.aGc(f.whc,b),c.updateLabelCondition(b.condition,e.rNc.allowMultipleFiltersPerField)):c.labelFilter&&(c.labelFilter.condition&&1===c.labelFilter.condition.glc&&e.aGc(f.whc,t),delete c.labelFilter.condition),b.textItem?c.updateLabelTextItem(b.textItem,e.rNc.allowMultipleFiltersPerField):c.labelFilter&&delete c.labelFilter.textItem,f.Dhc.Chc()&&!e.rNc.allowMultipleFiltersPerField&&f.setFilterInfo(t,2)),e.Ehc=!0,this.RVa({type:"setLabelFilter",fieldName:a,filterInfo:d}))},a.prototype.aGc=function(a,b){var c,d,e,f,g,h=this,i=h.qo.getPivotCacheByName(h.Ihc);if(!u(i)&&(c=i.bGc(a),!u(c)&&c.length>0))for(d=0,e=c.length;d<e;d++)f=h.getFieldInfoByName(c[d].Cj),u(f)||(g=f.getFilterInfo(),g||(g=new A(b,t,h.rNc),f.Dhc=g),g.updateLabelCondition(b&&b.condition,h.rNc.allowMultipleFiltersPerField))},a.prototype.getValueFilterInfo=function(a){var b,c,d=this.getFieldInfoByName(a);return d&&d.getFilterInfo()&&d.getFilterInfo().valueFilter&&d.getFilterInfo().valueFilter.condition?(b=d.getFilterInfo().valueFilter.condition.toJSON(),c=d.getFilterInfo().valueFilter.conditionByName,{condition:b,conditionByName:c}):void 0},a.prototype.setValueFilterInfo=function(a,b,c){var d,e=this.getFieldInfoByName(a),f=this,g=e.getFilterInfo();u(e)||!u(b)&&Object.keys(b).length<1||(u(c)&&(c=this.AFc.indexOf(a)===-1?t:this.AFc.indexOf(a)),g&&g.valueFilter&&(d={conditionByName:g.valueFilter.conditionByName,condition:g.valueFilter.condition.toJSON()}),u(b)?(e.setFilterInfo(t,2),f.wNc(a,!1)):(g?g.updateValueCondition(b):(g=new A(t,b,f.rNc),e.Dhc=g),g.valueFilter.conditionBySourceName=this.getFieldInfoByName(b.conditionByName).whc,f.wNc(a,!0,c),e.Dhc.Bhc()&&!f.rNc.allowMultipleFiltersPerField&&e.setFilterInfo(t,1)),e.nDc=!0,this.Ehc=!0,this.RVa({type:"setValueFilter",fieldName:a,index:c,filterInfo:d}))},a.prototype.clearFilterInfo=function(a,b){var c=this,d=c.getFieldInfoByName(a);d.Dhc&&(1===b?c.setLabelFilterInfo(a,t):2===b?c.setValueFilterInfo(a,t,t):(c.setValueFilterInfo(a,t,t),c.setLabelFilterInfo(a,t)),d.nDc=!1,c.Ehc=!0)},a.prototype.RNc=function(a){this.rNc.allowMultipleFiltersPerField=a},a.prototype.refresh=function(a){this.Thc(a)},a.prototype.fromJson=function(a,b){var c,d,e,f,g,h,i=this,j=i.qo;for(i.Lqa=a,c=a.fields,i.HL=[],d=j.getPivotCacheByCacheId(+a.cacheId),i.Ihc=d.Cj,e=d.getAllFieldsNames(),(a.multipleFieldFilters||a.multipleFieldFilters===x)&&(i.rNc.allowMultipleFiltersPerField=!0),f=0;f<e.length;f++)g=new B(i,e[f],c[f].name),g.fromJson(c[f],i),c[f].name=g.Cj,i.HL.push(g),h=g.getSortInfo(),h&&(i.zZ[c[f].name]=h);i.ric(a,b),u(a.pivotFilters)||i.LFc(a.pivotFilters)},a.prototype.LFc=function(a){var b,c,d,e,f,g,h,i,j,k=this;for(b=0;b<a.length;b++)if(c=a[b],d=k.HL&&k.HL[c.fld]){if(e=c.iMeasureFld||0,f=k.Mhc&&k.Mhc[e],g=c.conType,h=y(c),i=f&&f.Cj,u(h)&&u(i))continue;j={condition:h,conditionByName:f&&f.Cj},0===g||1===g?k.setLabelFilterInfo(d.Cj,j):2!==g&&3!==g||k.setValueFilterInfo(d.Cj,j)}},a.prototype.ric=function(a,b){var c,f,g,h,i,k,l,m,n,o,p,q,r,s=this,t={columnFields:e.PivotTableFieldType.columnField,rowFields:e.PivotTableFieldType.rowField};for(c in t)if(t.hasOwnProperty(c))for(f=a[c],g=0;g<f.length;g++)f[g]!==-2?(h=s.HL[f[g]],s.addField(h,t[c])):(s.Qhc="columnFields"===c?d.DataPosition.col:d.DataPosition.row,s.Rhc=g);for(i=a.pageFields,g=0;g<i.length;g++)k=i[g],l=s.HL[k.fld],s.addField(l,e.PivotTableFieldType.filterField);for(m=a.dataFields,n=s.qo.getPivotCacheByName(s.Ihc).getAllFieldsNames(),g=0;g<m.length;g++)o=m[g],s.PWc(n[o.fld],o.name,e.PivotTableFieldType.valueField,I(o.subtotal),x,o.numberFormat),o.showDataAs&&(p=void 0,q=d.PivotShowDataAs[o.showDataAs],r={showDataAs:q},j.applyShowDataAsStyle(b,o.name,q),u(o.baseField)||(p=s.pDc(n[o.baseField]),u(p)||(r.baseFieldName=p.Cj)),u(o.baseItem)||(1048828===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.previous:1048829===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.next:0!==o.baseItem&&p&&p._items&&(r.baseFieldItemType=d.PivotShowDataAsBaseItemType.item,r.baseFieldItem=p._items[o.baseItem]&&p._items[o.baseItem].value)),s.getFieldInfoByName(o.name).pNc=r)},a.prototype.qDc=function(){var a,b=this,c=b.HL,e=b.getAllFieldNameList();u(c)&&(c=b.HL=[]),a={},d.vhc(c,function(b){a[b.Cj]=b}),d.vhc(e,function(d){var e=b.pDc(d);u(e)&&(e=new B(b,d,d,a[d]&&a[d].nNc)),c[e.mi]=e})},a.prototype.toJson=function(a,b){var c,d,e=this;if(u(e.Ihc)||(b.cacheId=e.qo.getPivotCacheByName(e.Ihc).mEc+""),c=e.HL,b.fields=[],c)for(d=0;d<c.length;d++)b.fields.push(c[d].toJson(a));e.toPivotFiltersOOModel(a,b),e.sic(a,b)},a.prototype.toPivotFiltersOOModel=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,s=q.HL,t=[],v=1;if(s)for(c=0;c<s.length;c++)d=s[c],e=d.getFilterInfo(),f=e&&e.labelFilter,g=e&&e.valueFilter,u(f)&&u(g)||(u(f)||(h=void 0,i=[],j={},j.fld=c,v++,j.id=v,j.evalOrder=-1,k=f.condition,u(k)||(l=k.Glc,m=k.getConditionType(),j.operator=l,j.conType=m,n=k._Qa,o=k.aRa,1===m&&(n=n&&r(n),o=o&&r(o)),j.stringValue1=n,j.stringValue2=o,j.iMeasureFld=0,h={conditions:[{compareType:l,conType:m,item1:{expected:n},item2:{expected:o},ignoreCase:!0}]}),u(h)||(i.push(h),j.autoFilter={filterItemMap:i},t.push(j))),u(g)||(h=void 0,i=[],j={},j.fld=c,v++,j.id=v,j.evalOrder=-1,k=g.condition,p=g.conditionByName,j.iMeasureFld=q.tic(p)||0,m=k.getConditionType(),l=k.Glc,j.operator=l,j.conType=m,3===m?(j.operator=k.Nc,h={conditions:[{conType:m,expected:k.Hlc,type:k.Glc,compareType:k.Nc}]}):h={conditions:[{compareType:l,conType:m,item1:{expected:k._Qa},item2:{expected:k.aRa}}]},u(h)||(i.push(h),j.autoFilter={filterItemMap:i},t.push(j))));t.length>0&&(b.pivotFilters=t)},a.prototype.sic=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t={Khc:"columnFields",Jhc:"rowFields"};for(c in t)if(t.hasOwnProperty(c))for(e=s[c],b[t[c]]=[],f=0;f<e.length;f++)b[t[c]].push(e[f].mi);for(s.Mhc&&s.Mhc.length>1&&(s.Qhc===d.DataPosition.row?b.rowFields.splice(s.Rhc,0,-2):s.Qhc===d.DataPosition.col&&b.columnFields.splice(s.Rhc,0,-2)),g=s.Lhc,h=b.pageFields=[],f=0;f<g.length;f++)i=g[f].toJson(a),h.push(i);for(j=s.Mhc,k=b.dataFields=[],f=0;f<j.length;f++)if(l=j[f],m={},m.name=l.Cj,m.subtotal=J(l.Fhc),m.numberFormat=l.nNc,k.push(m),n=j[f].mi,b.fields&&b.fields[n]&&(m.fld=n,b.fields[n].dataField=!0),o=l.pNc,o&&(o.showDataAs&&(m.showDataAs=d.PivotShowDataAs[o.showDataAs]),o.baseFieldName&&(p=s.getFieldInfoByName(o.baseFieldName),m.baseField=p.mi,q=o.baseFieldItemType,!u(q))))if(q===d.PivotShowDataAsBaseItemType.previous)m.baseItem=1048828;else if(q===d.PivotShowDataAsBaseItemType.next)m.baseItem=1048829;else if(q===d.PivotShowDataAsBaseItemType.item)for(r=0;r<p._items.length;r++)if(o.baseFieldItem===p._items[r].value){m.baseItem=r;break}},a.prototype.tic=function(a){var b,c=this.Mhc;for(b=0;b<c.length;b++)if(a===c[b].Cj)return b},a.prototype.uic=function(a){var b,c,e,f=this,g=f.Ihc,h=this.qo,i=h.Plc[f.Ihc].HL;return a.textGroup?(c=a.textGroup.fieldName,d.vhc(Object.keys(i),function(a){if(a===c)return o().PivotTableErrorMessage_DuplicatedFieldName}),b=c):b=a.originFieldName,e=this.SNc(a.originFieldName),e&&this.WFc(a.originFieldName,!0),h.addGroup(g,a)?(this.RVa({oldGroupInfo:e,groupSourceFieldName:b,type:"group"}),this.Ehc=!0,!0):o().PivotTableErrorMessage_InvalidGroup},a.prototype.TNc=function(a,b){var c=this,d=c.Ihc,e=this.qo;e.getPivotCacheByName(d).addCalcField(a,b)},a.prototype.UNc=function(){var a,b,c=this,d=c.Ihc,e=this.qo,f=e.getCalcFields(d),g=[];for(a=0;a<f.length;a++)b=c.pDc(f[a].Cj),b?g.push({fieldName:b.Cj,formula:f[a].Yw}):g.push({fieldName:f[a].Cj,formula:f[a].Yw});return g},a.prototype.OWc=function(a){var b,c=this,d=c.Ihc,e=this.qo,f=c.getFieldInfoByName(a)&&c.getFieldInfoByName(a).whc||a,g=e.getCalcFields(d);if(!u(f))for(b=0;b<g.length;b++)if(g[b].Cj===f)return!0;return!1},a.prototype.zWc=function(a,b,c){var d,e,f,g,h=this;return!u(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(g=h.qo.getPivotCacheByName(h.Ihc).$Sb(a),!g||g.IDc!==b))))},a.prototype.WFc=function(a,b){var c,d,e,f,g,h=this,i=h.qo.getPivotCacheByName(h.Ihc),l=i.getField(a),m=i.VNc;for(d in m)if(k(m,d)&&(e=m[d],h.zWc(a,d,e))){c=j.GNc(e);break}if(!u(l)&&(f=i.XFc(l.Cj),f&&f.length>0))for(g=0;g<f.length;g++)h.rDc(f[g]);h.Ehc=!0,b||this.RVa({groupInfo:c,type:"ungroup",pivotTable:h})},a.prototype.YWc=function(){var a,b,c,d=this,e=d.Shc(),f=d.qo.getPivotCacheByName(d.Ihc);for(a=0,b=e;a<b.length;a++)c=b[a],u(f.getField(c.whc))&&d.removeFieldOrSigmaByName(c.Cj);d.Ehc=!0},a.prototype.WNc=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.Ihc),g=f.VNc;for(c in g)if(k(g,c)&&(d=g[c],e.zWc(a,c,d))){b=j.GNc(d);break}return b},a.prototype.rDc=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.valueField;c>=e.PivotTableFieldType.filterField;c--)for(b=f.Shc(c),d=b.length-1;d>=0;d--)b[d].whc===a&&(c===e.PivotTableFieldType.valueField&&f.clearValueFilterOfValueField(b[d].Cj),f.removeFieldOrSigmaByName(b[d].Cj))},a.prototype.sDc=function(a){var b,c=this,f=this.qo.getPivotCacheByName(this.Ihc).HL,g=f[a].ny;g===d.PivotDataType.number?(b=c.JNc(a),this.addFieldByName(a,b,e.PivotTableFieldType.valueField,d.SubtotalType.sum)):this.addFieldByName(a,a,e.PivotTableFieldType.rowField,t)},a.prototype.BDc=function(a){var b,c,d=this,f=this;if(f.Ohc[a]===e.PivotTableFieldType.valueField)for(c=0;c<4;c++)b=f.Shc(c),b.forEach(function(b){if(b.Dhc&&b.Dhc.valueFilter&&b.Dhc.valueFilter.conditionByName===a){var c=b.Dhc.valueFilter.toJSON();b.Dhc.valueFilter=t,d.RVa({fieldName:b.Cj,filter:c,type:"addValueFilter"})}})},a.prototype.SNc=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.Ihc),g=f.VNc;for(c in g)if(k(g,c)&&(d=g[c],d.textGroup&&d.originFieldName===a||u(d.textGroup)&&d.originFieldName===a)){b=j.GNc(d);break}return b},a.prototype.dispose=function(){var a,b,c,d,e=this;if(e.zZ=t,e.Xhc=t,e.HL=t,e.Lqa=t,e.AFc=t,e.rNc=t,e.Ohc=t,e.qo=t,e.wu=t,!u(e.Nhc)){for(a=0,b=e.Nhc;a<b.length;a++)c=b[a],c&&c.dispose();e.Nhc=t}for(u(e.hic)||e.hic.no(),u(e.copyFieldsModel)||e.copyFieldsModel.dispose(),d=0;d<e.Jhc.length;d++)e.Jhc[d].Hhc();for(d=0;d<e.Khc.length;d++)e.Khc[d].Hhc();for(d=0;d<e.Lhc.length;d++)e.Lhc[d].Hhc();for(d=0;d<e.Mhc.length;d++)e.Mhc[d].Hhc();e.rNc=t},a}(),b.PivotFieldsModel=C;function I(a){switch(a){case"average":return d.SubtotalType.average;case"count":return d.SubtotalType.count;case"countNums":return d.SubtotalType.countNums;case"max":return d.SubtotalType.max;case"min":return d.SubtotalType.min;case"product":return d.SubtotalType.product;case"stdDev":return d.SubtotalType.stdDev;case"stdDevp":return d.SubtotalType.stdDevp;case"var":return d.SubtotalType.varr;case"varp":return d.SubtotalType.varp;default:return d.SubtotalType.sum}}function J(a){switch(a){case d.SubtotalType.average:return"average";case d.SubtotalType.count:return"count";case d.SubtotalType.countNums:return"countNums";case d.SubtotalType.max:return"max";case d.SubtotalType.min:return"min";case d.SubtotalType.product:return"product";case d.SubtotalType.stdDev:return"stdDev";case d.SubtotalType.stdDevp:return"stdDevp";case d.SubtotalType.varr:return"var";case d.SubtotalType.varp:return"varp";default:return"sum"}}function K(a,b){return!u(b.Ohc[a])&&3!==b.Ohc[a]}},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(b,c,d){var e=this;e.Cj=b,c instanceof a?e.vic=c.vic:e.vic=c,e.qo=d}return a.prototype.getName=function(){return this.Cj},a.prototype.paint=function(){this._R.render()},a.prototype.dispose=function(){var a=this;a.vic=null,a._R&&a._R.dispose()},a}();b.PivotView=d},"./dist/plugins/pivot/pivot-definition.js":function(a,b){},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Y=this&&this.__assign||function(){return Y=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Y.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),e=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),f=c("Pivot"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("Core"),j=c("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),k=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),l=c("./dist/plugins/pivot/pivot-util.js"),m=g.Common.u.Ob,n=window,o=document,p=n.jQuery,q="pivotPanel",r="string",s=null,t=void 0,u=g.Common.j.Fa,v=new g.Common.ResourceManager(h.SR),w=v.getResource.bind(v),x=".pivot-panel",y="gc-panel-area-item",z="gc-panel-all-field-item",A=y+"-content",B="gc-panel-defer-layout-right-button",C="gc-panel-bottomBorderStyle",D="gc-panel-topBorderStyle",E="gc-panel-defer-layout-input",F="gc-panel-area-item-icon",G="data-index",H="gc-panel-all-field-filter",I="Pivot-Field-Filter",J="gc-panel-all-field-checkbox",K="gc-panel-all-field",L="gc-panel-collapse",M="gc-panel-selected-view",N="gc-panel-add",O="gc-panel-apply",P="gc-panel-withoutViewList",Q="containViewList",R="containFields",S="containArea",T="gc-panel-views",function(a){a[a.addField=0]="addField",a[a.removeField=1]="removeField",a[a.updateFieldArea=2]="updateFieldArea",a[a.updateValuePosition=3]="updateValuePosition"}(U=b.panelOperation||(b.panelOperation={})),V=function(){function a(a,b,c){void 0===c&&(c=d.PivotPanelLayoutType.stack),this.uXc=b.Cj,this.qo=a,this.Nc=0,this.wic=c,this.wu=b.wu,this.xic=b,this.yic=!1,this.zic=[],this.ad()}return a.prototype.ad=function(){this.LXa()},a.prototype.dispose=function(){var a=this;a.xic=s,a.wu=s,a.zic=s,a.mWc=s,this.qo.innerHTML="",this.qo=t,this.Aic()},a.prototype.LXa=function(){var a,b,c,e=this,f="."+e.uXc,g=e.qo;this.xic.vic&&(i.GC$(e.qo,g).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("dragleave"+x+f,function(){a&&(b=a)}),i.GC$("."+y,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this)),i.GC$(document).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("drop"+x+f,function(c){var d,g,h,j;c.preventDefault(),d=c.clientX,g=c.clientY,!a||d>e.qo.offsetLeft&&d<e.qo.offsetLeft+e.qo.offsetWidth&&g>e.qo.offsetTop&&g<e.qo.offsetTop+e.qo.offsetHeight||u(b)||(h=e.xic.Nhc.Cj,j=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,j.nic({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:h,isSusPaint:e.yic}})),i.GC$(document).unbind("dragover"+x+f),i.GC$(document).unbind("drop"+x+f),a=null})}),i.GC$("."+A,g).bind("dragover"+x+f,function(a){var b,c,d=a.target;d.classList.contains(y)?(b=a.offsetY,c=d.parentElement,i.GC$(c.children).removeClass(C),i.GC$(c.children).removeClass(D),b<d.offsetHeight&&d.classList.add(D)):d.classList.contains(A)&&d.lastElementChild&&d.lastElementChild.classList.add(C)}).bind("dragleave"+x+f,function(){i.GC$("."+y).removeClass(C).removeClass(D)}).bind("drop"+x+f,function(d){var f,g,h,j,k,l,m,n;d.stopPropagation(),k=d.toElement||d.relatedTarget||d.target,k.classList.contains("gc-panel-area-item-label")&&(k=k.parentElement),a&&(h=a.attr("data-sourceName")||a.attr("data-name"),j=i.GC$(a).attr("data-area"),g=k&&parseInt(i.GC$(k).attr("data-area"),10),f=parseInt(i.GC$(k).attr(G),10),0===k.childElementCount?f=0:k.classList.contains("gc-panel-area-item-content")&&(k=k.lastElementChild,f=parseInt(i.GC$(k).attr(G),10),f++),u(j)?(e.yic&&(l=U.addField,e.zic.push({name:h,toArea:g,index:f,type:l})),c=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=e.xic.Nhc.Cj,c.nic({cmd:"AddField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.yic}})):u(g)||(n=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=e.xic.Nhc.Cj,n.nic({cmd:"moveField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.yic}})),a=null,b=null)}),i.GC$("."+z,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this))}),i.GC$("."+K,g).bind("dragenter"+x+f,function(c){c.stopPropagation(),a&&(b=a)}).bind("drop"+x+f,function(){if(!u(b)){e.yic&&e.zic.push({name:b.attr("data-name"),type:U.removeField});var c=e.xic.Nhc.Cj,d=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic;d.nic({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:c,fieldsModel:d,isSusPaint:e.yic}})}a=null,b=null}),i.GC$("."+E,g).bind("click"+x+f,function(a){e.yic=a.target.checked;var b=i.GC$("."+B);e.yic?e.xic.vic&&(e.xic.vic.copyFieldsModel=e.xic.vic.clone()):(e.xic.vic.copyFieldsModel=void 0,e.xic.refresh(e.yic)),b&&b.prop("disabled",!e.yic)}),i.GC$("."+B,g).bind("click"+x+f,function(){var a,b,c;e.yic&&(a=e.xic.vic.copyFieldsModel.zNc(),b=e.xic.Nhc.Cj,c=e.xic.vic,c.nic({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:b,fieldsInfo:a}})),e.xic.refresh(!1)}),i.GC$("."+F,g).bind("click"+f,function(a){var b,c,d,f,g,h,k,l,m;i.GC$(this).hasClass(I)||(b=i.GC$(a.target).parent(),c=b.attr("data-name"),d=+b.attr("data-area"),f=+b.attr(G),g=e.updateOptionForDropDown(c,d,f),h={x:a.clientX,y:a.clientY},k=e.xic.Nhc.Cj,l=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=new j.PivotDropDown(document.body,l,k,c,d,f,e.yic),m.OT(h,g))}),i.GC$("."+z,g).bind("contextmenu"+f,function(a){var b=i.GC$(this),c=b.attr("data-name"),d={x:a.clientX,y:a.clientY},f=e.xic.Nhc.Cj,g=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,h=new j.PivotCacheFieldsDropdownDialog(document.body,g,f,c,null,null,e.yic);return h.OT(d),!1}),i.GC$("."+J,g).bind("click"+f,function(a){var b=i.GC$(a.target).parent(),c=b.attr("data-sourceName"),d=this.checked,f=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,g=e.xic.Nhc.Cj,h={fieldName:c,checked:d,pivotName:g,isSusPaint:e.yic};f.nic({cmd:"changePanelFieldStatus",sheetName:e.xic.Cj,cmdOption:h})}),i.GC$("."+I,g).bind("click"+f,function(a){var b,c,f,g=i.GC$(a.target).parent(),h=g.attr("data-name"),j={x:a.pageX,y:a.pageY},l=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=l.getFieldInfoByName(h),n=e.xic.Nhc.Cj;m&&(b=e.xic.Nhc,b instanceof k.PivotTable&&(c=b.layoutType()===d.PivotTableLayoutType.compact,f={position:j,fieldName:h,fieldsModel:l,isCompact:c,pivotName:n},l.nic({cmd:"CreatePivotFilterDialog",sheetName:e.xic.Cj,cmdOption:f})))}),i.GC$("."+L,g).bind("click"+f,function(a){var b,c=e.xic.vic,d={x:a.pageX,y:a.pageY},f=e.xic.Nhc,g=e.xic.Nhc.Cj,h=100,j=i.GC$("."+T);j&&j.length>0&&j.width()>200&&(h=j.width()-100,h>300&&(h=300)),f&&(b={position:d,pivotName:g,views:f.views,width:h},c.nic({cmd:"CreatePivotViewsListDialog",cmdOption:b}))}),i.GC$("."+N,g).bind("click"+f,function(a){var b,c,d,f,g=i.GC$("#"+M).val();l.XNc(g)&&(g=w().DefaultPivotTableViewName),g=m(g),b=e.xic.Nhc,c=e.xic.vic,d=e.xic.Nhc.Cj,b&&(f={name:g,pivotName:d,views:b.views},c.nic({cmd:"AddPivotView",cmdOption:f}),i.GC$("#"+M).val(""))}),i.GC$("."+O,g).bind("click"+f,function(a){var b,c=i.GC$("#"+M).val(),d=e.xic.vic,f=e.xic.Nhc,g=e.xic.Nhc.Cj;f&&(b={name:c,pivotName:g,views:f.views},d.nic({cmd:"ApplyPivotView",cmdOption:b}))}))},a.prototype.updateOptionForDropDown=function(a,b,c){var d,e=this.yic?this.xic.vic.copyFieldsModel:this.xic.vic,g={1:f.DataPosition.row,2:f.DataPosition.col},h={isSigma:!1,isAlone:!1,location:1,area:b},i=e.getSigmaValuePosition(),j=e.Shc(b),k=0;return i.display&&i.positionType===g[b]&&(k=1),a===w().sigmaValue&&(h.isSigma=!0),d=j.length+k,1===d&&(h.isAlone=!0),0===c?h.location=1:c<d-1?h.location=2:c===d-1&&(h.location=3),h},a.prototype.Aic=function(){var a="."+this.uXc,b=this.qo;i.GC$(document).unbind("dragover"+x+a),i.GC$(document).unbind("drop"+x+a),i.GC$("."+y,b).unbind("dragstart"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$(this.qo,b).unbind("dragover"+x+a),i.GC$(this.qo,b).unbind("dragleave"+x+a),i.GC$("."+A,b).unbind("dragleave"+x+a),i.GC$("."+A,b).unbind("dragover"+x+a),i.GC$("."+A,b).unbind("drop"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$("."+K,b).unbind("drop"+x+a),i.GC$("."+K,b).unbind("dragenter"+x+a),i.GC$("."+E,b).unbind("click"+x+a),i.GC$("."+B,b).unbind("click"+x+a),i.GC$("."+F,b).unbind("click."+a),i.GC$("."+z,b).unbind("contextmenu."+a),i.GC$("."+J,b).unbind("click."+a),i.GC$("."+I,b).unbind("click."+a),i.GC$("."+L,b).unbind("click."+a),i.GC$("."+N,b).unbind("click."+a),i.GC$("."+O,b).unbind("click."+a)},a.prototype.Fva=function(a){var b,c,e,g,h,i,j,k,l,m=a.allField,n=a.rowField,o=a.colField,p=a.valueField,q=a.filterField,r=a.valuePosition;p&&p.length>1&&r.positionType===f.DataPosition.row&&n.splice(r.positionIndex,0,{Cj:w().sigmaValue,mi:r.positionIndex}),p&&p.length>1&&r.positionType===f.DataPosition.col&&o.splice(r.positionIndex,0,{Cj:w().sigmaValue,mi:r.positionIndex}),b=this,c=d.PivotPanelLayoutType[b.wic].toLocaleLowerCase(),e=b.Cic(),g=b.Dic(m),h=b.Eic([q,n,o,p]),i=b.Fic(),j=b.xic.YNc.showViewList?b.ZNc():"",k=b.xic.YNc.showFields?'\n                <div class="gc-panel-fields-section" '+S+'="'+b.xic.YNc.showArea+'">\n                    '+e+"\n                    "+g+"\n                </div>":"",l=b.xic.YNc.showArea?'\n                <div class="gc-panel-areas-section" '+R+'="'+b.xic.YNc.showFields+'">\n                    <span>'+w().PivotPanel_FieldAreaText+'</span>\n                    <div class = "gc-panel-field-area">\n                        '+h+"\n                    </div>\n                    "+i+"\n                </div>\n                ":"",this.qo.innerHTML='\n                <div class="gc-panel gc-panel-'+c+' gc-no-user-select">\n                    <div class='+P+" "+Q+'="'+b.xic.YNc.showViewList+'">\n                        <div class="gc-panel-header">\n                            <h2>'+w().PivotPanel_Title+"</h2>\n                        </div>\n                        "+k+"\n                        "+l+"\n                    </div>\n                    "+j+"\n                </div>\n                "},a.prototype.ZNc=function(){return'\n            <div class="'+T+'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">'+w().Views+'</span>\n                <div style="width: calc(100% - 50px); display: inline-block; border: 1px solid #CBCBCB; white-space: nowrap">\n                    <span class="'+L+'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="'+M+'"/>\n                    <input type="button" class="gc-panel-button '+N+'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button '+O+'" value="\u2714"/>\n                </div>\n            </div>\n            '},a.prototype.Cic=function(){return"\n                <span>"+w().PivotPanel_ReportText+"</span>\n                "},a.prototype.Dic=function(a){var b,c,d,e,f,g,h,i="";if(a)for(b=0,c=a;b<c.length;b++)d=c[b],e=d.fieldName,f=d.sourceName,g=d.isFilter,h=d.isDims,i+=this.Gic(e,f,g,h);return'\n                <div class="gc-panel-all-field">\n                    <ul>\n                        '+i+"\n                    </ul>\n                </div>\n                "},a.prototype.Gic=function(a,b,c,d){return'\n        <li class="'+z+'" data-name="'+a+'" data-sourceName="'+b+'" draggable="true">\n            <input type="checkbox" '+(d?"checked":"")+' class = "'+J+' gc-panel-checkbox"/>\n            <span class="'+(d?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked")+'">'+b+'</span>\n            <span class="'+(F+" "+I)+'"></span>\n            <span class="'+(c?H:"")+'"></span>\n        </li>'},a.prototype.render=function(a){this.Aic(),this.Fva(a),this.LXa()},a.prototype.$b=function(){this.Aic(),this.qo.innerHTML=""},a.prototype.Eic=function(a){var b,c,e,f,g="";for(b=this.wic===d.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3],c=0,e=b;c<e.length;c++)f=e[c],g+=this.Hic(f,a?a[f]:null);return g},a.prototype.Iic=function(a){var b=["Filters","Rows","Columns","Values"],c=b[a];return{title:w()["PivotPanel_"+c+"ItemsTitle"],rowItemClass:c}},a.prototype.Hic=function(a,b){var c=this.Iic(a),d=c.title,e=c.rowItemClass,f="";return b&&(f=this.Jic(b,a)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'+e+'">\n            <div class="gc-panel-area-item-title">\n                <label class="'+F+" gc-panel-area-item-"+e+'"></label>\n                <span>'+d+'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="'+a+'">\n                '+f+"\n            </ul>\n        </section>"},a.prototype.Jic=function(a,b){var c=this,d="";return a.forEach(function(a,e){d+=c.Kic(a.Cj,b,e)}),d},a.prototype.Kic=function(a,b,c){return'\n        <li class="'+y+'" data-name="'+a+'" data-area="'+b+'" data-index="'+c+'" draggable="true">\n            <span class="gc-panel-area-item-label">'+a+'</span>\n            <span class="'+F+'"></span>\n        </li>\n        '},a.prototype.Fic=function(){var a=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '+(a.yic?"checked":"")+">\n                       <label>"+w().PivotPanel_DeferUpdateText+'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" '+(a.yic?"":"disabled")+">"+w().PivotPanel_Update+"</button>\n                </div>\n             "},a.prototype.$Nc=function(a){return u(a)?this.wic:void(this.wic=a)},a}(),W=function(a){X(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.Nc=0,e.FWc=1,e.EIc(d),e._R=new V(d,e),e.YNc={showFields:!0,showArea:!0,showViewList:!0},e.vic&&(e.wu=e.vic.wu,e.Nhc=c,e.vic.addPivotView(e)),e.paint(),e}return b.prototype.EIc=function(a){var b=this;a&&(p&&p(a).data(q,b),i.GC$(a).data(q,b))},b.prototype.attach=function(a){this.detach(),a&&(this.vic=a.vic,this.wu=this.vic.wu,this.vic.addPivotView(this),this.Nhc=a)},b.prototype.detach=function(){this.vic&&(this.vic=null,this.Nhc=null,this.paint())},b.prototype.sectionVisibility=function(a){var b,c;return u(a)?(b=0,this.YNc.showFields&&(b+=d.PivotPanelSection.fields),this.YNc.showArea&&(b+=d.PivotPanelSection.area),this.YNc.showViewList&&(b+=d.PivotPanelSection.viewList),b):(c={showFields:!1,showArea:!1,showViewList:!1},a&d.PivotPanelSection.fields&&(c.showFields=!0),a&d.PivotPanelSection.area&&(c.showArea=!0),a&d.PivotPanelSection.viewList?(i.GC$("."+P).attr("containViewList","true"),c.showViewList=!0):i.GC$("."+P).attr("containViewList","false"),this.YNc=c,void this.refresh(!1))},b.prototype.panelLayout=function(a){var b=this._R.$Nc();return u(a)?b:void(a===d.PivotPanelLayoutType.stack&&b===d.PivotPanelLayoutType.flow?(this._R.$Nc(d.PivotPanelLayoutType.stack),this.refresh(!1)):a===d.PivotPanelLayoutType.flow&&b===d.PivotPanelLayoutType.stack&&(this._R.$Nc(d.PivotPanelLayoutType.flow),this.refresh(!1)))},b.prototype.type=function(a){return 0===arguments.length?this.Nc:void(this.Nc=a)},b.prototype.paint=function(a){var b=this,c=a?this.vic.copyFieldsModel:this.vic,d=b.Nhc&&b.Nhc.views.all();b._R.render(c?Y({},c.pic(),{views:d}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:d})},b.prototype.refresh=function(a){var b=a?this.vic.copyFieldsModel:this.vic;b&&b.Thc(a)},b.prototype.destroy=function(){this.wu=null,this.vic.removePivotView(this),this.vic=null,this._R.dispose()},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),b._R=s,b.wu=s,b.Nhc=s,b.qo=s},b.findControl=function(a){return typeof a===r&&(a=o.getElementById(a)),i.GC$(a).data(q)},b}(e.PivotView),b.PivotPanel=W},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";
function g(a){return 0===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}b.getFilterButtonImageSrc=g,function(a){a[a.noSortFilter=0]="noSortFilter",a[a.ascending=1]="ascending",a[a.descending=2]="descending",a[a.filter=3]="filter",a[a.filterAscend=4]="filterAscend",a[a.filterDescend=5]="filterDescend",a[a.sortAscending=6]="sortAscending",a[a.sortDescending=7]="sortDescending",a[a.checkAll=8]="checkAll",a[a.unCheckAll=9]="unCheckAll",a[a.isChecked=11]="isChecked",a[a.clearAble=12]="clearAble",a[a.clearUnable=13]="clearUnable",a[a.disableRightArrow=14]="disableRightArrow"}(f||(f={}));function h(a,b){return{position:d.ButtonPosition.right,imageSize:{width:18,height:18},options:{configurationNumber:b},imageType:d.ButtonImageType.custom,visibility:d.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:g(a),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}b.getFilterCellButtonInfo=h},"./dist/plugins/pivot/pivot-table-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot.ns.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table-spread.js")),c("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),d(c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js")),d(c("./dist/plugins/pivot/pivot-panel/pivot-panel.js")),d(c("./dist/plugins/pivot/pivot-ui/dropdown-list.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js")),d(c("./dist/plugins/pivot/pivot-ui/filter-dialog.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js")),d(c("./dist/plugins/pivot/sheet-range-to-pivot-area.js"));var e=c("Pivot");b.SortType=e.SortType,c("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Pivot"),g=d.Common.j.Fa,h=function(){function a(a){this.dataTable=[],this.ILa=a,this.Oic=[],this.Nic=[],this.Mic=[],this._Nc={}}return a.prototype.Qic=function(a,b){this.Mic[a]=b},a.prototype.setStartInfo=function(a,b){this.nU=a,this.hF=b},a.prototype.yq=function(a,b,c){var d=this.RTa(a,b,!0);d.value=c},a.prototype.setColCount=function(a){this.OZ=a},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.getColInfoMap=function(){var a,b,c={},d=this.Oic,e=d.length;for(a=0;a<e;a++)d[a]&&(b=d[a].path,d[a].valueFieldName&&(""===b?b=d[a].valueFieldName||"":b+=f.Separator+d[a].valueFieldName||""),c[b]=a);return c},a.prototype.getRange=function(){return new e.Range(this.nU,this.hF,this.Xj,this.OZ)},a.prototype.ge=function(a,b){var c=this.RTa(a,b);return c&&c.value},a.prototype.zn=function(a,b,c){var d=this.RTa(a,b,!0);d.style=c},a.prototype.Gq=function(a,b){var c=this.RTa(a,b);return c&&c.style},a.prototype.Ric=function(a,b,c){var d=this.RTa(a,b,!0);d.fieldName=c},a.prototype.Lic=function(a,b){var c=this.RTa(a,b);return c&&c.fieldName||c&&c.value},a.prototype.Sic=function(a,b){var c=this.RTa(a,b);return c&&c.nodeRefer},a.prototype.RTa=function(a,b,c){var d,e=this.dataTable,f=e[a];if(!f){if(!c)return null;f=this.dataTable[a]=[]}if(d=f[b],!d){if(!c)return null;d=f[b]={}}return d},a.prototype.hZ=function(){this.dataTable=[],this.Oic=[],this.Nic=[],this.Mic=[],this._Nc={},delete this.Xj,delete this.OZ},a.prototype.xhc=function(a){var b,c=this,d=c.Mic;for(b=0;b<d.length;b++)if(c.Mic[b]&&c.Mic[b].fieldName===a)return b},a.prototype.aOc=function(a,b,c,d){var e=this._Nc;g(e[b])&&(e[b]={}),g(e[b][c])&&(e[b][c]={},e[b][c].ranges=[]),e[b][c].level=d,e[b][c].ranges.push(a)},a}(),i=function(){function a(){this.Uic=[new h(0),new h(1),new h(2),new h(3),new h(4)]}return a.prototype.getAllModel=function(){var a=this.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];return{pageModel:b,cornerModel:c,columnModel:d,rowModel:e,contentModel:f}},a.prototype.getModel=function(a){return this.Uic[a]},a.prototype.hZ=function(){var a=this.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];b.hZ(),c.hZ(),d.hZ(),e.hZ(),f.hZ()},a.prototype.getWholeRange=function(){},a.prototype.Vic=function(){},a}(),b.PivotDataModel=i},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table-entry.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),j=c("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),k=c("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),l=c("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),m=c("@grapecity/js-sheets-common"),n=c("./dist/plugins/pivot/pivot.ns.js"),o=c("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),p=c("./dist/plugins/pivot/pivot-util.js"),q=new m.Common.ResourceManager(n.SR),r=q.getResource.bind(q),s=d.Commands.ActionBase,t="PivotOutlineButtonToggle",u=d.Commands.h4,v=m.Common.l,w=m.Common.CultureManager,x="moveField",y="removeField",z="AddField",A="fieldSet",B="CreatePivotFilterDialog",C="updateListBox",D="changePanelFieldStatus",E="filterFieldLabelValue",F="pivotSort",G="ClearCommand",H="updatePivotCache",I="createFilterSecondaryMenu",J="createDialogForLabelFilter",K="OpenPivotFilterDialogCmd",L="updateCondition",M="createDialogForValueFilter",N="updateValueCondition",O="TopTenCondition",P="dialogForDateFilter",Q="openValueFieldSettingDialogCmd",R="UpdatePivotValueFieldCmd",S="UpdatePivotFieldCmd",T="CreatePivotViewsListDialog",U="OpenPivotGroupDialog",V="OpenPivotShowValueAsDialog",W="ApplyPivotView",X="AddPivotView",Y="pivotRefresh",Z="pivotTableGroup",$="pivotTableUnGroup",_="pivotShowDetails",aa="pivotExpand",ba="pivotCollapse",ca="pivotExpandEntireField",da="pivotCollapseEntireField",ea="removePivotGrandTotal",fa="updatePivotDefer",ga="selectWholePivotTable",ha=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],ia=null,ja=void 0,ka=function(a,b,c){var d=a.pivotTables.findPivotTable(b,c),e=ia;return d&&(e=d.getPivotInfoImp(b,c,!1,!1,!0)),{pivotInfo:e,pt:d}};function Ka(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=!1,q=b.Dhc,r=b.zZ,s=!1,t=!1;return q&&q.labelFilter&&(q.labelFilter.condition&&(s=!0),q.labelFilter.textItem&&(t=!0)),f=!!q&&q.Chc(),g=r?r.sortType:ia,0===a.RFc(c)&&(p=!0),h=ia,i=!1,q&&q.labelFilter&&q.labelFilter.textItem&&(h=q.labelFilter.textItem.list,i=q.labelFilter.textItem.isAll),j=a.SFc(c),k=a.RFc(c),l=a.BNc(c),m=l.bOc(),n=(a.Nhc||[]).filter(function(a){return a.Cj===e})[0],o=La(l,j,h,i,m,g,k,n,c),{fieldIsNumber:p,sortInfo:g,hasLabelCondition:s,hasValueCondition:f,fields:o,isColOrRow:d,hasLabelManual:t}}function La(a,b,c,d,e,f,h,i,j){var k,l,n,o,p=[],q=[];if(e){for(l=0;l<b.length;l++)q[e[l]]=b[l];f===g.SortType.desc&&q.reverse()}return n=0===q.length?b:q,o=function(b){var c,d,e,f,k;return h!==g.PivotDataType.date||a.ZFc&&a.ZFc.length>0||!g.Fa(a.IDc)?b+"":(c={labelOnly:!0,references:[{fieldName:j}]},d=i.getStyle(c),e=new Date(b),f=w.q4().DateTimeFormat,k=d&&d.formatter+""||f.shortDatePattern,new m.Formatter.GeneralFormatter(k).format(e))},!c||0===c.length||d?n.forEach(function(a){k=a instanceof Date?{status:!0,value:a,text:o(a)}:{status:!0,value:a,text:a+""},p.push(k)}):n.forEach(function(a){k=a instanceof Date?{status:!0,value:a,text:o(a)}:{status:!0,value:a,text:a+""},c.indexOf(a)<0&&(k.status=!1),p.push(k)}),p}la=function(a,b,c,e,f){var g,h=[],i=function(g){var i,j,k=e[g],l=void 0;3===f?(i=k.colCount>1,l=new d.Range(k.row,k.col,k.rowCount,1)):2===f&&(i=k.rowCount>1,l=new d.Range(k.row,k.col,1,k.colCount)),j=l&&a.pivotTables.getRangePivotAreas(l),j&&j[b].map(function(a){if(a.labelOnly){var b=a.references;i?b.forEach(function(a){h.indexOf(a.items[0])===-1&&h.push(a.items[0])}):b.forEach(function(a){if(a.fieldName===c)for(var b=0;b<a.items.length;b++)h.indexOf(a.items[b])===-1&&h.push(a.items[b])})}})};for(g=0;g<e.length;g++)i(g);return h};function Ma(a,b){var c=0;return a.forEach(function(a,d){if(a.Cj===b)return void(c=d)}),c}function Na(a,b){var c,d,e=a.colHeadFieldInfo,f=a.cornerFieldInfo,h=a.pageFieldInfo,i=a.rowInfos,j=a.colInfos,k=a.activeRowFieldInfo,l=a.activeColFieldInfo,m=a.area,n=a.value,o=a.menuArea,p=a.valueFieldName;switch(m){case 0:c=h&&h.fieldName;break;case 1:1===o?c=n:2===o&&f&&(c=f.fieldName,c===r().sigmaValueTemp&&(c=r().sigmaValue));break;case 2:if(2===o&&e)c=e.fieldName,c===r().sigmaValueTemp&&(c=r().sigmaValue);else if(5===o)c=p||b&&b.Mhc[0].Cj;else if(c=l&&l.name||n,g.Fa(c)){for(d=l;d>=0&&j[d]&&g.Fa(j[d].itemName);)d-=1;c=j[d].fieldName}break;case 3:if(5===o)c=p||b&&b.Mhc[0].Cj;else if(c=k&&k.name||n,g.Fa(c)){for(d=k.index;d>=0&&i[d]&&g.Fa(i[d].itemName);)d-=1;c=i[d].fieldName}break;case 4:c=p}return c}function Oa(a,b){if(b){var c=b.numberGroup;return{isStartActive:g.Fa(c.start),start:g.Fa(c.start)?a.start:c.start,isEndActive:g.Fa(c.end),end:g.Fa(c.end)?a.end:c.end,by:g.Fa(c.by)?10:c.by}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:10}}function Pa(a,b){var c,d,e,f,h;if(b){for(c=b.dateGroups,d=[],e=0,f=c;e<f.length;e++)h=f[e],d.push(h.by);return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:d}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:[g.DateGroupType.months,g.DateGroupType.quarters,g.DateGroupType.years]}}ma=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()&&(a=p.kj,b=p.VQ,c=ka(a,b.row,b.col),e=c.pivotInfo,f=c.pt,e)){g=e.activeRowFieldInfo,h=e.activeColFieldInfo,i=e.area,j=void 0,k=a.ITa,k.startTransaction(),p.Lz(a,!0);try{switch(i){case 2:j=e.colInfos[h&&h.index];break;case 3:j=e.rowInfos[g&&g.index]}l=j.fieldName,m=j.itemName,n=f.collapse(l,m),f.collapse(l,m,!n),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:m,newValue:!n,oldValue:n,pivotTableName:f.Cj}),q=!0}finally{p.Mz(a),o=d.Commands.bWa(a.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],g.ITa.undo(b),c=b.eOc[b.eOc.length-1].value,e=ka(g,f.VQ.row,f.VQ.col).pt,g.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,newValue:c.isCollapse,oldValue:!c.isCollapse,pivotTableName:e.Cj,item:c.item}),h=!0}finally{f.Mz(g,!0)}}return h},b}(s),d.Commands[t]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,ma,b,c)}},na=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A=this,B=!1;if(A.canExecute())if(a=A.kj,b=a.ITa,c=A.VQ.cmdOption,f=c.fieldName,h=c.targetArea,i=c.targetIndex,j=c.isSusPaint,k=c.pivotName,l=a.pivotTables&&a.pivotTables.get(k),m=j?l.vic.copyFieldsModel:l.vic,j)f===r().sigmaValue?(n=m.Shc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,m.setSigmaValuePosition(h-1,i)):m.changeFieldArea(f,h,i),m.Thc(j);else if(b.startTransaction(),A.Lz(a,!0),!g.Fa(f))try{if(f===r().sigmaValue)n=m.Shc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,o=l.dataPosition(),m.setSigmaValuePosition(h-1,i),p=h-1,q=i,s=o.positionType,t=o.positionIndex,p===s&&q===t||a.Wq(d.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:p,newIndex:q,oldArea:s,oldIndex:t,pivotTableName:k});else{if(u=void 0,n=void 0,u=m.getFieldInfoByName(f),g.Fa(u))return!1;for(v=e.PivotTableFieldType.columnField;v>=e.PivotTableFieldType.filterField;v--){for(n=m.Shc(v),w=!1,x=n.length-1;x>=0;x--)if(n[x].whc===u.whc){f=n[x].Cj,w=!0;break}if(w)break}y=l.getField(f),p=h,q=h===y.pivotArea&&y.pivotIndex<i?i-1:i,s=y.pivotArea,t=y.pivotIndex,p===s&&t===q||(l.updateField(f,h,i),a.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f,newArea:p,newIndex:q,oldArea:s,oldIndex:t,pivotTableName:k}))}m.Thc(j),Qa(l,a),B=!0}finally{A.Mz(a),z=d.Commands.bWa(a.name()),A.VQ[z]=b.endTransaction()}return B},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{for(a=d.Commands.bWa(k.name()),b=j.VQ[a],c=k.pivotTables&&k.pivotTables.get(j.VQ.cmdOption.pivotName),e=b.eOc,f=void 0,k.ITa.undo(b),g=0;g<e.length&&(f=e[g].value,"addField"!==f.type&&"updateValuePosition"!==f.type);g++);h=c.getField(f.fieldName),"updateValuePosition"===f.type?(i=c.dataPosition(),k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",newArea:f.position,newIndex:f.valuesIndex,oldArea:i.positionType,oldIndex:i.positionIndex,pivotTableName:j.VQ.cmdOption.pivotName})):k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldArea:h.pivotArea,oldIndex:h.pivotIndex,pivotTableName:j.VQ.cmdOption.pivotName}),l=!0}finally{j.Mz(k,!0)}}return l},b}(s),d.Commands[x]={canUndo:!0,execute:function(a,b,c){return u(a,na,b,c)}};function Qa(a,b){var c=a.getRange(),d=c.page,e=c.content,f=b.getActiveRowIndex(),g=b.getActiveColumnIndex();0!==e.colCount?e.contains(f,g)||b.setActiveCell(e.row,e.col):d&&(d.contains(f,g)||b.setActiveCell(d.row,d.col))}oa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,p,q,s,t,u,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(f)?(m=a.commandOptions,n=m.pivotTableCellInfo,k=b.pivotTables&&b.pivotTables.get(m.pivotTableName),h=k.vic,i=Na(n)):(i=f.fieldName,j=f.isSusPaint,k=b.pivotTables&&b.pivotTables.get(f.pivotName),h=j?k.vic.copyFieldsModel:k.vic),j){if(i===r().sigmaValue)for(p=h.Shc(e.PivotTableFieldType.valueField),q=p.length-1;q>=0;q--)h.clearValueFilterOfValueField(p[q].Cj);s=h.Ohc[i],l=h.removeFieldOrSigmaByName(i),l instanceof o.PivotViewField&&(s===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.wNc(i,!1)),h.Thc(j)}else{c.startTransaction(),w.Lz(b,!0);try{if(t=[],i===r().sigmaValue){for(p=h.Shc(e.PivotTableFieldType.valueField),q=p.length-1;q>=0;q--)h.clearValueFilterOfValueField(p[q].Cj);if(u=h.Shc(e.PivotTableFieldType.valueField),u&&u.length>0)for(q=0;q<u.length;q++)t.push(k.getField(u[q].Cj))}else t.push(k.getField(i));for(l=h.getFieldInfoByName(i),s=h.Ohc[i],l instanceof o.PivotViewField&&(s===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.wNc(i,!1)),l=h.removeFieldOrSigmaByName(i),q=0;q<t.length;q++)b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:t[q].pivotArea,oldIndex:t[q].pivotIndex,newArea:ia,newIndex:ia,pivotTableName:k.Cj});h.Thc(j),Qa(k,b),x=!0}finally{w.Mz(b),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.eOc,e=0;e<c.length;e++)f=c[e],h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldIndex:ia,oldArea:ia,pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(s),d.Commands[y]={canUndo:!0,execute:function(a,b,c){return u(a,oa,b,c)}},pa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l=this,m=!1;if(l.canExecute()){a=l.VQ,b=a.commandOptions,c=l.kj,e=c.ITa,e.startTransaction(),l.Lz(c,!0);try{f=b.pivotTableCellInfo,g=c.pivotTables.get(b.pivotTableName),h=f.area,i=f.menuArea,j=g.options.grandTotalPosition,1===j||2===j?g.options.grandTotalPosition=0:3===j&&(3===h&&5===i?g.options.grandTotalPosition=1:2===h&&5===i&&(g.options.grandTotalPosition=2)),m=!0}finally{l.Mz(c),k=d.Commands.bWa(c.name()),l.VQ[k]=e.endTransaction()}}return m},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[ea]={canUndo:!0,execute:function(a,b,c){return u(a,pa,b,c)}},qa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,q,s,t,u,v,w,x,y,z,A,B=this,C=!1;if(B.canExecute()){a=B.VQ,b=a.cmdOption,c=a.commandOptions,e=B.kj,f=e.ITa,f.startTransaction(),B.Lz(e,!0),h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(b)?(m=c.pivotTableCellInfo,l=e.pivotTables.get(c.pivotTableName),h=l.vic,i=c.subTotalType,k=Na(m,h)):(i=b.subtotalType,k=b.oldFieldName,l=e.pivotTables.get(b.pivotName),h=l.vic),n=h.getFieldInfoByName(k),o=h.xNc(k),j=b&&b.fieldName||!g.Fa(i)&&o!==i&&h.KNc(h.JNc(n.whc,n.Cj,i))||k;try{g.Fa(n)||g.Fa(i)||(q=!0,g.Fa(k)||k===j||(s=h.getFieldInfoByName(k),q=h.changeFieldName(s,j)),q||e.Os(10,r().PivotTableErrorMessage_EmptyFieldName),o!==i&&(h.xNc(j,i),e.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j,oldValue:o,newValue:i,pivotTableName:l.Cj}))),t=void 0,u=void 0,v=void 0,b?(t=b.showValueAsType,u=b.baseField,v=b.baseItem):c&&(t=c.showValueAsType),w=void 0,v?w=0===v.index?{showDataAs:t,baseFieldName:u,baseFieldItemType:2}:1===v.index?{showDataAs:t,baseFieldName:u,baseFieldItemType:1}:{showDataAs:t,baseFieldName:u,baseFieldItemType:0,baseFieldItem:v.value}:u?w={showDataAs:t,baseFieldName:u}:g.Fa(t)||(w={showDataAs:t}),x=h.getFieldInfoByName(j).pNc||{showDataAs:0},y=w&&!this.bXc(w,x),y&&(l.showDataAs(j,w),e.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:j,oldValue:p.GNc(x),newValue:p.GNc(w),pivotTableName:l.Cj})),z=a.formatter,7!==i||z||(z="0.0000000"),g.Fa(l.showDataAs(j))||(t=l.showDataAs(j).showDataAs),p.applyShowDataAsStyle(l,j,t,z),h.Thc(),C=!0}finally{B.Mz(e),A=d.Commands.bWa(e.name()),B.VQ[A]=f.endTransaction()}}return C},b.prototype.bXc=function(a,b){var c=b.showDataAs,d=b.baseFieldName,e=b.baseFieldItem,f=b.baseFieldItemType;return a.showDataAs===c&&a.baseFieldName===d&&a.baseFieldItem===e&&a.baseFieldItemType===f;
},b.prototype.dOc=function(a){var b,c,d;for(b=0,c=ha;b<c.length;b++)if(d=c[b],!g.Fa(a[d]))return!1;return!0},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o=this,q=o.kj,r=!1;if(o.canUndo()){o.Lz(q,!0);try{for(a=d.Commands.bWa(q.name()),b=o.VQ[a],c=b.eOc,e=o.VQ.cmdOption||o.VQ.commandOptions,f=e.pivotTableName||e.pivotName,g=q.pivotTables&&q.pivotTables.get(f),h=g.vic,i=void 0,j=void 0,k=0;k<c.length;k++)l=c[k].value,"showDataAs"===l.type?i=l:"subTotalType"===l.type&&(j=l);q.ITa.undo(b),i&&(m=h.getFieldInfoByName(i.fieldName),m&&(n=m.pNc,q.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:i.fieldName,oldValue:p.GNc(n),newValue:p.GNc(i.oldShowDataAs),pivotTableName:g.Cj}))),j&&q.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j.fieldName,oldValue:h.xNc(j.fieldName),newValue:j.subtotalType,pivotTableName:g.Cj}),r=!0}finally{o.Mz(q,!0)}}return r},b}(s),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return u(a,qa,b,c)}},ra=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ,b=a.cmdOption,c=a.commandOptions,e=p.kj,f=e.ITa,f.startTransaction(),p.Lz(e,!0),h=void 0,i=void 0,j=void 0,k=void 0,g.Fa(b)?(l=c.pivotTableCellInfo,k=e.pivotTables.get(c.pivotTableName),h=k.vic,j=Na(l,h)):(j=b.oldFieldName,k=e.pivotTables.get(b.pivotName),h=k.vic),m=h.getFieldInfoByName(j),i=b&&b.fieldName||h.KNc(h.INc(m.whc,m.Cj))||j;try{n=a.formatter,k&&j!==i&&k.updateFieldName(j,i),this.GHa(k,i,null,n),h.Thc(),q=!0}finally{p.Mz(e),o=d.Commands.bWa(e.name()),p.VQ[o]=f.endTransaction()}}return q},b.prototype.fOc=function(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1},b.prototype.GHa=function(a,b,c,e){var f,g={labelOnly:!0,references:[{fieldName:b}]};f=p.GNc(a.getStyle(g)),f||(f=new d.Style),e?f.formatter=e:(delete f.formatter,p.gOc(f)&&(f=null)),a.setStyle(g,f)},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],c=f.VQ.cmdOption||f.VQ.commandOptions,e=c.pivotTableName||c.pivotName,g.ITa.undo(b),h=!0}finally{f.Mz(g,!0)}}return h},b}(s),d.Commands[S]={canUndo:!0,execute:function(a,b,c){return u(a,ra,b,c)}},sa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p=this,q=!1,r=p.VQ.cmdOption;if(p.canExecute())if(a=r.targetArea,b=r.fieldName,c=r.targetIndex,f=r.pivotName,h=r.isSusPaint,i=p.kj,j=i.ITa,k=i.pivotTables.get(f),l=h?k.vic.copyFieldsModel:k.vic,g.Fa(c)&&(c=l.Shc(a).length,m=l.getSigmaValuePosition(),m.display&&m.positionType===a-1&&c++),n=b,a===e.PivotTableFieldType.valueField&&(n=l.KNc(l.JNc(b))),h)l.addFieldByName(b,n,a,ia,c),l.Thc(h);else{j.startTransaction(),p.Lz(i,!0);try{l.addFieldByName(b,n,a,ia,c),i.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:b,newArea:a,newIndex:c,oldIndex:ia,oldArea:ia,pivotTableName:f}),l.Thc(h),Qa(i.pivotTables.get(f),i),q=!0}finally{p.Mz(i),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.eOc,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type&&h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:ia,newIndex:ia,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(s),d.Commands[z]={canUndo:!0,execute:function(a,b,c){return u(a,sa,b,c)}},ta=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.getAllItemsList=function(a){var b=[],c=a._items;return c.forEach(function(a){b.push(a.value)}),b},b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=!1;if(E.canExecute()){a=E.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=E.kj,k=j.ITa,k.startTransaction(),E.Lz(j,!0);try{if(g.Fa(b)){if(p=E.VQ.commandOptions,q=E.VQ.selections,r=p.subType,h=j.pivotTables.get(p.pivotTableName),s=p.pivotTableCellInfo,c=h.vic,t=s.area,u=s.rowInfos,v=s.colInfos,w=s.activeRowFieldInfo,x=s.activeColFieldInfo,e=Na(s),y=void 0,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},y=g.Fa(i.textItem)?{isAll:!1}:i.textItem,z=la(j,p.pivotTableName,e,q,t),1===r)y.list=z.slice();else if(2===r){for(A=(c.getLabelFilterInfo(e)&&c.getLabelFilterInfo(e).textItem&&c.getLabelFilterInfo(e).textItem.list||c.SFc(e)).slice(0),B=[],C=0;C<A.length;C++)z.indexOf(A[C])===-1&&B.push(A[C]);y.list=B}i.textItem=y}else e=b.fieldName,f=b.pivotName,h=j.pivotTables.get(f),c=h.vic,l=b.dataOfListBox,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},m={list:[],isAll:!1},n=[],o=!0,l.forEach(function(a){!a.status&&o&&(o=a.status),a.status&&n.push(a.value)}),m.isAll=o,m.list=n,i.textItem=m;h.labelFilter(e,i),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:e,filterInfo:h.labelFilter(e),pivotTableName:f}),F=!0}finally{E.Mz(j),D=d.Commands.bWa(j.name()),E.VQ[D]=k.endTransaction()}}return F},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.eOc[b.eOc.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:p.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption&&e.VQ.cmdOption.pivotName||e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(s),d.Commands[E]={canUndo:!0,execute:function(a,b,c){return u(a,ta,b,c)}},ua=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=p.kj,k=j.ITa,k.startTransaction(),p.Lz(j,!0);try{if(g.Fa(b))m=p.VQ.commandOptions,f=m.pivotTableName,h=j.pivotTables.get(m.pivotTableName),n=m.pivotTableCellInfo,c=h.vic,e=Na(n),i=m.subType;else switch(e=b.fieldName,f=b.pivotName,l=b.commandName,h=j.pivotTables.get(f),c=h.vic,l){case"asc":i=g.SortType.asc;break;case"desc":i=g.SortType.desc;break;case"custom":i=g.SortType.custom;break;default:return}h.sort(e,{sortType:i}),j.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:e,sortType:i,pivotTableName:f}),q=!0}finally{p.Mz(j),o=d.Commands.bWa(j.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],c=b.eOc[b.eOc.length-1].value,f.ITa.undo(b),f.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:c.fieldName,sortType:c.sortInfo?c.sortInfo.sortType:ia,pivotTableName:e.VQ.cmdOption?e.VQ.cmdOption.pivotName:e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(s),d.Commands[F]={canUndo:!0,execute:function(a,b,c){return u(a,ua,b,c)}},va=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o=this,p=!1;if(o.canExecute()){a=o.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=o.kj,k=j.ITa,k.startTransaction(),o.Lz(j,!0);try{g.Fa(b)?(l=o.VQ.commandOptions,c=j.pivotTables.get(l.pivotTableName),m=l.pivotTableCellInfo,e=c.vic,f=Na(m),h=l.clearType):(f=b.fieldName,h=b.clearType,i=b.pivotName,c=j.pivotTables.get(i),e=c.vic),1===h?c.labelFilter(f,ia):2===h?c.valueFilter(f,ia):0===h&&(c.labelFilter(f,ia),c.valueFilter(f,ia)),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f,pivotTableName:i,clearType:h}),p=!0}finally{o.Mz(j),n=d.Commands.bWa(j.name()),o.VQ[n]=k.endTransaction()}}return p},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.eOc,e=0;e<c.length;e++)f=c[e].value,"setLabelFilter"!==f.type&&"setValueFilter"!==f.type||h.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f.fieldName,filterInfo:p.GNc(f.filterInfo),pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(s),d.Commands[G]={canUndo:!0,execute:function(a,b,c){return u(a,va,b,c)}},wa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=a.fieldName,c=a.selectValue,e=a.inputValue,f=a.inputValueEnd,h=a.pivotName,i=p.kj,j=i.ITa,j.startTransaction(),p.Lz(i,!0);try{k=i.pivotTables.get(h),l=k.vic.RFc(b),m=k.options.allowMultipleFiltersPerField?k.labelFilter(b)||{}:{},l===g.PivotDataType.number&&(e=parseInt(e,10),f=parseInt(f,10)),n={conType:g.PivotConditionType.caption,val:[e,f],operator:c},m.condition=n,k.labelFilter(b,m),i.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:b,filterInfo:k.labelFilter(b),pivotTableName:h}),q=!0}finally{p.Mz(i),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.eOc[b.eOc.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:p.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(s),d.Commands[L]={canUndo:!0,execute:function(a,b,c){return u(a,wa,b,c)}},xa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=p.kj,c=b.ITa,c.startTransaction(),p.Lz(b,!0);try{e=a.valueOfField,f=a.valueOfFieldValue,h=a.inputValue,i=a.inputValueEnd,j=a.fieldName,k=a.pivotName,l=b.pivotTables.get(k),m={},n=void 0,n={conType:g.PivotConditionType.value,val:[h,i],operator:+f},m.condition=n,m.conditionByName=e,l.valueFilter(j,m),b.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:j,filterInfo:l.valueFilter(j),pivotTableName:k}),q=!0}finally{p.Mz(b),o=d.Commands.bWa(b.name()),p.VQ[o]=c.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.eOc[b.eOc.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:p.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(s),d.Commands[N]={canUndo:!0,execute:function(a,b,c){return u(a,xa,b,c)}},ya=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s=this,t=!1;if(s.canExecute()){a=s.VQ.cmdOption,b=s.kj,c=b.ITa,c.startTransaction(),s.Lz(b,!0);try{e=a.fieldName,f=a.TopOrBottomValue,h=a.inputValue,i=a.pivotName,j=a.selectTypeValue,k=a.valueFieldName,l=b.pivotTables.get(i),m={},n=void 0,o=1,p=0,q=10,"Bottom"===f&&(o=-1),"Percent"===j?p=1:"Sum"===j&&(p=2),isNaN(+h)||(q=+h),n={conType:g.PivotConditionType.top10,val:q,type:p,operator:o},m.condition=n,m.conditionByName=k,l.valueFilter(e,m),t=!0}finally{s.Mz(b),r=d.Commands.bWa(b.name()),s.VQ[r]=c.endTransaction()}}return t},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[O]={canUndo:!0,execute:function(a,b,c){return u(a,ya,b,c)}},za=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,i,j,k,l,m,n,o,p,q,s,t,u,w,x,y=this,z=!1;if(y.canExecute()){if(a=y.VQ.cmdOption,b=y.kj,c=b.ITa,e=a.fieldName,f=a.pivotName,i=a.host,j=a.command,k=a.isWholeDay,l=a.dateLabel,m=a.value1,n=a.value2,o=b.pivotTables.get(f),p=o.vic,q=o.options.allowMultipleFiltersPerField?o.labelFilter(e)||{}:{},s=void 0,t=+j,isNaN(t))return;if(t<=g.PivotDateFilterOperator.notBetween&&l)new h.DateFilterDialog(i,l,p,e,f,t),z=!0;else try{if(c.startTransaction(),y.Lz(b,!0),u=g.Fa(m)?ia:v.Qa(m),w=g.Fa(n)?ia:v.Qa(n),!g.Fa(m)&&g.Fa(u)||!g.Fa(n)&&g.Fa(w))throw Error(r().DateFormatError);s={conType:g.PivotConditionType.date,val:[u,w],isWholeDay:k,operator:t},q.condition=s,o.labelFilter(e,q),z=!0}finally{y.Mz(b),x=d.Commands.bWa(b.name()),y.VQ[x]=c.endTransaction()}}return z},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[P]={canUndo:!0,execute:function(a,b,c){return u(a,za,b,c)}},Aa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this,L=!1;if(K.canExecute()){a=K.kj,b=a.ITa,b.startTransaction(),K.Lz(a,!0),c=K.VQ,f=c.commandOptions,h=c.cmdOption;try{if(i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,s=void 0,g.Fa(h)?(l=a.pivotTables.get(f.pivotTableName),i=l.vic,t=f.pivotTableCellInfo,u=t.activeRowFieldInfo,v=t.activeColFieldInfo,o=t.area,j=u&&u.name||v&&v.name,p=c.selections):(j=h.fieldName,k=h.pivotName,m=h.dataType,l=a.pivotTables.get(k),p=h.selections),q=l.getField(j),j=q.sourceName,s=q.fieldName,m===g.PivotDataType.number)n={originFieldName:j,numberGroup:{start:h.startingAtValue,end:h.endingAtValue,by:h.groupByValue}},l.group(n);else if(m===g.PivotDataType.date){if(n={originFieldName:j},w=h.groupByValueArray,w.length>0)for(n.dateGroups=[],x=0;x<w.length;x++)y=w[x],n.dateGroups.push({start:new Date(h.startingAtValue),end:new Date(h.endingAtValue),by:y});l.group(n)}else if(z=j,A=void 0,B=void 0,C={},D=!!i.SNc(j),E=void 0,F=void 0,F=la(a,l.name(),s,p,o),G=l.getGroupInfo(j),H=G&&G.textGroup&&G.textGroup.groupItems,g.Fa(H))F.length>1&&(A=j,z=j+2,E=r().Group+1,C[E]=F,B={originFieldName:A,textGroup:{fieldName:z,groupItems:C}},l.group(B),D||(3===o?l.add(z,z,e.PivotTableFieldType.rowField,void 0,Ma(i.Jhc,j)):2===o&&l.add(z,z,e.PivotTableFieldType.columnField,void 0,Ma(i.Khc,j))));else{for(x=0;x<F.length;x++)if(I=F[x],I.indexOf("Group")>-1&&H[I]&&H[I].length>1)return!1;E=r().Group+(Object.keys(H).length+1),H[E]=F,l.group(G)}L=!0}finally{K.Mz(a),J=d.Commands.bWa(a.name()),K.VQ[J]=b.endTransaction()}}return L},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[Z]={canUndo:!0,execute:function(a,b,c){return u(a,Aa,b,c)}},Ba=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,b.startTransaction(),k.Lz(a,!0);try{c=k.VQ,e=c.commandOptions,f=a.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=Na(g),i=f.getField(h),i&&i.sourceName&&(f.ungroup(i.sourceName),l=!0)}finally{k.Mz(a),j=d.Commands.bWa(a.name()),k.VQ[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[$]={canUndo:!0,execute:function(a,b,c){return u(a,Ba,b,c)}},Ca=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Ra(!1,this,!1),g.vhc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.eOc,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(s),d.Commands[aa]={canUndo:!0,execute:function(a,b,c){return u(a,Ca,b,c)}};function Ra(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.VQ,t=s.commandOptions.pivotTableCellInfo,u=b.kj,v=s.selections[0],w=u.pivotTables.get(s.commandOptions.pivotTableName),x=w.$jc,y=!1,z=w.ys.Uic[3],A=w.ys.Uic[2],B=[],C=w.vic,D=z.Nic,E=A.Oic,F=[];switch(C.Mhc.length>1&&(g=C.Qhc,h=C.Rhc),w.suspendLayout(),t.area){case 3:if(i=C.Jhc.length,0===g&&t.activeRowFieldInfo&&h<t.activeRowFieldInfo.index&&(i+=1),y=t.activeRowFieldInfo&&t.activeRowFieldInfo.index===i-1,d=c?{row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1}:v,d.row<z.nU+x.row||d.row+d.rowCount>z.nU+x.row+z.Xj||d.col<x.col||d.col+d.colCount>x.col+z.OZ)return;for(j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m)&&(n=D[j-z.nU-x.row],n.collapseIndex!==ja||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}break;case 2:if(t.colHeadFieldInfo){for(i=C.Khc.length,1===g&&(0===t.relativeRow&&h<t.relativeColumn||t.activeColFieldInfo&&h<t.activeColFieldInfo.index)&&(i+=1),y=t.relativeColumn===i-1,f={row:t.relativeColumn+x.row+1,col:A.hF+x.col,rowCount:1,colCount:A.OZ},k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[q.relativeRow-1-(y?1:0)],r)&&(n.collapseIndex!==ja||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[q.relativeRow-1-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}else{if(i=C.Khc.length,1===g&&t.activeColFieldInfo&&h<t.activeColFieldInfo.index&&(i+=1),y=t.activeColFieldInfo&&t.activeColFieldInfo.index===i-1,f=c?{row:v.row,col:A.hF+x.col,rowCount:1,colCount:A.OZ}:v,f.col<A.hF+x.col||f.col+f.colCount>A.hF+x.col+A.OZ||f.row<=x.row||f.row+f.rowCount>x.row+A.Xj)return;for(k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[t.activeColFieldInfo&&t.activeColFieldInfo.index-(y?1:0)],r)&&(n.collapseIndex!==ja||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[t.activeColFieldInfo.index-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}break;case 1:if(v.colCount*v.rowCount>1)return;if(t.cornerFieldInfo)for(i=z.OZ,2===g&&h<t.relativeColumn&&(i+=1),y=t.relativeColumn===i-1,d={row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1},j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),n=D[j-z.nU-x.row],m=l.rowInfos[t.relativeColumn-(y?1:0)],m)&&(n.collapseIndex!==ja||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.relativeColumn-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}}return w.resumeLayout(),B}Da=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Ra(!0,this,!1),g.vhc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.eOc,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(s),d.Commands[ba]={canUndo:!0,execute:function(a,b,c){return u(a,Da,b,c)}},Ea=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Ra(!1,this,!0),g.vhc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.eOc,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(s),d.Commands[ca]={canUndo:!0,execute:function(a,b,c){return u(a,Ea,b,c)}},Fa=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Ra(!0,this,!0),g.vhc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.eOc,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(s),d.Commands[da]={canUndo:!0,execute:function(a,b,c){return u(a,Fa,b,c)}},Ga=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=f.isSusPaint,i=f.fieldName,j=f.checked,k=f.pivotName,l=b.pivotTables&&b.pivotTables.get(k),m=void 0,n=h?l.vic.copyFieldsModel:l.vic,h)j?n.sDc(i):n.rDc(i),n.Thc(h);else{c.startTransaction(),w.Lz(b,!0);try{if(j)n.sDc(i),o=n.qo.getPivotCacheByName(n.Ihc).HL,p=o[i].ny,m=p===g.PivotDataType.number?{pivotArea:e.PivotTableFieldType.valueField,pivotIndex:n.Shc(e.PivotTableFieldType.valueField).length-1}:l.getField(i),b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:ia,oldIndex:ia,newArea:m.pivotArea,newIndex:m.pivotIndex,pivotTableName:l.Cj});else{for(q=void 0,r=[],s=e.PivotTableFieldType.valueField;s>=e.PivotTableFieldType.filterField;s--)for(q=n.Shc(s),t=q.length-1;t>=0;t--)q[t].whc===i&&r.unshift(l.getField(q[t].Cj));for(n.rDc(i),u=0;u<r.length;u++)m=r[u],b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:m.fieldName,oldArea:m.pivotArea,oldIndex:m.pivotIndex,newArea:ia,newIndex:ia,pivotTableName:l.Cj})}n.Thc(h),x=!0}finally{w.Mz(b),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.eOc,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type?h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:ia,newIndex:ia,pivotTableName:g.VQ.cmdOption.pivotName}):h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:ia,oldIndex:ia,newArea:f.area,newIndex:f.index,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(s),d.Commands[D]={canUndo:!0,execute:function(a,b,c){return u(a,Ga,b,c)}},Ha=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j=this,k=!1;if(j.canExecute()){a=j.VQ,b=j.kj,c=b.ITa,c.startTransaction(),j.Lz(b,!0);try{e=a.cmdOption,f=e.fieldsInfo,g=b.pivotTables&&b.pivotTables.get(e.pivotName),h=g.vic,h.yNc(f),k=!0}finally{j.Mz(b),i=d.Commands.bWa(b.name()),j.VQ[i]=c.endTransaction()}}return k},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[fa]={canUndo:!0,execute:function(a,b,c){return u(a,Ha,b,c)}};function Sa(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Ta(a){var b,c,d,e,f,g=0;for(b=0;b<a.sheets.length;b++)for(c=a.sheets[b].tables.all(),d=0;d<c.length;d++)e=c[d].name(),e&&e.length>5&&"table"===e.substring(0,5).toLowerCase()&&(f=e.substring(5,e.length),Sa(f)&&+f>=g&&(g=+f));return"Table"+(g+1)}Ia=function(a){Ja(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=a.cmdOption,f=e.name,g=e.views,g.apply(f),b.Wq(d.Events.PivotTableChanged,{type:"viewChanged",viewName:f,pivotTableName:e.pivotName}),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),e.Wq(d.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:c.VQ.cmdOption.pivotName}),f=!0}finally{c.Mz(e,!0)}}return f},b}(s),d.Commands[W]={canUndo:!0,execute:function(a,b,c){return u(a,Ia,b,c)}},d.Commands[_]={canUndo:!1,execute:function(a,b,c){var e,f,h,i,j,k,l,m=d.Commands.bT(a,b),n=b.commandOptions,o=m.pivotTables.get(n.pivotTableName),p=n.pivotTableCellInfo,q=p.rowInfos,s=p.colInfos;e=q&&s?q.concat(s):q?q:s?s:[],f=[],h=0,g.vhc(e,function(a){a.fieldName!==r().sigmaValue&&(f[h]={fieldName:a.fieldName,fieldItem:a.itemName},h++)}),i=o.getPivotDetails(f),j=m.getParent(),j&&(k=new d.Worksheet,k.setRowCount(i.length>200?i.length:200),k.setColumnCount(i[0].length>20?i[0].length:20),k.setArray(0,0,i),l=Ta(j),k.tables.add(l,0,0,i.length,i[0].length),j.addSheet(j.getActiveSheetIndex(),k))}},d.Commands[I]={canUndo:!1,execute:function(a,b){var c,e,g=d.Commands.bT(a,b),h=b.cmdOption,i=h.fieldName,j=h.pivotName,k=h.commandName,l=h.host,m=h.position,n=h.filterDialog,o=[],p=g.pivotTables&&g.pivotTables.get(j),q=p.vic,r=q.getFieldInfoByName(i).Dhc;if("ValueFilter"===k)c=new f.PivotValuesDialog(l,q,j,i,ia,ia,n),r&&r.valueFilter&&(3===r.valueFilter.condition.glc?o.push(8):o.push(r.valueFilter.condition.Glc));else{switch(q.RFc(i)){case 0:c=new f.PivotNumberFilter(l,q,j,i,ia,ia,n);break;case 2:c=new f.PivotDateFilterDialog(l,q,j,i,ia,ia,n);break;default:c=new f.PivotStringFilterDialog(l,q,j,i,ia,ia,n)}r&&r.labelFilter&&r.labelFilter.condition&&(e=2===r.labelFilter.condition.glc?r.labelFilter.condition.Glc+6:r.labelFilter.condition.Glc,o.push(e))}c.OT(m,{existed:o,dataType:1})}},d.Commands[J]={canUndo:!1,execute:function(a,b,c){var e,i,j,k,l,m,n,o,p,q,s,t=b.cmdOption,u=d.Commands.bT(a,b);g.Fa(t)?(n=b.commandOptions,m=u.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,e=m.vic,i=Na(o),j=m.name(),p=m.labelFilter(i),q=p&&p.conditionInfo&&p.conditionInfo.Glc,l=q||0):(i=t.fieldName,j=t.pivotName,l=t.command,m=u.pivotTables.get(j),e=m.vic),s=e.RFc(i),s===g.PivotDataType.number?(k=r().getNumberLabelFilterItemText(),new f.LabelFilter(document.body,k,e,i,j,(+l))):s===g.PivotDataType.date?(k=r().getDateLabelFilterItemText(),new h.DateFilterDialog(document.body,k,e,i,j,(+l))):(k=r().getStringLabelFilterItemText(),new f.LabelFilter(document.body,k,e,i,j,(+l)))}},d.Commands[B]={canUndo:!1,execute:function(a,b,c){var g,h,i,j=d.Commands.bT(a,b),k=b.cmdOption,l=k.position,m=k.fieldName,n=k.pivotName,o=j.pivotTables.get(n),p=o.vic,q=p.getFieldInfoByName(m),r=p.Ohc[m],s=Ka(p,q,m,h,n);if(r===e.PivotTableFieldType.filterField)g=24,h=!1;else{if(g=30,r===e.PivotTableFieldType.valueField)return;h=!0}return s.isColOrRow=h,i=new f.PivotFilterDialog(document.body,p,n),i.init(g,m,l,s),!0}},d.Commands[A]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m=b.cmdOption,n=d.Commands.bT(a,b);return g.Fa(m)?(j=b.commandOptions,k=j.pivotTableCellInfo,l=n.pivotTables.get(j.pivotTableName),c=l&&l.vic,e=Na(k,c),f=j.pivotTableName,h=l.hOc):(e=m.fieldName,f=m.pivotName,c=n.pivotTables.get(f).vic),new i.PivotDimFieldSettingDialog(c,e,f,h).Ao(),!0}},d.Commands[K]={canUndo:!1,execute:function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p=d.Commands.bT(a,b),q=ka(p,b.row,b.col),r=q.pivotInfo,s=q.pt;if(r){switch(e=r.area,g=void 0,e){case 0:g=r.pageFieldInfo;break;case 1:g=r.cornerFieldInfo;break;case 2:g=r.colHeadFieldInfo}if(!g)return!1;h=g.fieldName,i=g.isCompactRoot,j=p.getCellRect(b.row,b.col),k=s.vic,j.y+=j.height,l=Ka(k,k.getFieldInfoByName(h),h,!0,s.Cj),m=0,0===r.area?m=24:(m=30,i&&(n=void 0,1===r.area&&(n=k.Jhc.length),2===r.area&&(n=k.Khc.length),n>1&&(m+=1),l.areaFieldName=k.Shc(r.area).map(function(a){return a.Cj}))),o=new f.PivotFilterDialog(p.zo(),s.vic,s.getName()),o.init(m,h,j,l)}return!0}},d.Commands[C]={canUndo:!1,execute:function(a,b){var c,e=d.Commands.bT(a,b),f=b.cmdOption,g=f.fieldName,h=f.configurationNumber,i=f.position,j=f.filterDialog,k=f.pivotName,l=e.pivotTables.get(k),m=l.vic,n=m.getFieldInfoByName(g),o=[],p=m.Ohc[g],q=m.Shc(p);return q.forEach(function(a){o.push(a.Cj)}),o.splice(o.indexOf(g),1),o.unshift(g),c=Ka(m,n,g,!0),c.areaFieldName=o,j.init(h,g,i,c),!0}},d.Commands[M]={canUndo:!1,execute:function(a,b,c){var e,f,i,j,k,l,m,n,o,p,q,s,t,u=b.cmdOption,v=d.Commands.bT(a,b);if(g.Fa(u)){if(n=b.commandOptions,m=v.pivotTables&&v.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,l=n.isTop10,e=m.vic,0===e.Shc(3).length)return v.Os(10,r().EmptyValueFieldError),!1;f=Na(o),i=m.name(),j=r().getValueFilterItemText(),l||(p=m.valueFilter(f),q=p&&p.conditionInfo&&p.conditionInfo.Glc,k=q||0)}else{if(f=u.fieldName,i=u.pivotName,j=u.content,k=u.command,m=v.pivotTables.get(i),e=m.vic,0===e.Shc(3).length)return v.Os(10,r().EmptyValueFieldError),!1;"Top10"===k&&(l=!0)}s=e.Shc(3),t=[],s.forEach(function(a){t.push(a.Cj)}),new h.ValueFilter(document.body,j,t,e,f,i,(+k),l);
}},d.Commands[Q]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m=b.cmdOption,n=d.Commands.bT(a,b);return g.Fa(m)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=n.pivotTables.get(k.pivotTableName),c=j&&j.vic,e=Na(l,c),f=k.pivotTableName,h=j.hOc):(f=m.pivotName,j=n.pivotTables.get(f),c=j.vic,e=m.fieldName),new i.PivotValuesFieldSettingDialog(c,e,f,h).Ao(),!0}},d.Commands[U]={canUndo:!1,execute:function(a,b){var c,e,f,h,i,j,m,n,o,p,q,r,s,t,u,v,w=d.Commands.bT(a,b),x=b.commandOptions,y=w.pivotTables.get(x.pivotTableName);if(y)if(c=x.pivotTableCellInfo,e=c.activeRowFieldInfo,f=c.activeColFieldInfo,h=e&&e.name||f&&f.name,i=y.getGroupInfo(h),j=y.getField(h),m=y.vic,n=x.selections||w.getSelections(),o=1===n.length&&1===n[0].rowCount&&1===n[0].colCount,j.dataType===g.PivotDataType.number&&o){if(p=Oa(j,i),!g.Fa(p))return q=new k.PivotNumberGroupDialog(document.body,x.pivotTableName,h,m,j.start,p.start,j.end,p.end,p.by),q.Ao(),!0}else if(j.dataType===g.PivotDataType.date&&o){if(r=Pa(j,i),!g.Fa(r))return s=b.activeRow||w.getActiveRowIndex(),t=b.activeCol||w.getActiveColumnIndex(),u=w.getActualStyle(s,t)&&w.getActualStyle(s,t).formatter,v=new l.PivotDateGroupDialog(document.body,x.pivotTableName,h,m,j.start,r.start,j.end,r.end,r.by,n,u),v.Ao(),!0}else w.wu().execute({cmd:"pivotTableGroup",sheetName:w.name(),commandOptions:x,selections:n})}},d.Commands[V]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=f&&f.vic,i=Na(g,h),k=e.pivotTableName,l=e.showValueAsType;return new j.PivotShowValueAsDialog(document.body,h,i,k,g,l),!0}},d.Commands[H]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,e=d.Commands.bT(a,b),f=e.parent;try{f.DNc(c.pivotCacheName,c.pivotCache,c._ptName)}catch(a){o.throwError(r().NoHaveSpread)}}},d.Commands[Y]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName);g.Fa(f)||f.updateSource()}},d.Commands[T]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.position,e=c.views,g=c.width,h=new f.PivotViewListDialog(document.body,e,g);h.init(d)}},d.Commands[X]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.name,e=c.views;return!e.save(d)&&(Ua(d,e),!0)}};function Ua(a,b){var c,d=a.split(p.nameSeparator);isNaN(parseInt(d[d.length-1],10))?a+=p.nameSeparator+"1":(c=d[d.length-1],d.splice(d.length-1,1,p.nameSeparator+(parseInt(c,10)+1)),a=d.join("")),b.save(a)||Ua(a,b)}function Va(a,b){return a.sheets?a.getSheetFromName(b.sheetName):a}d.Commands[ga]={canUndo:!1,execute:function(a,b,c){var d,e,f,g,h,i,j,k,l=Va(a,b),m=l.getSelections();if(1===m.length)for(d=m[0],e=l.pivotTables.all(),f=0;f<e.length;f++)if(g=e[f],h=g.getRange(),i=h.page,j=h.content,k=i?i.union(j):j,i&&i.containsRange(d)||j&&j.containsRange(d)){l.setSelection(k.row,k.col,k.rowCount,k.colCount);break}}},d.Commands.ajc=function(a){var b=d.Ul.sl(),c=!b,e=b;a.register(t,d.Commands[t]),a.register(x,d.Commands[x]),a.register(y,d.Commands[y]),a.register(A,d.Commands[A]),a.register(z,d.Commands[z]),a.register(B,d.Commands[B]),a.register(W,d.Commands[W]),a.register(X,d.Commands[X]),a.register(T,d.Commands[T]),a.register(C,d.Commands[C]),a.register(E,d.Commands[E]),a.register(F,d.Commands[F]),a.register(G,d.Commands[G]),a.register(I,d.Commands[I]),a.register(J,d.Commands[J]),a.register(L,d.Commands[L]),a.register(M,d.Commands[M]),a.register(N,d.Commands[N]),a.register(O,d.Commands[O]),a.register(P,d.Commands[P]),a.register(K,d.Commands[K]),a.register(U,d.Commands[U]),a.register(Q,d.Commands[Q]),a.register(S,d.Commands[S]),a.register(R,d.Commands[R]),a.register(D,d.Commands[D]),a.register(Y,d.Commands[Y]),a.register(H,d.Commands[H]),a.register(fa,d.Commands[fa]),a.register(ea,d.Commands[ea]),a.register(Z,d.Commands[Z]),a.register($,d.Commands[$]),a.register(aa,d.Commands[aa]),a.register(ba,d.Commands[ba]),a.register(ca,d.Commands[ca]),a.register(da,d.Commands[da]),a.register(_,d.Commands[_]),a.register(V,d.Commands[V]),a.register(ga,d.Commands[ga],65,c,!1,!1,e)}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=h.Common.j.Fa,l=null,m=Math.max,n=new h.Common.ResourceManager(i.SR),o=n.getResource.bind(n),p=f.GC$,q="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",b.bjc=function(a,b,c,d,e,f,g){var h;return e&&(h=e[g]),a.iOc(b,c,d,h,f,g)},s=function(){function a(){}return a.cjc=function(a,b){var c,f,g,h,i,j,k,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;if(p[p.sd]({tc:a.parent},1),h=a.pivotTables.get(b)){for(g=h.djc(),c=h.ys,f=h.eic(),i=c.Uic,j=i[0],k=i[1],m=i[2],n=i[3],q=i[4],r=h.ejc(),s=r.length,t=h.fjc(),u=h.vic.zZ,v=t.length,w=h.options,x=w.subTotalsPosition,y=x===e.SubtotalsPosition.top||x===e.SubtotalsPosition.bottom,z=h.gjc(),A=h.vic.getSigmaValuePosition(),E=h.Olc(),B=E.al,C=E.KW,D=E,F=[],G={},d.vhc(g,function(a){var b=h.vic.tNc(a.whc),c=b&&b.Yw?d.SubtotalType.sum:a.Fhc,e={name:a.Cj,subtotalText:d.SubtotalType[c],subtotalType:c,cacheName:a.whc,hasShowDataAs:!!D.jOc[a.Cj]};F.push(e),G[a.Cj]=e}),H=0,I=-1,J=-1,F.length>1&&(A.positionType===d.DataPosition.col?I=A.positionIndex:J=A.positionIndex),K=[],r.forEach(function(a){K.push(a.Cj)}),I>=0&&K.splice(I,l,o().Values),L={},M=0;M<K.length;M++)L[K[M]]=M;return N={},[].concat(z,r,t).forEach(function(a){var b=h.vic.tNc(a.whc);d.isEmptyObject(b.dic)&&d.isEmptyObject(b.QFc)||(N[a.Cj]=b.getFieldsItemList()||[])}),h.kOc=N,h.lOc=v+(J>-1?1:0),h.mOc=v+(I>-1?1:0),{sharedMap:N,repeatValueFiledChildLength:H,rowDeep:v,rowFields:t,colFields:r,hasColumnSubTotal:y,fieldMap:f,pageModel:j,cornerModel:k,columnModel:m,rowModel:n,contentModel:q,options:w,pageFields:z,valuePositionInfo:A,valueFieldsInfo:F,columnValuePosition:I,rowValuePosition:J,columnDeep:s,rootNode:B,headerNode:C,subtotalCollection:D,valueFieldsMap:G,pt:h,sortInfo:u,columnFieldsIndexes:K,colFieldsMap:L}}},a.render=function(a){var b=this.cjc(a.qo,a.Cj);b&&(this.hjc(b),this.ijc(b),this.jjc(b),this.nOc(a,b.rowModel),this.oOc(a,b.columnModel),this.ljc(b),a.EZ(),this.recalcFormula(a),this.pOc(b),b=null)},a.pOc=function(a){delete a.rootNode,delete a.headerNode,a.subtotalCollection.no(),delete a.subtotalCollection},a.njc=function(a,b,c){k(c.rowHeaderLevel)?c.aN=c.grandTotalLevel:c.aN=c.rowHeaderLevel,a.Nic[b]=c},a.recalcFormula=function(a){var b=a.qo;b&&(b.suspendPaint(),b.getCalcService().recalculateAll(!1,!1),b.resumePaint())},a.qOc=function(a){var b,c,e,f,g,h,i,l,m=a.sharedMap,n=a.rowFieldsIndexes,p=a.rowModel,q=p.Nic,r=q.length,s=a.rowValuePosition,t=a.rowFieldsIndexes.length;for(p._Nc={},b=0;b<r;b++)if(c=q[b],c&&(e=c.path,!k(e)&&""!==e&&!c.isBlankRow&&!c.isSubtotal))for(f=e.split(d.Separator),a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&!k(c.valueFieldName)&&f.splice(s,null,c.valueFieldName),g=0,h=f.length;g<h;g++)i=n[g],l=f[g],p.aOc(b,i,i!==o().Values?j.mjc(m,i,l):l,t-g)},a.rOc=function(a,b,c,d){a.push({path:b,isBlankRow:!0}),c.push([]),d.push([])},a.nOc=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r;if(a.options.mergeItem&&a.layoutType()===e.PivotTableLayoutType.tabular){c=a.tOc.sOc,f=b.OZ,g=b.dataTable,h=b.Nic,i=b._Nc,d.vhc(g,function(a,b){var d,e=h[b];(e.isBlankRow||e.isSubtotal||e.isGrandTotal)&&(d=e.isBlankRow?g[b-1].length-1:a.length-1,c.push({row:b,col:d,rowCount:1,colCount:f-d}))});for(j in i)if(i.hasOwnProperty(j)){k=i[j];for(l in k)if(k.hasOwnProperty(l)&&(m=k[l],n=m.ranges,o=m.level,o>1&&f-o>-1&&n.length>1)){for(p=n[0],q=p,r=1;r<n.length;r++)n[r]-n[r-1]===1?q+=1:(q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1}),p=n[r],q=p);q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1})}}}},a.oOc=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q;if(a.options.mergeItem){c=a.tOc.uOc,e=b.Xj-1,f=this.twoDimensionalArraySpin(b.dataTable),g=b.Oic,h=b._Nc,d.vhc(f,function(a,b){var d,f=g[b];f.isBlankColumn||(f.isSubtotal||f.isGrandTotal)&&(d=a.length-1,c.push({row:d,col:b,rowCount:e-d+1,colCount:1}))});for(i in h)if(h.hasOwnProperty(i)){j=h[i];for(k in j)if(j.hasOwnProperty(k)&&(l=j[k],m=l.ranges,n=l.level,n>1&&e-n>-1&&m.length>1)){for(o=m[0],p=o,q=1;q<m.length;q++)m[q]-m[q-1]===1?p+=1:(p-o>0&&c.push({row:e-n+1,col:o,rowCount:1,colCount:p-o+1}),o=m[q],p=o);p-o>0&&c.push({row:e-n+1,col:o,rowCount:1,colCount:p-o+1})}}}},a.twoDimensionalArraySpin=function(a){var b,c,d,e,f;if(a&&0!==a.length){for(b=0,c=a.length,d=0;d<a.length;d++)b<a[d].length&&(b=a[d].length);if(0!==b){for(e=Array(b),d=0;d<b;d++)e[d]=[];for(d=0;d<b;d++)for(f=0;f<c;f++)a[f][d]&&(e[d][f]=a[f][d]);return e}}},a.hjc=function(a){var b=this,c=a.pageFields,f=a.pageModel,g=0,h=0,i=0,j=a.options,k=j.displayFieldsInPageFilterArea,m=j.reportFilterFieldsPerColumn;k===e.DisplayFields.overThenDown?0===m?f.setRowCount(1):f.setRowCount(Math.ceil(c.length/m)):0===m?f.setRowCount(c.length):f.setRowCount(c.length>=m?m:c.length),d.vhc(c,function(c,d){var j,n,p,q=c.isFilter(),r=c.Cj;k===e.DisplayFields.overThenDown?0===m?(h=0,g=3*d):(h=Math.floor(d/m),j=d%m,g=3*j):0===m?(h=d,g=0):(g=3*Math.floor(d/m),h=d%m),f.yq(h,g,r),q?(n=c.getFilterInfo(),p=n&&n.getSlicerItemInfo(),f.yq(h,g+1,p.hasMoreThanOneSelect?o().MultipleItems:p.text)):f.yq(h,g+1,o().All),f.zn(h,g+1,b.ojc(q,l,8,a.options.showFilter)),f.Ric(h,g+1,r),i=i<g+1?g+1:i}),f.setColCount(i+1)},a.tjc=function(a,c,e,f,g,h,i,j){var k=this,l=a.columnModel,m=a.contentModel,n=a.columnValuePosition,p=a.rowValuePosition,q=a.valueFieldsMap,r=a.subtotalCollection,s=a.rowModel,t=a.rowDeep,u=n!==-1;u?d.vhc(l.Oic,function(a,g){if(a){var h=a.rowPathMap,i=q[a.valueFieldName];h&&h.indexList&&h.indexList[f]&&i&&(k.vOc(r,r.jOc[a.valueFieldName],c,a.valueFieldName,h,a)?m.yq(e,g,d.EmptyValue):m.yq(e,g,b.bjc(r,h.indexList[f],i.cacheName,i.subtotalText,c.wOc,c.aN,a.valueFieldName)))}}):(s.aOc(e,o().Values,j,t+1-p),d.vhc(l.Oic,function(a,h){var l=a&&a.rowPathMap;l&&l.indexList&&l.indexList[f]&&(k.vOc(r,r.jOc[j],c,j,l,a)?m.yq(e,h,d.EmptyValue):m.yq(e,h,b.bjc(r,l.indexList[f],g,i,c.wOc,c.aN,j)))}))},a.vOc=function(a,b,c,e,f,g){var h,i,j,l=c.wOc;if(l&&l[e]){if(h=l[e],k(h.minorPath)||(h.minorPath=g.path),k(h.colTotalIndex)||(h.colTotalIndex=f.indexList[""]),b.baseRootLevel>-1&&(b.showDataAsIndex&c.TWc)>0)return!0;if(b.baseHeaderLevel>-1&&(b.showDataAsIndex&g.showDataAsIndex)>0)return!0;if(b.isDifferenceOrPercent)if(b.isHeaderOfPercentOrDiff){if(f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}else{if(b.baseRootLevel+1>c.aN||c.nodeName===b.baseFieldItemShared&&b.baseRootLevel+1===c.aN)return!0;h.indexInfo.baseMinorPath=g.path}if(b.needBuildRunningTotalOrRankPath){if(c.Ajc&&b.baseRootLevel>-1)return!0;if(b.baseHeaderLevel>-1&&f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.minorPath=g.path,h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}if(b.showDataAs===d.PivotShowDataAs.percentOfRow&&(h.indexInfo.baseIndex=a.xOc("").indexList[c.yOc]),b.showDataAs===d.PivotShowDataAs.percentOfCol&&(h.indexInfo.baseIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParent){if(b.baseRootLevel>-1&&c.aN<b.baseRootLevel+1)return!0;if(b.baseHeaderLevel>-1){if(b.baseHeaderLevel+1>f.level)return!0;f.level===b.baseHeaderLevel+1&&(h.indexInfo.baseIndex=f.indexList[c.yOc]),f.level>b.baseHeaderLevel+1&&(i=g.rowPathMap.baseSubtotalInfo[e].percentOfBasePath,k(i)||(h.indexInfo.baseIndex=a.xOc(i).indexList[c.yOc]))}}if(b.showDataAs===d.PivotShowDataAs.index&&(h.indexInfo.rowTotalIndex=a.xOc("").indexList[c.yOc],h.indexInfo.colTotalIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParentRow&&(h.indexInfo.minorPath=g.path),b.showDataAs===d.PivotShowDataAs.percentOfParentCol&&(h.indexInfo.baseIndex=a.xOc(g.rowPathMap.parentPath).indexList[c.yOc]),j=""===g.path&&b.needBuildPercentOfPath&&b.baseRootLevel===-1)return!0}},a.ujc=function(a,c,f,g,h){var i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;if(void 0===h&&(h=""),i=a.colMap,j=a.contentModel,l=a.columnValuePosition,m=a.rowValuePosition,n=a.rowDeep,o=m!==-1,p=l!==-1,!(f.Ajc&&n>0&&a.options.grandTotalPosition!==e.GrandTotalPosition.both&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||""===h&&f.aN<n)){if(q=h,p)for(""!==h&&(h+=d.Separator),r=0,s=g;r<s.length;r++)t=s[r],u=t.name,v=t.cacheName,w=t.subtotalText,x=t.hasShowDataAs,y=h+u,z=i[y],A=!1,x&&(A=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[u],h,f,u,q,n)),A?j.yq(c,z,d.EmptyValue):j.yq(c,z,b.bjc(a.subtotalCollection,f.AOc,v,w,f.wOc,f.aN,u));if(o&&(z=i[h],!k(z)))for(B=c,C=0,D=g;C<D.length;C++)E=D[C],F=E.name,v=E.cacheName,w=E.subtotalText,x=E.hasShowDataAs,G=!1,x&&(G=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[F],h,f,F,q,n)),G?j.yq(B,z,d.EmptyValue):j.yq(B,z,b.bjc(a.subtotalCollection,f.AOc,v,w,f.wOc,f.aN,F)),B++;if(!o&&!p&&1===g.length){if(H=g[0],I=H.name,v=H.cacheName,w=H.subtotalText,x=H.hasShowDataAs,""!==h&&(h+=d.Separator),z=i[h+I],k(z))return;J=!1,x&&(J=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[I],h,f,I,q,n)),J?j.yq(c,z,d.EmptyValue):j.yq(c,z,b.bjc(a.subtotalCollection,f.AOc,v,w,f.wOc,f.aN,I))}}},a.zOc=function(a,b,c,e,f,g,h){return b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&(e.wOc[f].indexInfo.minorPath=g),(b.showDataAsIndex&e.TWc)>0||(b.showDataAs===d.PivotShowDataAs.percentOfRow&&e.aN<=h&&(e.wOc[f].indexInfo.baseIndex=a.BOc(e.yOc,!1)),b.showDataAs===d.PivotShowDataAs.index&&e.aN<=h&&(e.wOc[f].indexInfo.rowTotalIndex=a.BOc(e.yOc,!1)),!!(b.isDifferenceOrPercent&&b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel)||(""===c&&b.showDataAs===d.PivotShowDataAs.percentOfParent&&b.baseRootLevel===-1||(b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel||(!!(e.Ajc&&b.needBuildRunningTotalOrRankPath&&b.baseRootLevel>-1)||!!(""===c&&b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&b.actualBaseLevel===e.aN)))))},a.ijc=function(a){var b,c,f,g,h,i=a.columnModel,j=a.valueFieldsInfo,k=a.headerNode,l=a.hasColumnSubTotal,n=a.colFields,p=a.columnValuePosition,q=a.columnDeep,r=k.vjc+1,s=l?k.wjc+k.$Dc+k.COc:k.wjc+k.COc,t=a.options.grandTotalPosition;if(t!==e.GrandTotalPosition.both&&t!==e.GrandTotalPosition.row?l&&(s-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length,s=m(s,0)):l||(s+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length),0===n.length&&(s=k.wjc+k.COc),b=j.length,0===q&&0===b&&(s=0),c=a.columnFieldsIndexes.length,s<c){for(f=s;f<c;f++)i.Oic[f]={path:"",isBlankColumn:!0};s=c}p!==-1&&q>0&&(r+=1),i.setColCount(s),a.contentModel.setColCount(s),i.setRowCount(r),g={},q>0&&(this.yjc(i,n,p,a),h=[],d.vhc(n,function(a){h.push({name:a.Cj,isFilter:a.isFilter(),isDim:!0,sortInfo:a.zZ})}),p!==-1&&h.splice(p,0,{name:o().Values,isFilter:!1,isDim:!1}),d.vhc(h,function(a,b){var c=a.name;g[c]=b+1})),a.columnHeaderRowMap=g,this.zjc(a,k,q>0?1:0,0,j),a.colMap=i.getColInfoMap()},a.CFc=function(a,b){var c,d,f=a.options,g=f.subTotalsPosition,h=f.grandTotalPosition,i=g!==e.SubtotalsPosition.none?b.wjc+b.$Dc+b.COc:b.wjc+b.COc;return b.Ajc&&(0===a.colFields.length&&(i=b.wjc+b.COc),c=g!==e.SubtotalsPosition.none,d=h!==e.GrandTotalPosition.none&&h!==e.GrandTotalPosition.col,a.columnDeep>0&&(c&&!d?i-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length:d&&!c&&(i+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length))),i},a.zjc=function(a,b,c,d,g){var h,i,l,m,n,p,q,r,s,t,u=a.columnModel,v=a.columnDeep,w=a.columnValuePosition,x=a.sharedMap,y=a.columnHeaderRowMap,z=a.colFields,A=b.nodeName,B=b.aN,C=b.Ajc,D=b.Bjc,E=b.$ic,F=b.rjc,G=1,H=a.options.subTotalsPosition!==e.SubtotalsPosition.none,I=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.col;if(w!==-1&&w>=B&&(G=g.length),h=j.mjc(x,E,A),i=a.pt.collapse(E,h)&&B!==v,u.yq(c,d,h),l=d,D){for(m=y[o().Values],C||0===w||(u.yq(m-1,d,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(m-1,d,this.Ejc(i,f.ButtonPosition.leftOfText))),n=0,p=g;n<p.length;n++)q=p[n],u.yq(m,l,q.name),C&&0===v&&u.aOc(l,o().Values,q.name,z.length-w+1),l+=i?1:this.DFc(a,b,m+1,l,[q]);if(i)return this.EFc(a,b,m,l-G,g,m),B===v&&0!==v&&this.FFc(a,u,l,b,w,v,g),G}else{if(r=y[E],k(r))r=0;else if(u.yq(r,l,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(r,l,this.Ejc(i,f.ButtonPosition.leftOfText)),i)return this.EFc(a,b,r,l,g,r),B===v&&0!==v&&this.FFc(a,u,l,b,w,v,g),G;this.DFc(a,b,r+1,l,g)}return s=this.CFc(a,b)||G,t=d+s-G,B===v&&0!==v&&this.FFc(a,u,t,b,w,v,g),(H||C&&I)&&this.EFc(a,b,y[E]||1,t,g),s},a.FFc=function(a,b,c,d,e,f,g){var h,i,j,k=a.columnFieldsIndexes,l=a.colFieldsMap,m=e!==-1;if(m)for(h=0,i=g.length;h<i;h++)j=g[h],b.Oic[c+h]={path:d.Cjc,valueFieldName:j.name,grandTotalLevel:d.aN,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},this.aOc(b,c+h,a.sharedMap,d.Cjc,d.aN,e,k,l,j.name,!1);else b.Oic[c]={path:d.Cjc,grandTotalLevel:d.aN,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},this.aOc(b,c,a.sharedMap,d.Cjc,d.aN,e,k,l,g&&g[0]&&g[0].name,!1)},a.aOc=function(a,b,c,e,f,g,h,i,k,m){var n,p,q,r,s=e.split(d.Separator);for(g>=0&&g<=f&&(n=i[o().Values],s.splice(n,l,k)),p=h.length,q=0,r=m?s.length-1:s.length;q<r;q++)a.aOc(b,h[q],j.mjc(c,h[q],s[q]),p-q)},a.EFc=function(a,b,c,d,f,g){var h,i,l,m,n,p,q,r,s,t,u=a.columnModel,v=a.columnDeep,w=a.columnValuePosition,x=a.sharedMap,y=a.columnHeaderRowMap,z=a.columnFieldsIndexes,A=a.colFieldsMap,B=f.length,C=b.Ajc,D=b.aN,E=b.nodeName,F=b.Cjc,G=b.$ic,H=a.options.grandTotalPosition;if(!(C&&v>0&&H!==e.GrandTotalPosition.both&&H!==e.GrandTotalPosition.row||D>v-1&&0!==v))if(i=j.mjc(x,G,E),l=a.pt.collapse(G,i),m=y[o().Values],D<=w)for(C?(c=1,0===v&&(c=0)):c=y[G],n=d,p=0;p<B;p++)q=f[p].name,h=0===v?l?i:C?q:i+" "+q:l?i:C?o().Total+" "+q:i+" "+q,l&&0===p?u.yq(c,n+p,h):l||u.yq(c,n+p,h),l&&u.yq(m,n+p,q),r={path:F,valueFieldName:q,grandTotalLevel:D,showDataAsIndex:b.TWc,rowPathMap:a.subtotalCollection.xOc(b.yOc)},F&&D<v&&u.aOc(n+p,o().Values,q,v+1-D),k(g)||(r.collapseIndex=g-1),C?0===w&&0===v||(r.isGrandTotal=!0):r.isSubtotal=!0,u.Oic[n+p]=r;else s=d,0===v?(h=f[0]&&f[0].name||"",c=0):h=l?i:C?o().GrandTotal:i+o().Total,u.yq(c,s,h),t=void 0,1===f.length&&(t=f[0].name),r={path:F,valueFieldName:t,grandTotalLevel:D,showDataAsIndex:b.TWc,rowPathMap:a.subtotalCollection.xOc(b.yOc)},F&&this.aOc(u,s,a.sharedMap,b.Cjc,b.aN,w,z,A,f&&f[0]&&f[0].name,!0),k(g)||(r.collapseIndex=g-1),C?r.isGrandTotal=!0:r.isSubtotal=!0,u.Oic[s]=r},a.uDc=function(a,b,c){return a<b&&c<=1||a+1<b&&c>1?void 0:b},a.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:a.isFilter(),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:o().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),g&&a.zn(0,c,f.ojc(h,i,24,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},a.DFc=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=a.columnDeep,p=a.options,q=a.columnModel,r=d,s=b.rjc,t=0;if(s.length>0&&b.aN<o)for(g=p.fillDownLabels,h=void 0,i=p.subTotalsPosition===e.SubtotalsPosition.none?0:1,j=void 0,k=void 0,l=void 0,m=void 0,m=0;m<s.length;m++){if(h=1,j=s[m],k=this.zjc(a,j,c,r,f),l=k-i,g)for(n=q.ge(c,r),h;h<l;h++)q.yq(c,h+r,n);r+=k,t+=k}return b.aN>=o&&(t=1),t},a.Djc=function(a,b,c,d,e){var f,g,h,i,k,l,m,n,p,q=a.valueFieldsInfo,r=a.columnModel,s=a.columnDeep,t=a.columnValuePosition,u=a.sharedMap,v=q.length,w=d.Ajc,x=d.aN,y=d.nodeName,z=d.Cjc,A=d.$ic;if(!(x>s-1&&0!==s))if(g=j.mjc(u,A,y),h=a.pt.collapse(A,g),e&&x<=t)for(i=h?c:c+(d.wjc+d.xjc-1)*v,k=0;k<v;k++)l=q[k].name,f=0===s?h?g:w?l:g+" "+l:h?g:w?o().Total+" "+l:g+" "+l,r.yq(b,i+k,f),m={path:z,valueFieldName:l,grandTotalLevel:x,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.Oic[i+k]=m;else n=h?c:c+d.wjc+d.$Dc-1,f=0===s?q[0]&&q[0].name||"":h?g:w?o().GrandTotal:g+o().Total,r.yq(b,n,f),p=void 0,1===q.length&&(p=q[0].name),m={path:z,valueFieldName:p,grandTotalLevel:x,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.Oic[n]=m},a.Jjc=function(a,b,c,d,e){var g=new f.Style;return g.textIndent=a*c,g.hAlign=0,g.cellButtons=[{position:void 0===d?f.ButtonPosition.left:d,imageType:f.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:b?r:q,imageSize:{width:18,height:18}}],g},a.Kjc=function(a,b){var c=new f.Style;return c.textIndent=a*b,c},a.Ejc=function(a,b){var c=new f.Style;return c.cellButtons=[{position:void 0===b?f.ButtonPosition.left:b,command:"PivotOutlineButtonToggle",imageType:f.ButtonImageType.custom,visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],c},a.ojc=function(a,b,c,e){var h,i,j;return e?(h=0,b&&(b.sortType===d.SortType.asc&&(h=1),b.sortType===d.SortType.desc&&(h=2)),i=a?[3,4,5][h]:h,j=new f.Style,j.cellButtons=[g.getFilterCellButtonInfo(i,c)],j):{}},a.DOc=function(a){var b,c=void 0;return a&&(c="0px 0px 0px 25px"),b=new f.Style,b.cellPadding=c,b},a}(),b.PivotTableLayoutBase=s},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("Core"),k=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),l=h.Common.j.Fa,m=new h.Common.ResourceManager(i.SR),n=m.getResource.bind(m),o=function(a){p(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c,e,f=a.cornerModel,g=a.columnModel,h=a.rowModel,i=a.valueFieldsInfo,j=a.rowFields,k=a.options,m=g.Xj;f.setRowCount(m),f.setColCount(h.OZ),j.length>0&&(1===i.length&&f.yq(0,0,i[0].name),l(k.rowHeaderCaption)?f.yq(m-1,0,n().RowLabels):f.yq(m-1,0,k.rowHeaderCaption),b=!1,c=null,e=[],d.vhc(j,function(a){!b&&(b=a.isFilter()),!c&&(c=a.zZ),e.push(a.Cj)}),f.zn(m-1,0,this.ojc(b,c,24,a.options.showFilter)),f.Qic(0,{isCompactRoot:!0,fieldName:j[0]&&j[0].Cj||""}),h.Qic(0,{isCompactRoot:!0,compactFieldList:e}))},b.yjc=function(a,b,c,e){var f=this;l(e.options.colHeaderCaption)?a.yq(0,0,n().ColumnLabels):a.yq(0,0,e.options.colHeaderCaption),a.Qic(0,{isCompactRoot:!0,fieldName:b[0].Cj}),d.vhc(b,function(b,c){var d=b.Cj,g=b.isFilter(),h=b.zZ;a.Nic[c+1]={path:d},0===c&&a.zn(0,c,f.ojc(g,h,30,e.options.showFilter))})},b.jjc=function(a){var b,c,d,f,g,h,i,j,k,l,m=a.rootNode,o=a.options,p=a.valueFieldsInfo,q=a.rowFields,r=a.colFields,s=a.rowValuePosition,t=q.length>0?1:0;for(0===t&&1===p.length&&r.length>0&&(t=1),0===q.length&&a.rowValuePosition>-1&&(t+=1),a.rowModel.setColCount(t),b=[],c={},d=[],f=0,g=q;f<g.length;f++)h=g[f],d.push(h.Cj);for(s!==-1&&d.splice(s,0,n().Values),i=0,j=d.length;i<j;i++)c[d[i]]=i,b.push(d[i]);a.rowFieldsIndexes=b,a.rowFieldsMap=c,k=o.subTotalsPosition===e.SubtotalsPosition.bottom,l=this.Ljc(a,m,k,0,p),a.rowModel.setRowCount(l),a.contentModel.setRowCount(l)},b.Mjc=function(a,b){var c,d,f=b.wjc+b.Njc,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return h===e.SubtotalsPosition.top?f+=b.Ojc:h===e.SubtotalsPosition.bottom&&(f+=b.xjc),b.Ajc&&(c=h!==e.SubtotalsPosition.none,d=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,c&&!d?f-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!c&&d&&(f+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(f=b.wjc+b.Njc)),f},b.oXc=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mXc:b.lXc},b.Ljc=function(a,b,c,f,h){var i,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a.rowModel,H=a.rowValuePosition,I=a.rowDeep,J=a.options,K=a.sharedMap,L=a.rowFieldsIndexes,M=a.rowFieldsMap,N=b.Bjc,O=b.nodeName,P=b.aN,Q=b.Ajc,R=b.Cjc,S=b.$ic,T=1,U=0;if(H!==-1&&(H>=P?T=h.length:U=1),i=g.mjc(K,S,O),l=f,m=a.pt.collapse(b.$ic,i)&&P!==I,p=I>P,N){if(Q||a.repeatValueFiledChildLength++,!Q&&0!==H){for(o={path:R,isValueFieldDim:!1},a.valuePositionInfo&&0===a.valuePositionInfo.positionType&&a.valuePositionInfo.display?o.compactLevel=k.iNc(a.rowFields,S,{valuePositionIndex:a.valuePositionInfo.positionIndex,Cj:h[0].name}):o.compactLevel=b.aN-1,p&&(o.rowHeaderLevel=this.uDc(I,P+U,T)),this.njc(G,l,o),q=b.Cjc.split(d.Separator),r=0,s=q.length;r<s;r++)G.aOc(l,L[r],g.mjc(a.sharedMap,L[r],q[r]),L.length-r);G.yq(l,0,i),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill?G.zn(l,0,this.Ejc(m,j.ButtonPosition.leftOfText)):G.zn(l,0,this.Kjc(b.aN-1,a.options.rowLabelIndent)),l++}for(t=void 0,u=0,v=!1,w=0,x=h;w<x.length;w++){if(y=x[w],G.yq(l,0,y.name),G.zn(l,0,this.Kjc(H,a.options.rowLabelIndent)),t={path:R,grandTotalLevel:P,valueFieldName:y.name,isValueFieldDim:!(b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep),rowHeaderLevel:this.uDc(I,P,T),isSigmaValue:!0},a.valuePositionInfo&&0===a.valuePositionInfo.positionType&&a.valuePositionInfo.display?t.compactLevel=k.iNc(a.rowFields,y.name,{valuePositionIndex:a.valuePositionInfo.positionIndex,Cj:y.name}):o.compactLevel=b.aN-1,this.njc(G,l,t),b.aN<I)for(q=b.Cjc.split(d.Separator),H>=0&&H<=P&&q.splice(H,null,y.name),r=0,s=q.length;r<s;r++)q[r]&&G.aOc(l,L[r],L[r]!==n().Values?g.mjc(a.sharedMap,L[r],q[r]):q[r],L.length-r);l++,m?b.aN<=H&&H<I&&!Q&&J.insertBlankLineAfterEachItem&&(this.nXc(a,b,G.Nic.length),l++,u++,v=!0):(b.Ajc&&0===I&&0===H&&(this.Rjc(a,b,l-1,"",h),f=h.length),l+=this.Pjc(a,b,c,l,[y]),!b.Ajc&&P<I&&J.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(l++,this.nXc(a,b,G.Nic.length)))}if(P===I&&J.insertBlankLineAfterEachItem&&(l++,this.nXc(a,b,G.Nic.length)),m)return T=this.Qjc(a,b,l-h.length-u,h,T,void 0,0,!0,v),T+1}else{if(!Q){if(G.yq(l,0,i),o={path:R,grandTotalLevel:P,valueFieldName:h[0]&&h[0].name},p&&(o.rowHeaderLevel=this.uDc(I,P+U,T)),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep?(o.isValueFieldDim=!1,a.options.showDrill?G.zn(l,0,this.Jjc(b.aN-1,a.pt.collapse(b.$ic,i),a.options.rowLabelIndent,j.ButtonPosition.leftOfText)):G.zn(l,0,this.Kjc(b.aN-1,a.options.rowLabelIndent))):(o.isValueFieldDim=!0,G.zn(l,0,this.Kjc(b.aN-1,a.options.rowLabelIndent))),a.valuePositionInfo&&0===a.valuePositionInfo.positionType&&a.valuePositionInfo.display?o.compactLevel=k.iNc(a.rowFields,S,{valuePositionIndex:a.valuePositionInfo.positionIndex,Cj:h[0].name}):o.compactLevel=b.aN-1,this.njc(G,l,o),m)return h.length>1&&a.rowValuePosition>P?(l++,T=this.Qjc(a,b,l,h,T,void 0,0,!0),T+1):T=this.Qjc(a,b,l,h,T,void 0,0);if(b.aN<I)for(q=b.Cjc.split(d.Separator),H>=0&&H<P&&(z=M[n().Values],q.splice(z,null,h[0].name)),r=0,s=q.length;r<s;r++)G.aOc(l,L[r],L[r]!==n().Values?g.mjc(a.sharedMap,L[r],q[r]):q[r],L.length-r);l++}this.Pjc(a,b,c,l,h)}return A=0,B=this.Mjc(a,b),J.insertBlankLineAfterEachItem&&(A=this.oXc(a,b),B+=A),C=f+B-T,E=!0,J.subTotalsPosition===e.SubtotalsPosition.bottom||J.subTotalsPosition===e.SubtotalsPosition.top&&P<H||J.subTotalsPosition===e.SubtotalsPosition.top&&Q?C=f+B-T:J.subTotalsPosition===e.SubtotalsPosition.top&&P>=H?(C=f,D=!0,P===H&&(C=f+B-T,D=!1)):J.subTotalsPosition!==e.SubtotalsPosition.none||!Q||J.grandTotalPosition!==e.GrandTotalPosition.both&&J.grandTotalPosition!==e.GrandTotalPosition.col?E=!1:C=f+B-T,E?(!D&&J.insertBlankLineAfterEachItem&&b.mXc&&!Q&&C--,0===I&&Q?(F=h[0]&&h[0].name||"",G.yq(C,0,F),H===-1&&(t={path:R,rowHeaderLevel:this.uDc(I,P,T)},this.njc(G,C,t)),this.ujc(a,C,b,h,"")):this.Qjc(a,b,C,h,void 0,D)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&A>0&&this.nXc(a,b,C),B},b.Qjc=function(a,b,c,f,h,i,j,m,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=a.rowDeep,J=a.rowModel,K=a.rowValuePosition,L=a.sharedMap,M=a.options,N=a.rowFieldsMap,O=a.rowFieldsIndexes,P=b.aN,Q=b.nodeName,R=b.Ajc,S=b.Cjc,T=b.$ic;if(!R||a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row){if(P<I||0===I){if(p=1,K!==-1&&K>=P&&(p=f.length),q=c,r=q,s=g.mjc(L,T,Q),q>=J.Xj)return;if(t=void 0,t=R?f.length>1&&K>=0?n().Total:n().GrandTotal:f.length>1&&K>=0||M.subtotalsPosition!==e.SubtotalsPosition.bottom?s:s+n().Total,0===I&&(t=f[0]&&f[0].name||""),u=a.pt.collapse(b.$ic,s)?K<=0?s:"":t,v=a.columnValuePosition!==-1,w={path:S,rowHeaderLevel:this.uDc(I,P,p),grandTotalLevel:P},d.Fa(j)||(w.collapseIndex=j),R?w.isGrandTotal=!0:w.isSubtotal=!0,a.valuePositionInfo&&0===a.valuePositionInfo.positionType&&a.valuePositionInfo.display?w.compactLevel=k.iNc(a.rowFields,T,{valuePositionIndex:a.valuePositionInfo.positionIndex,Cj:f[0].name}):w.compactLevel=b.aN-1,v){for(J.yq(q,0,u),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)J.aOc(q,O[y],O[y]!==n().Values?g.mjc(a.sharedMap,O[y],x[y]):x[y],O.length-y);this.EOc(J,q,w.rowHeaderLevel-1,a.options.rowLabelIndent),this.njc(J,q,w),this.tjc(a,b,q,S)}else{if(0===a.valueFieldsInfo.length){if(!i){for(J.yq(q,0,u),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)J.aOc(q,O[y],O[y]!==n().Values?g.mjc(a.sharedMap,O[y],x[y]):x[y],O.length-y);this.EOc(J,q,w.rowHeaderLevel-1,a.options.rowLabelIndent)}this.njc(J,q,w)}for(A=0,B=f;A<B.length;A++){for(C=B[A],D=C.name,
E=C.cacheName,F=C.subtotalType,G=C.subtotalText,w={path:S,rowHeaderLevel:this.uDc(I,P,p),grandTotalLevel:P,valueFieldName:D},d.Fa(j)||(w.collapseIndex=j),m&&(w.collapse=!0),o||(p>1?J.yq(q,0,u+" "+D):J.yq(q,0,u)),x=b.Cjc.split(d.Separator),K>=0&&K<P&&(H=N[n().Values],x.splice(H,null,D)),y=0,z=x.length;y<z-1;y++)J.aOc(q,O[y],O[y]!==n().Values?g.mjc(a.sharedMap,O[y],x[y]):x[y],O.length-y);this.EOc(J,q,w.rowHeaderLevel-1,a.options.rowLabelIndent),R?w.isGrandTotal=!0:w.isSubtotal=!0,a.valuePositionInfo&&0===a.valuePositionInfo.positionType&&a.valuePositionInfo.display?w.compactLevel=k.iNc(a.rowFields,b.Bjc?D:T,{valuePositionIndex:a.valuePositionInfo.positionIndex,Cj:D}):w.compactLevel=b.aN-1,this.njc(J,q,w),this.tjc(a,b,q,S,E,F,G,D),q++,o&&(q++,h++)}}this.ujc(a,r,b,f)}return R||!M.insertBlankLineAfterEachItem||o||(this.nXc(a,b,J.Nic.length),l(h)||h++),h}},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.EOc=function(a,b,c,d){var e=a.Gq(b,0)||new j.Style;e.Yo(this.Kjc(c,d)),a.zn(b,0,e)},b.Pjc=function(a,b,c,e,f){var h,i,j,k,m,o,p,q,r,s,t,u,v=a.rowDeep,w=a.rowValuePosition,x=a.rowFieldsIndexes,y=a.rowModel,z=b.rjc,A=b.aN,B=z.length;if(A>=v)for(h=b.Cjc.split(d.Separator),w>=0&&!l(f)&&h.splice(w,null,f[0].name),i=0,j=h.length;i<j;i++)h[i]&&y.aOc(e-1,x[i],x[i]!==n().Values?g.mjc(a.sharedMap,x[i],h[i]):h[i],x.length-i);if(k=0,B>0)for(m=e,o=0,p=z;o<p.length;o++)q=p[o],r=0,s=q.aN,s>v?(t=m-1,b.Ajc&&0===v&&a.columnDeep>0&&w===-1&&(t=m),this.Rjc(a,q,t,"",f)):(s===v&&(u=q.Bjc?m+1:m,this.ujc(a,u,q,f)),r=this.Ljc(a,q,c,m,f),k+=r,m+=r);return k},b.Rjc=function(a,b,c,e,g){var h,i,j,k,m,n,o,p,q,r,s,t,u,v=a.columnValuePosition,w=a.contentModel,x=a.colMap,y=b.rjc,z=b.nodeName,A=b.AOc;if(""!==e&&(e+=d.Separator),h=v!==-1,0===y.length)for(i=0,j=g;i<j.length;i++)k=j[i],m=k.name,n=k.cacheName,o=k.subtotalText,p=e,0!==a.columnDeep&&(p+=z),h&&(""!==p?p+=d.Separator+m:p=m),q=x[p],l(q)||(r=!1,a.subtotalCollection.jOc[m]&&(a.subtotalCollection.jOc[m].needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(a.subtotalCollection.jOc[m].showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&w.yq(c,q,f.bjc(a.subtotalCollection,A,n,o,b.wOc,b.aN,m)));else for(s=0,t=y;s<t.length;s++)u=t[s],this.Rjc(a,u,c,e+z,g);b.p1b||this.ujc(a,c,b,g,e+z)},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableCompactLayout=o},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d={frameColor:"rgba(100,100,100,1)",nameColor:"rgba(50,50,50,1)",panelTitleColor:"rgba(50,50,50)",tableHeadColor:"rgba(77,130,184,1)",tableHeadLine:"rgba(255,255,255,1)",tableContent:"rgba(128,128,128,1)",tableContentRim:"rgba(193,211,230,1)",recordBookFrameColor:"rgba(153,183,214,1)",recordColor:"rgba(179,179,179,1)",MagnifierFrameColor:"rgba(196,213,231,1)",tickColor:"rgba(216,99,68,1)",font:"12px Regular",textAlign:"center",nameBaseline:"hanging",frameLineWidth:2,inputLineWidth:2};function g(a,b,c,d,e,f,g,k){var m,n,o,p,q,r,s,t,u,v,w,x;f<3||e<3||(m=.125,n=.08,o=.75,p=20,q=11,r=194,s=362,t=f/r,u=e/s,v=e-2,w=0,a.save(),a.rect(g.x,g.y,g.width,g.height),a.clip(),v>1&&(a.translate(c,d),h(a,f,e),v-=2),v>0&&(a.translate((f-2)*m,(e-2)*n),i(a,f*o,p,b),v-=(e-2)*n+p),v>0&&(a.translate((f-2)*o/2,(e-2)*n),w=j(a,f,k),v-=(e-2)*n+w),v>0&&(x=.7*v,a.translate(0,.9*x),l(a,f-q*t,x,Math.min(t,u))),a.restore())}b.Sjc=g;function h(a,b,c){a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.frameLineWidth,a.strokeRect(0,0,b,c),a.fillStyle=d.tableHeadLine,a.fillRect(0,0,b,c),a.restore()}function i(a,b,c,e){var f=.5;a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.inputLineWidth,a.strokeRect(0,0,b,c),a.rect(1,0,b-2,c),a.clip(),a.translate(b*f,0),k(a,e),a.restore()}function j(a,b,c){var e,f=10,g=20,h=t(c,b-f,d.font);for(e=0;e<h.length;e++)a.translate(0,g),k(a,h[e]);return h.length*g}function k(a,b){a.save(),a.textBaseline=d.nameBaseline,a.textAlign=d.textAlign,a.font=d.font,a.fillStyle=d.nameColor,a.fillText(b,0,4),a.restore()}function l(a,b,c,d){q(a,b,c),m(a,d)}function m(a,b){var c=180,d=152,e=63,f=54,g=70,h=152,i=32;a.save(),a.translate(-c*b*.5,-d*b*.5),n(a,e,f,b),a.translate((c-g)*b,0),o(a,g,h,b),a.translate(-2*b,64*b),p(a,i,b),a.restore()}function n(a,b,c,e){var f,g,h,i,j=8,k=13,l=7,m=2,n=4,o=5,p=49,q=45;for(a.save(),a.scale(e,e),r(a,0,0,k,j,d.tableHeadColor,!0),r(a,n-1,n-1,l,m,d.tableHeadLine,!0),r(a,k+1,0,p,j,d.tableHeadColor,!0),f=0,g=0,h=0,h=0;h<4;h++)f=(l+o)*h+(k+o-1),r(a,f,n-1,l,m,d.tableHeadLine,!0);for(r(a,0,j+1,k,q,d.tableHeadColor,!0),h=0;h<7;h++)g=(m+n)*h+12,r(a,n-1,g,l,m,d.tableHeadLine,!0);for(r(a,k+1,j+1,p,q,d.tableContentRim,!0),h=0;h<7;h++)for(g=(n+m)*h+j+n,i=0;i<4;i++)f=(l+o)*i+(k+o-1),r(a,f,g,l,m,d.tableContent,!0);a.restore()}function o(a,b,c,e){var f,g,h,i,j=57,k=55,l=7,m=41,n=3;for(a.save(),a.scale(e,e),r(a,0,0,b,c,d.tableContentRim,!0),r(a,l+1,8,m,n,d.tableHeadColor,!0),r(a,l,19,j,k,d.recordBookFrameColor,!1),r(a,l+1,20,j-2,k-2,d.tableHeadLine,!0),f=0,g=0;g<9;g++)f=26+5*g,r(a,11,f,2,2,d.recordColor,!0),r(a,14,f,42,2,d.recordColor,!0);for(r(a,8,82,m,n,d.tableHeadColor,!0),h=0,g=0;g<2;g++)for(h=92+30*g,i=0;i<2;i++)f=7+31*i,r(a,f,h,26,24,d.recordBookFrameColor,!1),r(a,f+1,h+1,24,22,d.tableHeadLine,!0);a.restore()}function p(a,b,c){a.save(),a.scale(c,c),a.beginPath(),a.save(),a.arc(0,0,b,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b,0,2*Math.PI,!0),a.strokeStyle=d.MagnifierFrameColor,a.stroke(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.fillStyle=d.tableHeadLine,a.fill();var e=0,f=0;for(f=0;f<3;f++)e=24-18*f,r(a,-16,-e,13,13,d.tableContent,!1),r(a,1,-e+4,35,5,d.recordColor,!0);s(a,-15,-6,11),a.restore(),a.restore()}function q(a,b,c){a.save(),a.fillStyle=d.tableHeadLine,a.fillRect(.5*-b,.5*-c,b,c),a.restore()}function r(a,b,c,d,e,f,g){a.save(),a.translate(b,c),g?(a.fillStyle=f,a.fillRect(0,0,d,e)):(a.strokeStyle=f,a.strokeRect(0,0,d,e)),a.restore()}function s(a,b,c,e){a.save();var f=e;a.translate(Math.round(b+f/2),Math.round(c+f/2)),a.strokeStyle="red",a.rotate(Math.PI*-.25),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.25*-f,.2*f,.5*f),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.05*f,.75*f,.2*f),a.closePath(),a.fill(),a.stroke(),a.restore()}function t(a,b,c){var d,e,f,g,h,i=[];if(a&&a.length>0){for(d=a.split(/\r\n|\r|\n/),e=w(),e.save(),c&&(e.font=c),f=0,g=d.length;f<g;f++)h=u(e,d[f],b),h&&(0===h.length?i.push(""):h.forEach(function(a){i.push(a)}));e.restore()}return i}function u(a,b,c){var d,e,f,g,h,i,j=b.split(" "),k=[],l="",m=0,n=a.measureText(" ").width;if(1===b.length)return j;for(d=0,e=j.length;d<e;d++)f=j[d],g=a.measureText(f).width,g>c?(l.length>0&&k.push(l),h=v(a,j[d],c,g),h.forEach(function(a){k.push(a)}),l="",m=0):(i=l+f,m+=g+n,m>c?m-n<=c?(k.push(i),m=0,l=""):(k.push(l),m=g+n,m>c?(k.push(f),m=0,l=""):l=f+" "):l=i+" ");return l.length>0&&k.push(l),k}function v(a,b,c,d){var e,f,g,h,i=Math.ceil(d/c),j=b.length/i,k=[];for(i=0;c>0&&i<b.length;){for(e=b.substring(i,i+j),f=a.measureText(e).width,g=f<=c?1:-1,h=0;(f<c&&g>0||f>c&&g<0)&&(h+=g,!(i+j+h>=b.length||i+j+h===0));)e=b.substring(i,i+j+h),f=a.measureText(e).width;if(h-=g,!(i+j+h>i))break;k.push(b.substring(i,i+j+h)),i=i+j+h}return k}function w(){var a,b=f;return b||(a=document.createElement("canvas"),a.hidden=!0,a.width=1,a.height=1,document.body.appendChild(a),e=a,f=b=a.getContext("2d")),b}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=h.Common.j.Fa,k=new h.Common.ResourceManager(i.SR),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=f.Xj;e.setRowCount(m),e.setColCount(g.OZ),k.length>0&&(1===h.length&&e.yq(0,0,h[0].name),b=m-1,d.vhc(Object.keys(i),function(d){var f,h,k,m,n=i[d];e.yq(b,n,d),f=d!==l().Values,f&&(h=j.$Sb(d),k=h.isFilter(),m=h.zZ,e.zn(b,n,c.ojc(k,m,30,a.options.showFilter))),e.Qic(n,{isCompactRoot:!1,fieldName:d,isDim:f}),g.Oic[n]={path:d}}))},b.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:a.isFilter(),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.Nic[c+1]={path:d},g&&a.zn(0,c,f.ojc(h,i,30,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},b.oXc=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mXc:b.lXc},b.Mjc=function(a,b,c){var d,f,g=b.wjc+b.Njc,h=a.options,i=h.subTotalsPosition,j=h.grandTotalPosition;return i===e.SubtotalsPosition.top?g+=b.Ojc:i===e.SubtotalsPosition.bottom&&(g+=b.xjc),b.Ajc&&(d=i!==e.SubtotalsPosition.none,f=j!==e.GrandTotalPosition.none&&j!==e.GrandTotalPosition.row,d&&!f?g-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!d&&f&&(g+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(g=b.wjc+b.Njc)),g},b.jjc=function(a){var b,c,d,f,g;this.Tjc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=c.subTotalsPosition===e.SubtotalsPosition.bottom,g=this.Ljc(a,b,f,0,d),a.rowModel.setRowCount(g),a.contentModel.setRowCount(g)},b.Ljc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=a.rowFieldsMap,E=a.rowModel,F=a.rowValuePosition,G=a.options,H=a.sharedMap,I=a.rowDeep,J=a.rowFieldsIndexes,K=b.Bjc,L=b.$ic,M=b.nodeName,N=b.aN,O=b.Ajc,P=b.Cjc,Q=D[L],R=1;if(F!==-1&&F>=N&&(R=h.length),i=g.mjc(H,L,M),k=f,m=a.pt.collapse(b.$ic,i)&&N!==I,K){if(O||a.repeatValueFiledChildLength++,n=D[l().Values],!O&&0!==F){for(E.yq(k,Q,i),this.njc(E,k,{path:P,isValueFieldDim:!1,rowHeaderLevel:this.uDc(I,N,R)}),o=b.Cjc.split(d.Separator),p=0,q=o.length;p<q;p++)E.aOc(k,J[p],g.mjc(a.sharedMap,J[p],o[p]),J.length-p);b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&E.zn(k,Q,this.Ejc(m)),k++}for(r=void 0,s=0,t=!1,u=0,v=h;u<v.length;u++){if(w=v[u],E.yq(k,n,w.name),r={path:P,rowHeaderLevel:this.uDc(I,N,R),isValueFieldDim:!(b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep),valueFieldName:w.name},this.njc(E,k,r),b.aN<I)for(o=b.Cjc.split(d.Separator),o.splice(n,null,w.name),p=0,q=o.length;p<q;p++)o[p]&&E.aOc(k,J[p],J[p]!==l().Values?g.mjc(a.sharedMap,J[p],o[p]):o[p],J.length-p);k++,m?b.aN<=F&&F<I&&!O&&G.insertBlankLineAfterEachItem&&(this.nXc(a,b,E.Nic.length),k++,s++,t=!0):(b.Ajc&&0===I&&0===F&&(this.Rjc(a,b,k-1,"",h),f=h.length),k+=this.Pjc(a,b,c,k,[w]),!b.Ajc&&N<I&&G.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(k++,this.nXc(a,b,E.Nic.length)))}if(N===I&&G.insertBlankLineAfterEachItem&&(k++,this.nXc(a,b,E.Nic.length)),m)return R=this.Qjc(a,b,k-h.length-s,h,R,void 0,Q,!0,t),R+1}else{if(!j(Q)){if(E.yq(k,Q,i),r={path:P,rowHeaderLevel:this.uDc(I,N,R),valueFieldName:h[0]&&h[0].name},b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep?(r.isValueFieldDim=!1,a.options.showDrill&&E.zn(k,Q,this.Ejc(a.pt.collapse(b.$ic,i)))):r.isValueFieldDim=!0,this.njc(E,k,r),m)return F>N?(k++,R=this.Qjc(a,b,k,h,R,!1,Q,!0),R+1):R=this.Qjc(a,b,k,h,R,void 0,Q);if(b.aN<I)for(o=b.Cjc.split(d.Separator),F>=0&&F<N&&(n=D[l().Values],o.splice(n,null,h[0].name)),p=0,q=o.length;p<q;p++)E.aOc(k,J[p],J[p]!==l().Values?g.mjc(a.sharedMap,J[p],o[p]):o[p],J.length-p);k++}this.Pjc(a,b,c,k,h)}return x=0,y=this.Mjc(a,b,c),G.insertBlankLineAfterEachItem&&(x=this.oXc(a,b),y+=x),z=f+y-R,B=!0,G.subTotalsPosition===e.SubtotalsPosition.bottom||G.subTotalsPosition===e.SubtotalsPosition.top&&N<F||G.subTotalsPosition===e.SubtotalsPosition.top&&O?z=f+y-R:G.subTotalsPosition===e.SubtotalsPosition.top&&N>=F?(z=f,A=!0,N===F&&(z=f+y-R,A=!1)):G.subTotalsPosition!==e.SubtotalsPosition.none||!O||G.grandTotalPosition!==e.GrandTotalPosition.both&&G.grandTotalPosition!==e.GrandTotalPosition.col?B=!1:z=f+y-R,B?(!A&&G.insertBlankLineAfterEachItem&&b.mXc&&!O&&z--,0===I&&O?(C=h[0]&&h[0].name||"",E.yq(z,0,C),F===-1&&(r={path:P,rowHeaderLevel:this.uDc(I,N,R)},this.njc(E,z,r)),this.ujc(a,z,b,h,"")):this.Qjc(a,b,z,h,void 0,A)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&x>0&&this.nXc(a,b,z),y},b.Qjc=function(a,b,c,f,h,i,k,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.rowDeep,K=a.rowModel,L=a.rowFieldsMap,M=a.rowValuePosition,N=a.sharedMap,O=a.options,P=a.rowFieldsIndexes,Q=b.aN,R=b.nodeName,S=b.Ajc,T=b.Cjc,U=b.$ic;if(!b.Ajc||a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row){if(Q<J||0===J){if(o=S?0:L[b.$ic],p=1,M!==-1&&M>=Q&&(p=f.length),q=c,r=q,q>=K.Xj)return;if(s=void 0,0===J?s=f[0]&&f[0].name||"":(t=g.mjc(N,U,R),s=a.pt.collapse(b.$ic,t)?t:S?f.length>1&&M>=0?l().Total:l().GrandTotal:f.length>1&&M>=0||f.length<2&&O.subtotalsPosition===e.SubtotalsPosition.top?t:t+l().Total),u=a.columnValuePosition!==-1,v={path:T,rowHeaderLevel:this.uDc(J,Q,p),grandTotalLevel:Q},d.Fa(k)||(v.collapseIndex=k),S?v.isGrandTotal=!0:v.isSubtotal=!0,u){if(!i)for(K.yq(q,o,s),w=b.Cjc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.njc(K,q,v),this.tjc(a,b,q,T)}else{if(0===a.valueFieldsInfo.length){if(!i)for(K.yq(q,o,s),w=b.Cjc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.njc(K,q,v)}for(z=0,A=f;z<A.length;z++){for(B=A[z],C=B.name,D=B.subtotalType,E=B.cacheName,F=B.subtotalText,v={path:T,rowHeaderLevel:this.uDc(J,Q,p),grandTotalLevel:Q,valueFieldName:C},d.Fa(k)||(v.collapseIndex=k),m&&(v.collapse=!0),G=void 0,H=void 0,void 0===i||p>1?(G=M>=v.grandTotalLevel?s+" "+C:s,H=o):i?(G=s,m||(H=o)):(G=C,H=a.valuePositionInfo.positionIndex),n||K.yq(q,H,G),w=b.Cjc.split(d.Separator),M>=0&&M<Q&&(I=L[l().Values],w.splice(I,null,f[0].name)),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);S?v.isGrandTotal=!0:v.isSubtotal=!0,this.njc(K,q,v),this.tjc(a,b,q,T,E,D,F,C),q++,n&&(q++,h++)}}this.ujc(a,r,b,f)}return S||!O.insertBlankLineAfterEachItem||n||(this.nXc(a,b,K.Nic.length),j(h)||h++),h}},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.Pjc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=a.rowDeep,D=a.options,E=a.rowFieldsMap,F=a.rowModel,G=a.rowValuePosition,H=a.rowFieldsIndexes,I=1,J=b.rjc,K=b.aN,L=J.length;if(K>=C)for(i=b.Cjc.split(d.Separator),G>=0&&!j(h)&&i.splice(G,null,h[0].name),k=0,m=i.length;k<m;k++)i[k]&&F.aOc(f-1,H[k],H[k]!==l().Values?g.mjc(a.sharedMap,H[k],i[k]):i[k],H.length-k);if(n=0,L>0)for(o=f,p=D.fillDownLabels,q=void 0,r=void 0,s=void 0,t=D.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,u=this.DOc(D.showDrill),v=0,w=J;v<w.length;v++)if(x=w[v],y=0,K>=C)z=o-1,b.Ajc&&0===C&&a.columnDeep>0&&G===-1&&(z=o),this.Rjc(a,x,z,"",h);else{if(y=this.Ljc(a,x,c,o,h),p)for(q=E[x.$ic],s=y+o-t,r=F.ge(o,q),A=o+1;A<s;A++)F.Nic[A]&&!F.Nic[A].isBlankRow&&(F.yq(A,q,r),F.zn(A,q,u));n+=y,K+1===C&&(B=x.Bjc?o+1:o,this.ujc(a,B,x,h)),o+=y}return n},b.Rjc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v=a.columnValuePosition,w=a.contentModel,x=a.colMap,y=b.rjc,z=b.nodeName,A=b.AOc;if(""!==e&&(e+=d.Separator),h=v!==-1,0===y.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=z),h&&(""!==p?p+=d.Separator+m:p=m),q=x[p],j(q)||(r=!1,a.subtotalCollection.jOc[m]&&(a.subtotalCollection.jOc[m].needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(a.subtotalCollection.jOc[m].showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&w.yq(c,q,f.bjc(a.subtotalCollection,A,n,o,b.wOc,b.aN,m)));else for(s=0,t=y;s<t.length;s++)u=t[s],this.Rjc(a,u,c,e+z,g);b.p1b||this.ujc(a,c,b,g,e+z)},b.Tjc=function(a){var b,c,d,e,f,g,h,i,j=a.rowModel,k=a.rowFields,m=a.rowValuePosition,n=a.valueFieldsInfo,o=a.colFields,p=k.length;for(0===p&&1===n.length&&o.length>0&&(p=1),b=[],c=0,d=k;c<d.length;c++)e=d[c],b.push(e.Cj);for(m!==-1&&(p+=1,b.splice(m,0,l().Values)),j.setColCount(p),f={},g=[],h=0,i=b.length;h<i;h++)f[b[h]]=h,g.push(b[h]);a.rowFieldsMap=f,a.rowFieldsIndexes=g},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableOutlineLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=g.Common.j.Fa,k=new g.Common.ResourceManager(h.SR),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=f.Xj;e.setRowCount(m),e.setColCount(g.OZ),k.length&&(1===h.length&&e.yq(0,0,h[0].name),b=m-1,d.vhc(Object.keys(i),function(d,f){var h,i,k,m;e.yq(b,f,d),h=d!==l().Values,h&&(i=j.$Sb(d),k=i.isFilter(),m=i.zZ,e.zn(b,f,c.ojc(k,m,30,a.options.showFilter))),e.Qic(f,{isCompactRoot:!1,fieldName:d,isDim:h}),g.Oic[f]={path:d}}))},b.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:a.isFilter(),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.Nic[c+1]={path:d},g&&a.zn(0,c,f.ojc(h,i,30,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},b.jjc=function(a){var b,c,d,f,g,h;this.Tjc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=a.rowModel,g=a.contentModel,h=c.subTotalsPosition!==e.SubtotalsPosition.none,this.Ljc(a,b,h,0,d),f.setRowCount(f.Nic.length),g.setRowCount(f.Nic.length)},b.Ljc=function(a,b,c,d,f){var g,h,k,m,n,o,p,q,r,s,t,u,v,w,x,y=a.rowFieldsMap,z=a.rowModel,A=a.rowValuePosition,B=a.rowDeep,C=a.sharedMap,D=b.Bjc,E=b.$ic,F=b.nodeName,G=b.aN,H=b.Ajc,I=b.Cjc,J=y[E],K=1,L=a.options.subTotalsPosition!==e.SubtotalsPosition.none,M=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row;if(A!==-1&&A>=G&&(K=f.length),g=i.mjc(C,E,F),h=d,k=a.pt.collapse(b.$ic,g)&&G!==B,D){for(m=y[l().Values],H||0===A||(z.yq(h,J,g),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.Ejc(k))),n=void 0,o=0,p=!1,q=0,r=f;q<r.length;q++)s=r[q],z.yq(h,m,s.name),n={path:I,rowHeaderLevel:this.uDc(B,G,K)},K>1&&(n.valueFieldName=s.name,n.isValueFieldDim=!0),this.njc(z,h,n),k?b.aN<=A&&A<B&&!H&&a.options.insertBlankLineAfterEachItem?(this.nXc(a,b,z.Nic.length),h++,h++,o++,p=!0):h++:(b.Ajc&&0===B&&0===A&&(this.Rjc(a,b,h,"",f),d=f.length),h+=this.Pjc(a,b,c,h,[s],!0),!b.Ajc&&G<B&&a.options.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(h++,this.nXc(a,b,z.Nic.length)));if(G===B&&a.options.insertBlankLineAfterEachItem&&(h++,this.nXc(a,b,z.Nic.length)),k)return K=this.Qjc(a,b,c,h-K-o,f,K,!0,J,!0,p),c||(K+=o),K}else{if(!j(J)&&(z.yq(h,J,g),this.njc(z,h,{path:I,rowHeaderLevel:this.uDc(B,G,K),valueFieldName:f[0]&&f[0].name}),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.Ejc(k)),k))return t=!0,0!==a.valuePositionInfo.positionIndex&&(t=!1),K=this.Qjc(a,b,c,h,f,K,t,J,!0);this.Pjc(a,b,c,h,f)}return u=this.Mjc(a,b)||K,v=0,a.options.insertBlankLineAfterEachItem&&(v=this.oXc(a,b),u+=v),w=d+u-K,L||H&&M?(a.options.insertBlankLineAfterEachItem&&b.mXc&&!H&&w--,0===B&&H?(x=f[0]&&f[0].name||"",z.yq(w,0,x),A===-1&&(n={path:I,rowHeaderLevel:this.uDc(B,G,K)},this.njc(z,w,n)),this.ujc(a,w,b,f,"")):A<=0?this.Qjc(a,b,c,w,f,void 0,!0):this.Qjc(a,b,c,w,f)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&v>0&&this.nXc(a,b,w),u},b.oXc=function(a,b){return a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc},b.Mjc=function(a,b){var c,d,f,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return c=h!==e.SubtotalsPosition.none?b.wjc+b.$Dc+b.COc:b.wjc+b.COc,b.Ajc&&(0===a.rowFields.length&&(c=b.wjc+b.COc),d=h!==e.SubtotalsPosition.none,f=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,d&&!f?c-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:f&&!d&&(c+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c},b.Qjc=function(a,b,c,f,g,h,k,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=a.rowDeep,L=a.rowModel,M=a.rowFieldsMap,N=a.sharedMap,O=a.options,P=a.rowValuePosition,Q=a.rowFieldsIndexes,R=b.aN,S=b.nodeName,T=b.Ajc,U=b.Cjc,V=b.$ic,W=!1;if(T){if(a.options.grandTotalPosition===e.GrandTotalPosition.none||a.options.grandTotalPosition===e.GrandTotalPosition.row)return;W=!0}if(c&&R<K||0===K||W){if(p=1,P!==-1&&P>=R&&(p=g.length),q=T?0:M[b.$ic],r=f,s=r,r>=L.Xj)return;if(t=void 0,0===K?t=g[0]&&g[0].name||"":(u=i.mjc(N,V,S),t=a.pt.collapse(b.$ic,u)?u:T?g.length>1&&P>=0?l().Total:l().GrandTotal:g.length>1&&P>0||g.length<2&&O.subtotalsPosition===e.SubtotalsPosition.none?u:u+l().Total),v=a.columnValuePosition!==-1){for(w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),L.yq(r,q,t),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);this.njc(L,r,w),this.tjc(a,b,r,U)}else{if(w=void 0,0===a.valueFieldsInfo.length){for(L.yq(r,q,t),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),this.njc(L,r,w)}for(A=0,B=g;A<B.length;A++){for(C=B[A],D=C.cacheName,E=C.subtotalType,F=C.subtotalText,G=C.name,w={path:U,grandTotalLevel:R,valueFieldName:G},T?w.isGrandTotal=!0:w.isSubtotal=!0,H=void 0,I=void 0,n&&(w.collapse=!0),void 0===k||p>1?(H=t+" "+G,I=q):k?(H=t,n||(I=q)):(H=G,I=a.valuePositionInfo.positionIndex),w.valueFieldName=G,o||L.yq(r,I,H),x=b.Cjc.split(d.Separator),P>=0&&P<R&&(J=M[l().Values],x.splice(J,null,H)),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);d.Fa(m)||(w.collapseIndex=m),this.njc(L,r,w),this.tjc(a,b,r,U,D,E,F,G),r++,o&&(r++,h++)}}this.ujc(a,s,b,g)}return T||!O.insertBlankLineAfterEachItem||o||(this.nXc(a,b,L.Nic.length),j(h)||h++),h},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.Pjc=function(a,b,c,f,g,h){var k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=a.rowDeep,C=a.rowModel,D=a.options,E=a.rowFieldsMap,F=a.rowValuePosition,G=a.rowFieldsIndexes,H=1,I=b.rjc,J=b.aN,K=I.length;if(J>=B)for(k=b.Cjc.split(d.Separator),F>=0&&!j(g)&&k.splice(F,null,g[0].name),m=0,n=k.length;m<n;m++)k[m]&&C.aOc(f,G[m],G[m]!==l().Values?i.mjc(a.sharedMap,G[m],k[m]):k[m],G.length-m);if(o=0,K>0)for(p=f,q=D.fillDownLabels,r=void 0,s=void 0,t=void 0,u=D.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,v=this.DOc(D.showDrill),w=0,x=I;w<x.length;w++)if(y=x[w],J>=B)this.Rjc(a,y,p,"",g);else{if(J+1===B&&this.ujc(a,p,y,g),z=this.Ljc(a,y,c,p,g),q)for(r=E[y.$ic],t=z+p-u,s=C.ge(p,r),A=p+1;A<t;A++)C.Nic[A]&&!C.Nic[A].isBlankRow&&(C.yq(A,r,s),C.zn(A,r,v));p+=z,o+=z}return J>=B&&(o=1),o},b.Rjc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v=a.columnValuePosition,w=a.contentModel,x=a.colMap,y=b.rjc,z=b.nodeName,A=b.AOc;if(""!==e&&(e+=d.Separator),h=v!==-1,0===y.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=z),h&&(""!==p?p+=d.Separator+m:p=m),q=x[p],j(q)||(r=!1,a.subtotalCollection.jOc[m]&&(a.subtotalCollection.jOc[m].needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(a.subtotalCollection.jOc[m].showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&w.yq(c,q,f.bjc(a.subtotalCollection,A,n,o,b.wOc,b.aN,m)));else for(s=0,t=y;s<t.length;s++)u=t[s],this.Rjc(a,u,c,e+z,g);b.p1b||this.ujc(a,c,b,g,e+z)},b.Tjc=function(a){var b,c,d,f,g,h,i,j,k,m=a.rowModel,n=a.rowFields,o=a.rowValuePosition,p=a.rootNode,q=a.valueFieldsInfo,r=a.colFields,s=n.length;for(0===s&&1===q.length&&r.length>0&&(s=1),b=p.wjc+p.COc+(a.options.subTotalsPosition===e.SubtotalsPosition.none?p.lXc:p.mXc),0!==n.length&&(b+=a.options.subTotalsPosition!==e.SubtotalsPosition.none?p.$Dc:a.rowValuePosition===-1?1:a.valueFieldsInfo.length,a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||(b-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c=[],d=0,f=n;d<f.length;d++)g=f[d],c.push(g.Cj);for(o!==-1&&(s+=1,c.splice(o,0,l().Values)),m.setColCount(s),m.setRowCount(b),a.contentModel.setRowCount(b),h={},i=[],j=0,k=c.length;j<k;j++)h[c[j]]=j,i.push(c[j]);a.rowFieldsMap=h,a.rowFieldsIndexes=i},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableTabularLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=c("SheetsCalc"),m=c("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),n=c("ConditionalFormatting"),o=c("./dist/plugins/pivot/pivot-util.js"),p=c("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),q=e.Common.D,r=null,s=e.Common.j.Ca,t=new e.Common.ResourceManager(k.SR),u=t.getResource.bind(t),v="pivot",w=d.GC$,x=w.isEmptyObject,y=e.Common.j.Fa,z=e.Common.u.Ob,A=function(){function a(a){this.Vjc=[],this.kj=a,this.GOc={},this.HOc={}}return a.prototype.all=function(){return this.Vjc.concat([])},a.prototype.add=function(a,b,c,e,f,g,j){var k,l,m,n,o=this.kj.parent;return o&&(k=!o.ekc(a))?(h.IOc(new d.Range(0,0,0,0),new d.Range(c,e,18,3),this.kj,a,!1,i.overlapCheck.value),l=o.Wjc(b),l||(l=o.Xjc(a,b)),m=o.Yjc(l.getName(),a),n=new h.PivotTable(a,this.kj,c,e,f,g,j,m),this.Lla(n),this.kj.cMc()&&this.kj.repaint(),n):null},a.prototype.Lla=function(a,b){a&&(this.RVa(a,"add",void 0,b),this.Vjc.push(a),a.vic.addPivotView(a),this.kj.parent.Zjc(a.name(),!0),w[w.sd]({tc:this.kj.parent},1),a.iT()||a.vic.Thc())},a.prototype.RVa=function(a,b,c,d){var e,f,g=this,h=g.kj;h&&(f=h.ITa,f.zTa&&("add"===b?e={type:b,value:a.Cj,isMove:d,pivotType:0}:"remove"===b&&(e={type:b,value:a,index:c,isMove:d,pivotType:0}),f.JOc(a,e)))},a.prototype.RUa=function(a){if(a){var b=this,c,d,e;a.type?(c=a.type,d=a.value,e=a.isMove):(c=a.value.type,d=a.value.value,e=a.value.isMove),"add"===c?b.KOc(d,e):"remove"===c&&b.LOc(a.value)}},a.prototype.KOc=function(a,b){this.Ola(a,b)},a.prototype.LOc=function(a){var b,c=this.Vjc,d=a.value,e=a.index;this.Vjc=c.slice(0,e).concat(d).concat(c.slice(e)),b=d.vic,f.vhc(b.Nhc,function(a){a instanceof m.PivotPanel&&a.attach(d)}),b.Thc(),this.kj.parent.Zjc(d.Cj,!1),w[w.sd]({tc:this.kj.parent},1),this.kj.repaint()},a.prototype.adrs=function(){var a,b=this;b.dkc={},b.Vjc=[],a=this.kj&&this.kj.parent,a&&a.AO&&a.AO.reset(),this.kj&&this.kj.repaint()},a.prototype.MOc=function(a,b,c,d){var e,f,g,h,i,j=this.all();for(e=0;e<j.length;e++)if(f=j[e],g=f.getRange(),h=g.page,i=g.content,h&&h.intersect(a,b,c,d)||i.intersect(a,b,c,d))return this.kj.Os(10,u().PivotTableErrorMessage_MakeChange),!1;return!0},a.prototype.remove=function(a){var b=this.Vjc,c=b.length;c>0&&(this.Ola(a,!1),this.kj.repaint())},a.prototype.Ola=function(a,b){var c,d,e,g=this.Vjc,h=g.length;for(c=h-1;c>=0;c--)if(g[c].Cj===a){d=g[c].vic,e=this.Vjc.splice(c,1)[0],this.RVa(e,"remove",c,b),b||f.vhc(d.Nhc,function(a){a instanceof m.PivotPanel&&a.detach()}),this.kj.parent.Zjc(a,!1),w[w.sd]({tc:this.kj.parent},1);break}this.kj.repaint()},a.prototype.get=function(a){var b,c,d;for(b=0,c=this.Vjc;b<c.length;b++)if(d=c[b],d.Cj===a)return d;return null},a.prototype.Hhc=function(){var a,b,c,d=this.Vjc;for(a=0,b=d;a<b.length;a++)c=b[a],this.remove(c.name());this.Vjc=[]},a.prototype.findPivotTable=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.GOc[a]&&this.HOc[b]){for(c=0,d=this.Vjc;c<d.length;c++)if(e=d[c],f=e.getRange().content,g=f.row,h=f.col,i=f.rowCount,j=f.colCount,k=e._jc,l=!1,k&&(m=k.row,n=k.col,o=k.rowCount,p=k.colCount,l=a>=m&&a<o+m&&b>=n&&b<n+p),a>=g&&a<i+g&&b>=h&&b<h+j||l)return e;return r}},a.prototype.NOc=function(){var a=this;a.GOc={},a.HOc={},f.vhc(a.Vjc,function(b){b.NOc(a.GOc,a.HOc)})},a.prototype.OOc=function(a,b,c,d){return!y(a)&&(this.POc(a)&&h.IOc(a,b,c,d,!1))},a.prototype.POc=function(a){var b,c,d,e,f,g=this;if(0===g.Vjc.length)return!1;for(b=0;b<g.Vjc.length;b++){if(c=g.Vjc[b],d=c.getRange(),e=d.content,f=d.page,f&&(f.containsRange(a)||f.intersect(a.row,a.col,a.rowCount,a.colCount)&&f.union(e).containsRange(a)))return!0;if(e.containsRange(a))return!0}return!1},a.prototype.dB=function(a,b){var c=this,d=o.QOc(this.kj,a);return b&&f.vhc(d,function(a){var b,d,e=c.Vjc;for(b=0;b<e.length;b++)d=e[b],d.Cj===a.name&&(a.pt=d,c.Ola(d.Cj,!0))}),d},a.prototype.eB=function(a,b,c,d,e,g,h,i,j,k){function l(a,b){var c=a.getRange().page;return c&&(b+=c.rowCount+1),b}f.vhc(a,function(a){var c,d,f,i,j,m=b.pivotTables.get(a.name),n=g+a.startPoint[0],o=h+a.startPoint[1];if(k){if(c=a.pt,n=l(c,n),c.suspendLayout(),c.position(n,o,e.name()),e.name()===b.name()){for(d=a.pt.vic.Nhc,f=0;f<d.length;f++)if(d[f].Cj===a.pt.Cj){d.splice(f,1);break}e.pivotTables.Lla(a.pt,!0)}c.resumeLayout()}else i=m.serialize(),n=l(m,n),j=m.clone(m.name(),e,n,o),e.pivotTables.Lla(j),j.ROc(i,1023)})},a.prototype.getRangePivotAreas=function(a){var b,c,d,e,g,h=this,i=[];for(i=o.TOc(h.kj,a),b={},c=function(a){var c=h.get(a),d=i[a],e=[];f.vhc(d,function(a){e=e.concat.apply(e,p.rangeToAreas(c,a))}),b[c.Cj]=e},d=0,e=Object.keys(i);d<e.length;d++)g=e[d],c(g);return b},a.prototype.Os=function(a,b){var c=this,e=c.kj;e&&(a?(c.wWc&&e.Wq(d.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:c.wWc.type,message:c.wWc.args},!0),c.wWc=r):!b||!b.args.force&&c.wWc||(c.wWc=b))},a}(),b.PivotTableManager=A;function B(a,b){var c,d,e,f,g=b._jc,h=b.$jc;if(!y(g))for(c=0;c<g.rowCount;c++)for(d=g.row+c,y(a[d])&&(a[d]={}),e=0;e<g.colCount;e++)f=g.col+e,y(a[d][f])&&(a[d][f]={}),a[d][f].value=b.getValue(d,f);if(!y(h))for(c=0;c<h.rowCount;c++)for(d=h.row+c,y(a[d])&&(a[d]={}),e=0;e<h.colCount;e++)f=h.col+e,y(a[d][f])&&(a[d][f]={}),a[d][f].value=b.getValue(d,f)}function C(a,b,c){var e=a.row,f=void 0===e?-1:e,g=a.col,h=void 0===g?-1:g,i=a.rowCount,j=void 0===i?c.getRowCount():i,k=a.colCount,l=void 0===k?c.getColumnCount():k,m=new d.Range(f,h,j,l),n=b.getRange(),o=n.page,p=n.content,q=p;
return o&&(q=p.union(o)),m.containsRange(q)}function D(a,b,c){var d=a.row,e=void 0===d?-1:d,f=a.col,g=void 0===f?-1:f,h=a.rowCount,i=void 0===h?c.getRowCount():h,j=a.colCount,k=void 0===j?c.getColumnCount():j,l=b.getRange(),m=l.page,n=l.content;return m?m.intersect(e,g,i,k)||n.intersect(e,g,i,k):n.intersect(e,g,i,k)}function E(a,b,c,d){var e,f,g,h,i;return"deletingRows"===d||"deletingColumns"===d||"clear"===d?!D(a,b,c)||C(a,b,c):"addingRows"===d?(e=b.getRange(),f=e.page,g=e.content,h=g,f&&(h=g.union(f)),!D(a,b,c)||a.row<=h.row):"addingColumns"===d?(i=b.getRange(),f=i.page,g=i.content,h=g,f&&(h=g.union(f)),!D(a,b,c)||a.col<=h.col):void 0}w.extend(d.Worksheet.prototype,{ptWm:function(a,b,c){return c?u().wmk1:a===-1?c?u().wmk1:u().wmk2:void 0},akc:function(a,b){var c,d,e=this,f=e.pivotTables.findPivotTable(a,b);return f?(c=e.getParent(),c&&c.options.enableAccessibility&&(d=f.UOc(a,b,!0),d&&setTimeout(function(){c.dgc(d)},0)),f.getValue(a,b)):r},bkc:function(a,b){var c,e,f,g,h,i,k,l,m,n,o=b.ctx,p=b.clipRect,q=a.position(),r=q.row,s=q.col,t=18,v=3,w=0,x=0,y=0,z=0,A=this.getActiveColumnIndex(),B=this.getActiveRowIndex(),C=new d.Range(r,s,t,v),D=a.getName(),E=u().EmptyPivotTable_PromptMessage1;for(A>=s&&A<s+v&&B>=r&&B<r+t&&(E=u().EmptyPivotTable_PromptMessage2),c=0;c<t;c++)x+=this.Sl(r+c);for(e=0;e<v;e++)w+=this.Tl(s+e);for(f=0;f<=2;f++)for(g=0;g<=2;g++)h=this.getRangeRect(f,g,C),i=h.x,k=h.y,l=h.width,m=h.height,n=new d.Rect(i,k,l,m),p=this.am().Ft(f,g),p&&0!==p.width&&0!==p.height&&p.intersectRect(n)&&(y=0===g?n.x:n.x-(w-n.width),z=0===f?n.y:n.y-(x-n.height),j.Sjc(o,D,y,z,x,w,p,E))}}),d.Worksheet.$n("pivotTable",{init:function(){this.pivotTables=new A(this)},dispose:function(a){a.clearCache!==!1&&(this.pivotTables&&this.pivotTables.Hhc(),this.pivotTables=null)},beforePaintAdornment:function(a){var b,c,d;for(b=0,c=this.pivotTables.all();b<c.length;b++)d=c[b],d.iT()&&this.bkc(d,a)},onLayoutChanged:function(a){var b,c,e,f,g,h,i=this,j=a.changeType,k=a.row,l=a.col,m=a.rowCount,n=a.colCount,o=new d.Range(k,l,m,n),p=i.pivotTables.all();if("deletingRows"===j||"deletingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!E(o,c,i,j)){a.canDelete=!1,i.Os(10,u().PivotTableErrorMessage_MakeChange);break}C(o,c,i)?i.pivotTables.remove(c.name()):(e=c.position(),f=e.row,g=e.col,"deletingRows"===j?o.row<f&&c.position(f-o.rowCount,g):o.col<g&&c.position(f,g-o.colCount))}else if("addingRows"===j||"addingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!E(o,c,this,j)){i.Os(10,u().PivotTableErrorMessage_MakeChange),a.canAdd=!1;break}h=c.position(),f=h.row,g=h.col,"addingRows"===j?o.row<=f&&c.position(f+o.rowCount,g):o.col<=g&&c.position(f,g+o.colCount)}else if("clear"===j&&!a.ignorePivotTable)for(b=0;b<p.length;b++){if(c=p[b],!E(o,c,i,j)){a.canClear=!1,i.Wq(d.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:u().PivotTableErrorMessage_MakeChange},i.vxb);break}C(o,c,i)&&i.pivotTables.remove(c.name())}},fromJson:function(a){var b,c,e,f,j,k,m,n,o,p,q,r,s,t,u,v,w,z,A,B,C=this,D=C.parent;if(!y(D)&&(b=D.AO,c=a.pivotTables,b&&c&&c.length>0))for(e=0;e<c.length;e++)f=c[e],j=b.getPivotCacheByCacheId(+f.cacheId),j&&!x(j.HL)&&(k=new g.PivotFieldsModel(f.name,f.cacheId,b,this.parent.wu),D.ckc[f.name]=k,m=l.formulaToRanges(C,f.ref,0,0,!0)[0].ranges,n=f.pageFields,o=f.rowPageCount,p=f.colPageCount,n&&n.length>0&&m[0].row>1&&(q=new d.Range(m[0].row-o-1,m[0].col,o,3*p-1),C.clear(q.row,q.col,q.rowCount,q.colCount,3,d.StorageType.data|d.StorageType.style)),C.clear(m[0].row,m[0].col,m[0].rowCount,m[0].colCount,3,d.StorageType.data|d.StorageType.style),r=new h.PivotTable(f.name,C,m[0].row,m[0].col,null,null,null,k),r.suspendLayout(),s=f.outline,t=f.compact,u=f.outlineData,v=f.compactData,f.fields&&f.fields.length>0&&(w=f.fields[0],r.options.insertBlankLineAfterEachItem=w.insertBlankRow,r.options.subTotalsPosition=w.defaultSubtotal===!1?i.SubtotalsPosition.none:w.subtotalTop===!1?i.SubtotalsPosition.bottom:i.SubtotalsPosition.top,z=w.outline,A=w.compact,s===!0&&u===!0&&t===!1&&v===!1&&A===!1?r.layoutType(i.PivotTableLayoutType.outline):z===!1?r.layoutType(i.PivotTableLayoutType.tabular):s===!0&&u===!0&&r.layoutType(i.PivotTableLayoutType.compact)),k.fromJson(f,r),r.fromJson(f,a),delete f.fields,C.pivotTables.Lla(r),r.resumeLayout(),k.Thc(),B=r.$jc,y(B)||(C.getColumnCount()<B.col+B.colCount&&C.setColumnCount(B.col+B.colCount),C.getRowCount()<B.row+B.rowCount&&C.setRowCount(B.row+B.rowCount)))},toJson:function(a){var b,c,d,e,f=this,g=f.pivotTables.all();if(g&&g.length>0)for(b=void 0,y(a.data.dataTable)&&(a.data.dataTable={}),b=a.data.dataTable,c=a.pivotTables=[],d=0;d<g.length;d++)e=g[d],c.push(e.toJson(a)),B(b,e)},setName:function(a){var b,c,d=this.getParent(),e=d&&d.AO,f=e&&e.Plc;if(!y(f))for(b in f)f.hasOwnProperty(b)&&(c=f[b],!y(c.sheet)&&a&&c.sheet===a.oldName&&(c.sheet=a.newName,y(c.sourceName)&&"string"==typeof c.TDc&&(c.TDc=a.newName+"!"+c.TDc.split("!")[1])))}}),d.Workbook.$n("pivotTable",{adlc:function(a){var b,c,d=a.flg,e=a.checkRs,f=a.m,g=a.d,h=a.nl,i=a.fn,j="p",k=["able","ivotT"],l=this.ptWm||this.parent&&this.parent.ptWm;d&&d.indexOf(j.toUpperCase()+k[1]+k[0])===-1?(e.wm=e.wm||[],b=l&&l(f,g,!0),b&&e.wm.push(b),e.nwm=!0,1!==h&&A&&(c=A.prototype.Lla,A.prototype.Lla=function(){c.apply(this,arguments),this.Vjc=[]}),e.state=[j+"te",0],e.dis="7069766f745461626c6573",this.parent&&i&&i(this,e.dis,"ad")):f===-1&&(e.wm=e.wm||[],b=l&&l(f,g,!1),b&&e.wm.push(b),e.nwm=!0)},setHost:function(){},init:function(){this.AO=new f.PivotEngine,this.ckc={},this.dkc={},this.ZWc={},d.Commands.ajc(this.commandManager())},dispose:function(){if(this.AO){this.AO.dispose(),this.AO=null;for(var a in this.ckc)this.ckc.hasOwnProperty(a)&&this.ckc[a].dispose();this.ckc=null,this.dkc=null,this.ZWc=null}},preFromJson:function(a,b,c){var d,e=this.AO,f=a.pivotCaches;y(e)||(e.dispose(),e.fromJson(f));for(d in this.ckc)this.ckc.hasOwnProperty(d)&&this.ckc[d]&&this.ckc[d].dispose();this.ckc={}},initCustomName:function(){var a,b,c,d,e,g=this;if(g.AO&&(a=g.AO.Plc))for(b in a)a.hasOwnProperty(b)&&(c=a[b],f.Fa(c)||(d="pivot"+c.Cj,f.Fa(g.$Wc(d))||g._Wc(d),e=c.TDc,f.Fa(e)||""===e||g.Yu(g.ZWc,d,c.TDc,null,null,!0,null)))},toJson:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.AO,q=o.sheets,r={};for(b=0;b<q.length;b++)for(c=q[b],d=c.pivotTables.all(),e=0;e<d.length;e++)if(f=d[e],f&&(g=f.vic.Ihc,y(r[g])&&(r[g]={}),h=f.vic.Ohc))for(i in h)h.hasOwnProperty(i)&&3!==h[i]&&(r[g][i]=!0);for(j={},k=0,l=q;k<l.length;k++)if(c=l[k],c.pivotTables&&c.pivotTables.Vjc)for(m=0,n=c.pivotTables.Vjc;m<n.length;m++)f=n[m],j[f.vic.Ihc]=1;a.pivotCaches=p&&p.toJson(r,Object.keys(j)),F(a.pivotCaches,o)}});function F(a,b){var c,d,e,f,g,h,i,j;for(c in a)if(a.hasOwnProperty(c)&&(d=a[c],e=d.TDc,!y(e)&&"string"==typeof e)){f=void 0;try{if(f=l.formulaToExpression(b.getActiveSheet(),e,0,0,!0),f.lj){g=f.lj,d.sourceType="worksheet",d.sourceName=g.name();continue}}catch(a){}try{if(h=void 0,i=void 0,f=l.formulaToRanges(b.getActiveSheet(),e,0,0),f[0]&&f[0].ranges){h=f[0].sheetName,i=f[0].ranges[0],d.sourceType="worksheet",d.sheet=h,d.ref=l.rangeToFormula(i,0,0,15);continue}}catch(a){}e.indexOf("!")>0?(j=e.split("!"),d.sourceType="worksheet",d.sheet=j[0],d.ref=j[1]):(d.sourceType="worksheet",d.sourceName=e)}}w.extend(d.Workbook.prototype,{Yjc:function(a,b){var c,d=this.AO;return this.ekc(b)&&g.throwError(u().RepeatName),d.hasPivotCache(a)||g.throwError("pivot cache not exist"),c=new g.PivotFieldsModel(b,a,d,this.wu),this.ckc[b]=c,c},ptWm:function(a,b,c){return c?u().wmk1:a===-1?c?u().wmk1:u().wmk2:void 0},addPivotLayoutModelWithExistCache:function(a,b){var c=this.AO;c.hasPivotCache(b)||g.throwError(u().NotExist),this.ckc[a]=new g.PivotFieldsModel(a,b,c)},ekc:function(a){return!!this.dkc[a]},Zjc:function(a,b,c){b?this.dkc[a]=1:delete this.dkc[a],delete this.dkc[c]},iua:function(a){var b=this.AO;return b.hasPivotCache(a)?(a+="1",this.iua(a)):a},Xjc:function(a,b){var c,d,e,h,i,j,k,m,n,o,p,q,r,t,w,x,A,B;if(a=this.iua(a),c=null,d="",e=v+a,"string"==typeof b)try{h=l.formulaToExpression(this.getActiveSheet(),b,0,0,!0),h.lj?(m=h.lj,i=m.range(),j=m.kj.name(),d=m.name(),k=d,y(this.$Wc(e))||this._Wc(e),this.Yu(this.ZWc,e,"="+b,null,null,!0,null)):(h=l.formulaToRanges(this.getActiveSheet(),b,0,0,!1),h[0]&&h[0].ranges&&(j=h[0].sheetName,i=h[0].ranges[0],d=b.indexOf("!")!==-1?b:j+"!"+b,y(this.$Wc(e))||this._Wc(e),this.Yu(this.ZWc,e,b,null,null,!0,null))),n=this.getSheetFromName(j),c=n.getArray(i.row===-1?0:i.row,i.col===-1?0:i.col,i.rowCount===-1?n.getRowCount():i.rowCount,i.colCount===-1?n.getColumnCount():i.colCount),c||g.throwError(u().SourceError)}catch(a){g.throwError(u().SourceNotIsTableNameOrFormula)}else s(b)&&s(b[0])?c=b:g.throwError(u().SourceNotIsTableNameOrFormula);for(c.length<2&&g.throwError(u().SourceDataOnlyOne),o=[],p=c[0],q=c.slice(1),r=q[0],t=0,w=p.length;t<w;t++)x=void 0,A=typeof r[t],x="number"===A?0:"object"===A&&r[t]instanceof Date?2:1,o.push({name:z(p[t]),dataType:x,index:t});return B=new f.PivotCache(a,o,q,b),B.TDc=d,y(j)||(B.sheet=j),y(k)||(B.sourceName=k),this.AO.addPivotCache(B),B},DNc:function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q=null,r=this,s=v+a;if("string"==typeof a){d=void 0;try{if(!r.VOc(a,c))return;d=r.$Wc(s),d=d?d.getExpression():null,e={},f=void 0,d&&d.lj?(h=d.lj,e=h.range()):(e.row=d.row,e.col=d.column,e.rowCount=d.endRow-d.row+1,e.colCount=d.endColumn-d.column+1),f=d.source.kj.name(),q=r.getSheetFromName(f).getArray(e.row,e.col,e.rowCount,e.colCount),(!q||q.length<2)&&g.throwError(u().SourceDataOnlyOne)}catch(a){g.throwError(u().SourceNotIsTableNameOrFormula)}}else g.throwError(u().SourceNotIsTableNameOrFormula);for(i=[],j=q[0],k=q.slice(1),l=k[0],m=0,n=j.length;m<n;m++)o=void 0,p=typeof l[m],o="number"===p?0:"object"===p&&l[m]instanceof Date?2:1,i.push({name:z(j[m]),dataType:o,index:m});b.oNc(i,k),r.WOc(b.Cj)},WOc:function(a){var b,c=this,d=c.ckc;for(b in d)q(d,b)&&d[b].Ihc===a&&d[b].ENc()},Wjc:function(a){return this.AO.fkc(a)},VOc:function(a,b){var c=this,d=this.ckc,e=Object.keys(d).map(function(a){return d[a]}),g=!0;return f.vhc(e,function(d){g&&d.Cj!==b&&d.Ihc===a&&f.vhc(c.sheets,function(a){g&&a.options.isProtected&&a.pivotTables.get(d.Cj)&&(a.Os(10,u().PivotTableErrorMessage_Protect),g=!1)})}),g},$Wc:function(a){return a?this.ZWc[e.Common.u.Nb(a)]:void 0},aXc:function(){var a=[];return w.each(this.QHb,function(b,c){a.push(c)}),a},_Wc:function(a){if(a){delete this.ZWc[e.Common.u.Nb(a)];var b={};b[a]=a,this.Zu(b,!1)}},FNc:function(){var a,b,c=this,d=c.ckc;for(b in d)q(d,b)&&(a=d[b],a&&a.YWc())}}),w.extend(d.lUa.prototype,{XOc:function(a){var b=this.YOc;return!b||!b[a]},JOc:function(a,b){var c,d=this,e=d.zTa;e&&d.XOc(a.Cj)&&(c=e.eOc,c||(c=e.eOc=[]),c.push({pivotObj:a,value:b}))},QNc:function(a,b){var c,d=this,e=d.zTa;e&&(c=e.eOc,c||(c=e.eOc=[]),c.push({pivotObj:a,value:b}))},AWc:function(a){var b,c,d,e,f={};for(b=a.length-1;b>=0;b--)c=a[b],c.pivotObj instanceof h.PivotTable&&!f[c.pivotObj.name()]&&(f[c.pivotObj.name()]=c.pivotObj);for(d in f)f.hasOwnProperty(d)&&(e=f[d],e.suspendLayout());return f},BWc:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.resumeLayout())},ZOc:function(a){var b,c,d=this.kj.pivotTables;for(b=a.length-1;b>=0;b--)c=a[b],d.RUa(c)},$Oc:function(a,b){var c=a,d=c.value.type,e=this.kj.pivotTables;return"add"!==d&&"remove"!==d||(e.RUa(c),c.value.isMove)?void c.pivotObj.RUa(c.value):void("add"===d&&b[c.pivotObj.name()]&&delete b[c.pivotObj.name()])},_Oc:function(a){a.pivotObj.RUa(a.value),y(a.pivotObj.copyFieldsModel)&&(a.pivotObj.copyFieldsModel=a.pivotObj.clone())}}),d.lUa.$n("PivotTable",{priority:8e3,getValue:function(a){var b,c,d,e,f,g,h=a.row,i=a.col,j=a.sheetArea,k=this.kj,l=k.pivotTables.Vjc;if(3===j&&l&&l.length>0)for(b=k.akc(h,i),c=0;c<l.length;c++)d=l[c],e=d.getRange(),f=e.page,g=e.content,(f&&f.contains(h,i)||g&&g.contains(h,i))&&(a.isValueGet=!0,a.value=b)},setValue:function(a){var b,c,d,e,f,g,h=a.row,i=a.col,j=a.sheetArea,k=this.kj,l=k.parent&&k.parent.GBb;if(3===j)for(b=k.pivotTables.all(),c=0;c<b.length;c++)if(d=b[c],e=d.getRange(),f=e.page,g=e.content,f&&f.contains(h,i)||g&&g.contains(h,i))return l&&d.yq(h,i,a.value),void(a.isValueSet=!0)},undo:function(a){var b,c,d,e,f,g,h,i,j=this;if(j.YOc={},b=a.eOc,j.kj.pivotTables.vWc=!0,c={},b){for(d=j.AWc(b),e=b.length-1;e>=0;e--)0===b[e].value.pivotType?j.$Oc(b[e],d):(j._Oc(b[e]),c[b[e].pivotObj.Cj]=1);for(j.BWc(d),f=Object.keys(c),g=0,h=f;g<h.length;g++)i=h[g],j.kj.parent.ckc[i].Thc()}j.kj.pivotTables.vWc=!1,delete j.YOc}}),n.ConditionalFormats&&n.ConditionalFormats.$n("pivotTable",{onRuleRemoved:function(a){var b,c,d=this,e=d.pivotTables.all(),f=a.priority;if(f)for(b=0;b<e.length;b++)c=e[b],c.aPc(f)}})},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Core"),g=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),h=e.GC$.each,i=e.GC$.isEmptyObject,j=e.Ul.Ol,k=JSON.stringify,l=JSON.parse,m=e.Ul.Pl,n=d.Common.j.Fa,o=Math.floor,p=void 0,q=null,r="wholeTableStyle",s="reportFilterLabelsStyle",t="reportFilterValuesStyle",u="firstColumnStripeStyle",v="secondColumnStripeStyle",w="firstRowStripeStyle",x="secondRowStripeStyle",y="firstColumnStyle",z="headerRowStyle",A="firstHeaderCellStyle",B="subtotalColumn1Style",C="subtotalColumn2Style",D="subtotalColumn3Style",E="blankRowStyle",F="subtotalRow1Style",G="subtotalRow2Style",H="subtotalRow3Style",I="columnSubheading1Style",J="columnSubheading2Style",K="columnSubheading3Style",L="rowSubheading1Style",M="rowSubheading2Style",N="rowSubheading3Style",O="grandTotalColumnStyle",P="grandTotalRowStyle",Q=[r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P],R=!0,S=!1,T="firstRowStripSize",U="secondRowStripSize",V="firstColumnStripSize",W="secondColumnStripSize",X=[T,U,V,W],Y="name",Z="bold 11pt calibri",$="borderLeft",_="borderTop",aa="borderRight",ba="borderBottom",ca="borderHorizontal",da="borderVertical",ea=["backColor","foreColor","font",$,_,aa,ba,ca,da,"textDecoration"],fa="Text 1",ga="rgb(0,0,0)",ha="rgb(140,140,140)",ia="rgb(255,255,255)",ja="Background 1 -15",ka=e.LineStyle.thin,la=e.LineStyle.medium,ma=e.LineStyle.empty,na=e.LineStyle.double,oa=function(){function a(a,b,c,d,e,f,g,i,j,k){var l=this,m=arguments;h(ea,function(a,b){l[b]=m[a]})}return a.prototype.Yo=function(a,b,c,d,e){var f=this;h(ea,function(g,h){h.indexOf("border")>=0?(c&&j(f[$])&&(a[$]=f[$]),b&&j(f[_])&&(a[_]=f[_]),!d&&j(f[ca])&&(a[ba]=f[ca]),!e&&j(f[da])&&(a[aa]=f[da]),e&&j(f[aa])&&(a[aa]=f[aa]),d&&j(f[ba])&&(a[ba]=f[ba])):j(f[h])&&(a[h]=f[h])})},a.prototype.Uo=function(){var b=new a,c=k(this.toJSON());return b.fromJSON(l(c)),b},a.prototype.toJSON=function(){var a=this,b={};return h(ea,function(c,d){var e=a[d],f=e&&e.toJSON?e.toJSON():e;b[d]=i(f)?p:f}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;h(ea,function(d,f){var g,h=a[f];j(h)&&(f.indexOf("border")>=0?(g=new e.LineBorder,g.fromJSON(h,b),c[f]=g):c[f]=h)})}},a}(),b.PivotTableStyle=oa,pa=function(){function a(){}return a.prototype.Yo=function(a,b,c,d){var h,i,j,k,l,m,n,q,Q,S,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb=this;if(!d.iT||!d.iT()){if(h=d.qo,i=Hb[r](),j=Hb[s](),k=Hb[t](),l=Hb[u](),m=Hb[v](),n=Hb[w](),q=Hb[x](),Q=Hb[y](),S=Hb[z](),X=Hb[A](),Y=Hb[B](),Z=Hb[C](),$=Hb[D](),_=Hb[E](),aa=Hb[F](),ba=Hb[G](),ca=Hb[H](),da=Hb[I](),ea=Hb[J](),fa=Hb[K](),ga=Hb[L](),ha=Hb[M](),ia=Hb[N](),ja=Hb[O](),ka=Hb[P](),la=Hb[V](),ma=Hb[W](),na=Hb[T](),oa=Hb[U](),pa=d.options.showRowHeader,qa=d.options.showColumnHeader,ra=d.options.insertBlankLineAfterEachItem,sa=d.getRange().content,ta=d.layoutType(),ua=a-sa.row,va=b-sa.col,wa=a-d._jc.row,xa=b-d._jc.col,ya=d.ys.Uic,za=ya[0],Aa=ya[1],Ba=ya[2],Ca=ya[3],Da=ya[4],Ea=ua===Da.nU+Da.Xj-1,Fa=va===sa.colCount-1,Ga=ua===Ba.nU,Ha=ua===Ba.nU+Ba.Xj-1,Ia=ua===Da.nU,Ja=0===va,Ka=va===Ca.hF,La=va===Ca.hF+Ca.OZ-1,Ma=Ca.Nic,Na=Ca.nU,Oa=Ba.Oic,Pa=Ba.nU,Qa=Ba.hF,Ra=ua-Na,Sa=va-Qa,Ta=new e.Style,Va=new f.Range(d._jc.row,d._jc.col,d._jc.rowCount,d._jc.colCount),Wa=Va.contains(a,b),Xa=sa.contains(a,b),i&&(Ya=a===sa.row&&Xa||a===Va.row&&Wa,Za=a===sa.row+sa.rowCount-1&&Xa||a===Va.row+Va.rowCount-1&&Wa,$a=b===sa.col&&Xa||b===Va.col&&Wa,_a=b===Va.col+sa.colCount-1&&Xa||b===Va.col+Va.colCount-1&&Wa,Wa&&(xa-za.hF)%3!==2&&(ab=za.dataTable,Za||$a||void 0===ab[wa+1][xa]&&(Za=!0),_a||Ya||void 0===ab[wa][xa+1]&&(_a=!0)),i.Yo(Ta,Ya,$a,Za,_a)),za.getRange().contains(wa,xa)&&(Ya=0===wa,$a=0===xa,Za=wa===za.Xj-1,bb=d.vic.Shc(0).length,cb=d.options.reportFilterFieldsPerColumn,db=d.options.displayFieldsInPageFilterArea,eb=void 0,fb=void 0,0===cb?0===db?(eb=bb,fb=0):(eb=0,fb=3*bb):(eb=o(bb/cb),fb=3*(bb%d.options.reportFilterFieldsPerColumn-1)),gb=d.getRange().page,hb=a-gb.row,ib=b-gb.col,Wa&&(xa-za.hF)%3!==2&&(ab=za.dataTable,Za||$a||void 0===ab[wa+1][xa]&&(Za=!0)),(xa-za.hF)%3===0?j&&(eb===hb&&ib>fb?Ta=new e.Style:j.Yo(Ta,Ya,R,Za,R)):(xa-za.hF)%3===1?k&&(eb===hb&&ib-1>fb?Ta=new e.Style:k.Yo(Ta,Ya,R,Za,R)):Ta=new e.Style,Ua=za.Gq(wa,xa)),jb=new f.Range(Da.nU,Da.hF,Ca.Xj,Ba.OZ),Ba.getRange().contains(ua,va)||jb.contains(ua,va)){if(Ba.getRange().contains(ua,va))qa&&(S&&S.Yo(Ta,Ga,Ka,Ha,Fa),Oa[Sa]&&0!==Oa[Sa].grandTotalLevel&&da&&(kb=Pa+1,lb=kb<ua,ua===kb&&da.Yo(Ta,R,Ja,R,Fa),lb&&2===Oa[Sa].grandTotalLevel&&da.Yo(Ta,R,R,R,R)),Oa[Sa]&&0!==Oa[Sa].grandTotalLevel&&ea&&(mb=Pa+2,lb=mb<ua,ua===mb&&ea.Yo(Ta,R,Ja,R,Fa),lb&&3===Oa[Sa].grandTotalLevel&&ea.Yo(Ta,R,R,R,R)),Oa[Sa]&&0!==Oa[Sa].grandTotalLevel&&fa&&(nb=Pa+3,lb=nb<ua,ua===nb&&fa.Yo(Ta,R,Ja,R,Fa),lb&&4===Oa[Sa].grandTotalLevel&&fa.Yo(Ta,R,R,R,R))),Ua=Ba.Gq(ua-Ba.nU,va-Ba.hF);else if(ob=ua-Da.nU,pb=void 0,qb=void 0,rb=void 0,sb=void 0,d.options.bandColumns&&Ma[ob]&&0!==Ma[ob].grandTotalLevel&&(pb=la+ma,pb>0)){if(qb=d.pNb[b],qb===p){if(tb=0,h)for(ub=Da.hF;ub<va;ub++)h.getColumnWidth(ub)>0&&tb++;qb=d.pNb[b]=tb%pb}qb<la&&l?(rb=0===qb,sb=Fa||qb===la-1,l.Yo(Ta,Ia,rb,Ea,sb)):qb>=la&&m&&(rb=qb===la,sb=Fa||qb===pb-1,m.Yo(Ta,Ia,rb,Ea,sb))}vb=Oa[Sa],wb=vb&&vb.grandTotalLevel%3,xb=d.mOc%3,Y&&(kb=Pa+1,vb&&vb.isSubtotal&&void 0===vb.collapseIndex&&1===wb&&ua>=kb&&xb>1&&(yb=ua===kb,Y.Yo(Ta,yb,R,Ea,R))),Z&&(mb=Pa+2,vb&&vb.isSubtotal&&void 0===vb.collapseIndex&&2===wb&&ua>=mb&&xb>2&&(yb=ua===mb,Z.Yo(Ta,yb,R,Ea,R))),$&&(nb=Pa+3,vb&&vb.isSubtotal&&void 0===vb.collapseIndex&&3===wb&&ua>=nb&&xb>3&&(yb=ua===nb,$.Yo(Ta,yb,R,Ea,R)))}if(zb=Ca.getRange().contains(ua,va),zb||jb.contains(ua,va)){if(zb&&(Q&&pa&&(yb=ua===Aa.nU,Ab=va===Ca.hF,Bb=ua===Aa.Xj+Ca.Xj-1,Cb=va===Ca.OZ-1,Q.Yo(Ta,yb,Ab,Bb,Cb)),Ua=Ca.Gq(ua-Ca.nU,va-Ca.hF)),pb=void 0,qb=void 0,rb=void 0,sb=void 0,Db=Ma[Ra],vb=Oa[Sa],wb=Db&&Db.grandTotalLevel%3,Eb=Db&&Db.rowHeaderLevel%3,d.options&&d.options.bandRows&&Db&&0!==wb&&(!vb||!vb.isSubtotal&&!vb.isGrandTotal)&&(pb=na+oa,pb>0)){if(qb=d.oNb[a],qb===p){if(Fb=0,h)for(Gb=Da.nU;Gb<ua;Gb++)h.getRowHeight(Gb)>0&&Fb++;qb=d.oNb[a]=Fb%pb}qb<na&&n?(rb=0===qb,sb=Ea||qb===na-1,n.Yo(Ta,rb,Ka,sb,Fa)):qb>=na&&q&&(rb=qb===na,sb=Ea||qb===pb-1,q.Yo(Ta,rb,Ka,sb,Fa))}aa&&Db&&1===wb&&Db.isSubtotal&&void 0===Db.collapseIndex&&(va>-1||ta===g.PivotTableLayoutType.compact)&&d.lOc>1&&aa.Yo(Ta,R,Ka,R,Fa),ba&&Db&&2===wb&&Db.isSubtotal&&void 0===Db.collapseIndex&&(va>0||ta===g.PivotTableLayoutType.compact)&&d.lOc>2&&ba.Yo(Ta,R,Ka,R,Fa),ca&&Db&&3===wb&&Db.isSubtotal&&void 0===Db.collapseIndex&&(va>1||ta===g.PivotTableLayoutType.compact)&&d.lOc>3&&ca.Yo(Ta,R,Ka,R,Fa),Db&&ga&&pa&&d.lOc>1&&!(Db.isSubtotal&&(wb<2||Eb<2)&&void 0===Db.collapseIndex||Db.isGrandTotal||Db.isBlankRow)&&(ta!==g.PivotTableLayoutType.tabular&&Db&&1===Db.rowHeaderLevel&&!Db.isValueFieldDim||ta===g.PivotTableLayoutType.tabular&&0===va)&&(ta===g.PivotTableLayoutType.outline&&va<0||ga.Yo(Ta,Ia,Ka,Ea,La)),Db&&ha&&pa&&d.lOc>2&&!(Db.isSubtotal&&(wb<3||Eb<3)&&void 0===Db.collapseIndex||Db.isGrandTotal||Db.isBlankRow)&&(ta!==g.PivotTableLayoutType.tabular&&Db&&2===Db.rowHeaderLevel&&!Db.isValueFieldDim||ta===g.PivotTableLayoutType.tabular&&1===va)&&(ta===g.PivotTableLayoutType.outline&&va<1||ha.Yo(Ta,Ia,Ka,Ea,La)),Db&&ia&&pa&&d.lOc>3&&!(Db.isSubtotal&&(wb<4||Eb<4)&&void 0===Db.collapseIndex||Db.isGrandTotal||Db.isBlankRow)&&(ta!==g.PivotTableLayoutType.tabular&&Db&&3===Db.rowHeaderLevel&&!Db.isValueFieldDim||ta===g.PivotTableLayoutType.tabular&&2===va)&&(ta===g.PivotTableLayoutType.outline&&va<2||ia.Yo(Ta,Ia,Ka,Ea,La)),ra&&_&&Db&&Db.isBlankRow&&_.Yo(Ta,R,Ka,R,Fa)}ja&&(kb=Pa+1,Oa[Sa]&&0===Oa[Sa].grandTotalLevel&&ja.Yo(Ta,ua===kb,R,Ea,R)),ka&&Ma[Ra]&&0===Ma[Ra].grandTotalLevel&&ka.Yo(Ta,R,Ka,R,Fa),Aa.getRange().contains(ua,va)&&(Q&&pa&&Q.Yo(Ta,Ga,Ka,Ea,La),S&&qa&&S.Yo(Ta,Ga,Ka,Ha,Fa),X&&qa&&pa&&(Bb=ua===Aa.getRange().rowCount-1,X.Yo(Ta,Ga,Ka,Bb,La)),Ua=Aa.Gq(ua,va)),Hb.Oka(c,Ta,Ua)}},a.prototype.Oka=function(a,b,c){n(a)&&(a={});var d=a,e=20,f,g,h,i;n(d.backColor)&&(d.backColor=b.backColor),d.foreColor===p&&(d.foreColor=b.foreColor),n(d.themeFont)&&n(d.font)?(d.themeFont=b.themeFont,d.font=b.font):n(d.themeFont)||n(b.font)||(d.font=b.font),n(d.borderLeft)&&(f=b.borderLeft,d.borderLeft=f&&f.Uo()||f,d.borderLeft&&(d.borderLeft.level=e)),n(d.borderTop)&&(g=b.borderTop,d.borderTop=g&&g.Uo()||g,d.borderTop&&(d.borderTop.level=e)),n(d.borderRight)&&(h=b.borderRight,d.borderRight=h&&h.Uo()||h,d.borderRight&&(d.borderRight.level=e)),n(d.borderBottom)&&(i=b.borderBottom,d.borderBottom=i&&i.Uo()||i,d.borderBottom&&(d.borderBottom.level=e)),n(d.textDecoration)&&(d.textDecoration=b.textDecoration),n(d.cellType)&&(d.cellType=b.cellType),n(d.formatter)&&(d.formatter=b.formatter),n(c)||(n(d.cellButtons)&&!n(c.cellButtons)&&(d.cellButtons=c.cellButtons),n(d.textIndent)&&!n(c.textIndent)&&(d.textIndent=c.textIndent),n(d.cellPadding)&&!n(c.cellPadding)&&(d.cellPadding=c.cellPadding))},a.prototype.toJSON=function(){var a,b,c=this,d=c.builtInName();return d?{buildInName:d}:(a={name:c.name()},h(Q,function(d,e){b=c[e](),b&&(a[e]=b.toJSON())}),h(X,function(d,e){b=c[e](),1!==b&&(a[e]=b)}),i(a)?p:a)},a.prototype.fromJSON=function(a,b){var c,d,e;function f(a,b){a.name(b.name()),h(X,function(c,d){a[d](b[d]())}),h(Q,function(c,d){var e=b[d]();a[d](e?e.Uo():q)}),a.builtInName(b.builtInName(),!1)}if(a){if(c=this,d=a.buildInName)return void f(c,sa[d.toLowerCase()]);e=a.name,j(e)&&c.name(e,!1),h(X,function(b,d){var e=a[d]!==p?a[d]:a["_"+d];e&&c[d](e,!1)}),h(Q,function(d,e){var f,g=a[e]!==p?a[e]:a["_"+e];g&&(f=new oa,f.fromJSON(g,b),c[e](f,!1))})}},a}(),b.PivotTableTheme=pa,h(Q,function(a,b){pa.prototype[b]=m(b)}),h(X,function(a,b){pa.prototype[b]=m(b,1)}),pa.prototype.name=m(Y),pa.prototype.builtInName=m("builtInName"),qa="white",ra="black";function ua(a,b){return isNaN(b)?b:new e.LineBorder(a,b)}function va(a,b,c,d,e,f,g,h,i,j){var k=new oa;return b&&(k.backColor=b),c&&(k.foreColor=c),d&&(k.font=Z),e&&(k.borderLeft=ua(a,e)),f&&(k.borderTop=ua(a,f)),g&&(k.borderRight=ua(a,g)),h&&(k.borderBottom=ua(a,h)),i&&(k.borderHorizontal=ua(a,i)),j&&(k.borderVertical=ua(a,j)),k}function wa(a){var b;return b=0===a?"Background 1":"Accent "+a}function xa(a){var b,c,d,e=a-1,f=o(e/7);return f>=0&&f<=3?(b=[za,Aa,Ba,Ca][f](e%7),b[T](1),b[V](1),b[W](1),b[U](1),c="Light"+a,b.name(c),b.builtInName(c)):(b=ya(),d="Light0",b.name(d),b.builtInName(d)),b}function ya(){return new pa}function za(a){var b,c,d,e,f=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50"):(b=" 80",c=" 60",d=f),b=f+b,c=f+c,e=new pa,e[r](va(b,0,0,0,ma,ma,ma,ma,ka)),e[s](va(d,0,0,0,ma,ka,ma,ka)),e[t](va(d,0,0,0,ma,ka,ma,ka)),e[u](va(c,b,0,0,ka,ka,ka,ka,ka,ka)),e[w](va(c,b,0,0,ma,ka,ma,ka)),e[z](va(d,0,0,1,ma,ka,ma,ka)),e[F](va(b,0,0,1)),e[G](va(ga,0,0,1)),e[L](va(ga,0,0,1)),e[M](va(ga,0,0,1)),e[P](va(d,0,0,1,ma,ka,ma,ka)),e}function Aa(a){var b,c,d,e,f,g,h=wa(a);return 0===a?(b=" -15",c=" -35",e=fa,d=fa+" 50",f=ha):(b=" 80",c=" 60",e=h+" -25",f=h,d=h),b=h+b,c=h+c,g=new pa,g[r](va(b,0,e,0,ma,ma,ma,ma,ka)),g[u](va(f,0,0,0,ka,ka,ka,ka)),g[w](va(c,0,0,0,ka,ka,ka,ka)),g[y](va(d,0,fa,1,ma,ma,ka)),g[z](va(d,0,fa,1,la,la,la,la)),g[F](va(c,b,fa,1,ma,ma,ma,ka)),g[G](va(ga,0,fa,1)),g[J](va(c,0,0,0,ma,ka)),g[L](va(h,b,0,1,ma,ma,ma,ka)),g[M](va(ga,0,0,1)),g[P](va(d,0,fa,1,la,la,la,la)),g}function Ba(a){var b,c,d,e,f=wa(a),g="Background 1 -25";return 0===a?(b=" -15",c=" -35",d=fa+" 50"):(b=" 80",c=" 40",d=f),b=f+b,c=f+c,e=new pa,e[s](va(c,b,0,0,ma,ma,ma,ka)),e[t](va(c,b,0,0,ma,ma,ma,ka)),e[u](va(g,ja,0,0,ka,ma,ka,ma)),e[w](va(ga,ja)),e[z](va(c,b,fa,1,ma,ma,ma,ka)),e[B](va(ga,g,fa)),e[F](va(d,0,0,1,ma,ka,ma,ka)),e[G](va(ga,0,0,1)),e[L](va(c,0,fa,1,ma,ma,ma,ka)),e[M](va(ga,0,fa,1)),e[P](va(c,b,fa,1,ma,ka)),e}function Ca(a){var b,c,d,e,f,g=wa(a);return 0===a?(b=" -15",c=" -35",e=fa,d=fa+" 50"):(b=" 80",c=" 60",e=g,d=g+" -25"),b=g+b,c=g+c,f=new pa,f[r](va(d,0,e,0,ka,ka,ka,ka,0,ka)),f[s](va(ga,0,e,1)),f[u](va(ga,b)),f[w](va(d,b,0,0,ma,ka,ma,ka)),f[y](va(ga,0,e,1)),f[z](va(d,0,e,1,ma,ma,ma,ka)),f[B](va(c,0,e,1,ka,ma,ka)),f[F](va(ga,0,e,1)),f[G](va(ga,0,e,1)),f[P](va(d,0,e,1,ma,ka)),f}function Da(a){var b,c=a-1,d=q,e=o(c/7);return e>=0&&e<4&&(d=[Ea,Fa,Ga,Ha][e](c%7),d[T](1),d[V](1),d[W](1),d[U](1),b="Medium"+a,d.name(b),d.builtInName(b)),d}function Ea(a){var b,c,d,e,f=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50"):(b=" 80",c=" 60",d=f+" -25"),b=f+b,c=f+c,e=new pa,e[r](va(b,0,fa,0,ma,ma,ma,ma,ka)),e[s](va(b,0,0,0,ma,ka,ma,ka)),e[t](va(b,0,0,0,ma,ka,ma,ka)),e[u](va(d,0,0,0,ka,ma,ka)),e[w](va(d,0,0,0,ma,ka,ma,ka,ka)),e[z](va(d,d,ia,0,ma,ma,ma,ma,ka)),e[A](va(ga,0,ia,1)),e[F](va(ga,c,ia,1)),e[G](va(ga,ja,fa,1)),e[I](va(b,0,0,0,ma,ma,ma,ka)),e[L](va(b,c,ia,0,ma,ma,ma,ka,ka)),e[M](va(b,b,0,0,ma,ma,ma,ka)),e[P](va(d,0,fa,1,ma,na)),e}function Fa(a){var b,c,d,e,f,g,h,i=wa(a);return 0===a?(b=" -15",c=fa+" 50",d=i+" -25",e=la,f=fa,g=fa+" 50"):(b=" 80",c=i+" -25",d=i+" 60",e=ka,f=c,g=i),b=i+b,h=new pa,h[r](va(ga,0,fa)),h[s](va(ga,b)),h[t](va(ga,b)),h[u](va(b,0,0,0,e,ma,e)),h[w](va(d,0,0,0,ma,ka,ma,ka,ka)),h[z](va(c,g,ia,1,ma,e)),h[B](va(d,0,fa,1,e,e,e,e)),h[F](va(ga,d,fa,1)),h[G](va(ga,0,fa,1)),h[L](va(ga,b,fa,1)),h[M](va(ga,0,fa,1)),h[P](va(f,0,fa,1,ma,ka,ma,la)),h}function Ga(a){var b,c,d,e,f,g,h=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50",e=h+" -5",f=h+" -25"):(b=" 80",c=" 60",e=h+b,f=h+c),b=h+b,c=h+c,g=new pa,g[r](va(b,e,fa,0,ka,ma,ka,ma,ma,ka)),g[s](va(fa,0,0,0,ma,ka,ma,ka)),g[t](va(fa,0,ga,0,ma,ka,ma,ka)),g[u](va(f,b,0,0,ka,ma,ka)),g[w](va(f,b,0,0,ma,ka,ma,ka)),g[z](va(ga,fa,ia)),g[B](va(c,f,fa,0,ka,ka,ka)),g[F](va(f,0,fa,1,ma,ma,ma,ka)),g[G](va(ga,0,d,1)),g[L](va(ga,0,fa,1)),g[M](va(ga,0,d,1)),g[N](va(ga,0,fa,1)),g[P](va(ga,fa,ia)),g}function Ha(a){var b,c,d,e,f=wa(a);return 0===a?(b=" -15",c=fa+" 50",d=f+" -25"):(b=" 80",c=f+" -25",d=f+" 60"),b=f+b,e=new pa,e[r](va(ia,b,c,0,ma,ma,ma,ma,ka)),e[s](va(ga,d,c,1)),e[t](va(ga,b,c,1)),e[v](va(ga,d,0)),e[x](va(ga,d)),e[y](va(ga,d,c,1)),e[z](va(ia,0,c,1,ma,ma,ma,ka)),e[F](va(ga,0,fa,1)),e[G](va(ga,0,fa,1)),e[L](va(ga,0,fa,1)),e[P](va(ga,0,c,1)),e}function Ia(a){var b,c=a-1,d=q,e=o(c/7);return e>=0&&e<4&&(d=[Ja,Ka,La,Ma][e](c%7),d[T](1),d[V](1),d[W](1),d[U](1),b="Dark"+a,d.name(b),d.builtInName(b)),d}function Ja(a){var b,c,d,e,f,g=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50",e=g+" -25"):(b=" 80",c=" 40",d=g+" -50",e=g+" 60"),b=g+b,c=g+c,f=new pa,f[r](va(b,e,fa,0,ma,ma,ma,ma,ka)),f[s](va(d,d,ia,1,ma,ma,ma,ma,ka)),f[t](va(d,d,ia,0,ma,ma,ma,ma,ka)),f[v](va(b,0,0,0,ka,ma,ka)),f[x](va(ga,c)),f[z](va(ia,d,ia,1,ma,ma,ma,ka,ka)),f[F](va(c,0,fa,1,ma,ma,ma,ka)),f[L](va(c,b,fa,1,ma,ka,ma,ka)),f[M](va(ga,0,fa,1)),f[P](va(ga,d,ia,1)),f}function Ka(a){var b,c,d,e,f=wa(a),g=fa+" -25";return 0===a?(b=" -15",c=fa+" 50",d=f+" -25"):(b=" 80",d=f+" 60"),b=f+b,e=new pa,e[r](va(c,b,fa,0,la,la,la,la)),e[s](va(c,0,0,0,ka,ka,ma,ka)),e[t](va(c,0,0,0,ma,ka,ka,ka)),e[u](va(ha,0,0,0,ka,ma,ka)),e[v](va(ha,0,0,0,ka,ma,ka)),e[x](va(d,0,0,0,ma,ka,ma,ka)),e[z](va(ga,g,ia,1)),e[F](va(ga,d,fa,1)),e[J](va(d,0,0,0,ma,ka)),e[K](va(d,0,0,0,ma,ka)),e[L](va(b,d,fa,1,ma,ma,ma,ka)),e[M](va(ga,0,fa,1)),e[P](va(ga,g,ia,1)),e}function La(a){var b,c,d,e,f,g=wa(a),h=g+" -25";return 0===a?(b=" -15",c=" -35",d=fa+" 50",e=ha):(b=" 80",c=" 60",d=g+" -25",e=g),b=g+b,c=g+c,f=new pa,f[r](va(ga,e,b)),f[s](va(ga,0,ia,1)),f[u](va(h,0,0,ka,ma,ka)),f[w](va(c,0,0,0,ma,ka,ma,ka)),f[z](va(ga,fa,ia,1)),f[B](va(c,d,0,0,ka,ka,ka,ka)),f[F](va(ga,0,ia,1)),f[I](va(c,0,0,0,ma,ma,ma,ka)),f[L](va(d,d,ia,1,ma,ma,ma,ka)),f[M](va(ga,0,ia,1)),f[P](va(ga,fa,ia,1)),f}function Ma(a){var b,c,d,e,f,g=wa(a);return 0===a?(b=" -15",c=fa+" 50",d=g+" -50",e=ha):(b=" 80",c=g+" -25",e=g+" 40",d=g),b=g+b,f=new pa,f[r](va(ia,d,b,0,ma,ma,ma,ma,ma,ka)),f[s](va(ga,c,0,0)),f[v](va(ga,e,0)),f[x](va(ga,e)),f[y](va(ga,c)),f[z](va(ia,c,0,0,ma,ma,ma,la)),f[A](va(ga,0,ia,1)),f[F](va(ga,0,b,1)),f[G](va(ga,0,0===a?fa:ia,1)),f[L](va(ga,0,ia,1)),f[L](va(ga,0,ia,1)),f[P](va(ia,0,ia,1,ma,la)),f}for(sa=function(){function a(){}return a}(),b.PivotTableThemes=sa,ta=0;ta<=28;ta++)ta>=0&&(sa["light"+ta]=xa(ta)),ta>0&&(sa["dark"+ta]=Ia(ta),sa["medium"+ta]=Da(ta))},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),P=this&&this.__assign||function(){return P=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},P.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot-util.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),k=c("SheetsCalc"),l=c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),m=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),n=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),o=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),p=c("./dist/plugins/pivot/pivot.ns.js"),q=c("@grapecity/js-calc"),r=c("./dist/plugins/pivot/pivot-table-entry.js"),s=d.Ul.lHb,t=e.Common.j,u=t.Fa,v=t.za,w=e.Common.u,x=e.Common.k,y=x.ac,z=x.Fb,A=e.Common.D,B=void 0,C=null,D=e.Common.j.C4,E=new e.Common.ResourceManager(p.SR),F=E.getResource.bind(E),G="grandTotal",H="subtotal",I={allowMultipleFiltersPerField:!1,fillDownLabels:!1,insertBlankLineAfterEachItem:!1,grandTotalPosition:h.GrandTotalPosition.both,subTotalsPosition:h.SubtotalsPosition.bottom,subtotalsPosition:h.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:h.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:C,rowLabelIndent:4,printDrill:C,itemPrintTitles:C,fieldPrintTitles:C,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:C,rowHeaderCaption:null,colHeaderCaption:null},J="4294967294";function Q(){var a,b={};for(a=1;a<=28;a++)b["PIVOTSTYLELIGHT"+a]=!0,b["PIVOTSTYLEMEDIUM"+a]=!0,b["PIVOTSTYLEDARK"+a]=!0;return b}K=Q(),L=function(){function a(a,b){this.bPc=a,this.cPc=b,this.views=[]}return a.prototype.save=function(a){var b,c=this;return!u(a)&&c.RS(a)===C&&(b=c.cPc(),c.views.push({name:a,config:b}),!0)},a.prototype.add=function(a){var b=this;return!u(a.name)&&b.RS(a.name)===C&&(b.views.push(a),
!0)},a.prototype.remove=function(a){var b=this,c=b.RS(a);c!==C&&b.views.splice(c,1)},a.prototype.get=function(a){var b=this,c=b.RS(a);if(c!==C)return b.views[c]},a.prototype.all=function(){return this.views},a.prototype.apply=function(a){var b=this,c=b.RS(a);null!==c&&b.bPc(b.views[c].config)},a.prototype.RS=function(a){var b,c,d=this;for(b=0;b<d.views.length;b++)if(c=d.views[b],c.name===a)return b;return null},a.prototype.toJson=function(){return f.GNc(this.views)},a.prototype.fromJson=function(a){this.views=a},a.prototype.no=function(){this.views=C},a}();function R(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,I,J,K,L,M=[],N=c.Nic,O=c.dataTable,P=N[a];if(P){if(o=P.path,p=P.isSubtotal,q=P.isGrandTotal,r=P.isBlankRow,s=P.valueFieldName,t=P.collapseIndex,v=P.isValueFieldDim,w=P.compactLevel,g.Fa(s)||(n=s),q&&i&&(l||m))return{ADc:n,Bs:{isGrandTotal:!0}};if(k&&!m&&(p&&u(t)||q)){for(x="",y=0;y<O[a].length;y++)O[a]&&O[a][y]&&(x+=O[a][y].value);return z=[{fieldName:q?G:H,itemName:x}],{Bs:z,ADc:n}}for(A=o.split(g.Separator),B=[].concat(d),C=void 0,D=k?F().sigmaValueTemp:F().sigmaValue,u(h)||l||(B.splice(h,0,{Cj:D}),A.splice(h,0,D)),E=i||l||p&&u(t)?A.length-1:j?w:b,I=0;I<=E;I++)z={},J=B[I],u(J)||(K=J.Cj,L="",L=K===D?n:f.mjc(e,J.Cj,A[I]),z={fieldName:K,itemName:L},I===E&&(C={name:K===D?L:K,index:I}),I===A.length-1&&(r&&(z.isBlankRow=!0),p&&(z.isSubtotal=!0),u(t)||(z.collapseIndex=t)),q&&(z.isGrandTotal=!0),M.push(z));return{isBlankRow:r,isValueFieldDim:v,ADc:n,activeRowFieldInfo:C,Bs:M}}}function S(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,I,J,K,L=[],M=c.Oic,N=c.dataTable,O=M[b];if(O){if(o=O.path,p=O.isSubtotal,q=O.isGrandTotal,r=O.valueFieldName,s=O.isBlankColumn,t=O.collapseIndex,v=O.grandTotalLevel,g.Fa(r)||(n=r),s)return{isBlankColumn:s};if(q&&i&&(l||m))return{ADc:n,Cs:L};if(k&&!m&&(p&&u(t)&&0===v||q)){for(w="",x=0;x<N.length;x++)N[x]&&N[x][b]&&(w+=N[x][b].value);return y=[{fieldName:q?G:H,itemName:w}],{Cs:y,ADc:n}}for(z=o.split(g.Separator),A=[].concat(d),B=void 0,C=k?F().sigmaValueTemp:F().sigmaValue,u(h)||l||(A.splice(h,0,{Cj:C}),z.splice(h,0,C)),D=i||l||p&&u(t)?z.length-1:a-1,E=0;E<=D;E++)y=void 0,I=A[E],u(I)||(J=I.Cj,K="",K=J===C?r:f.mjc(e,I.Cj,z[E]),y={fieldName:J,itemName:K},E===D&&(B={name:J===C?K:J,index:E}),E===z.length-1&&p&&(y.isSubtotal=!0),u(t)||(y.collapseIndex=t),q&&(y.isGrandTotal=!0),L.push(y));return{activeColFieldInfo:B,ADc:n,Cs:L}}}function T(a){var b=[];return a&&a.forEach(function(a){u(a.itemName)||b.push(a.itemName)}),b.join(" - ")}function U(a,b){return a===b}function V(a,b){if(!a||!b)return!1;if(a.fieldName===b.fieldName&&a.subtotal===b.subtotal){if(!a.items&&!b.items)return!0;if(!a.items||!b.items)return!1;if(a.items.length===b.items.length){a.items.sort(),b.items.sort();for(var c=0;c<a.items.length;c++)if(a.items[c]!==b.items[c])return!1;return!0}}return!1}function W(a,b){for(var c=0,d=b.length;c<d;c++)if(b[c]&&b[c].fieldName===a)return b[c]}function X(a,b){var c,d,e,f,g,h,i;if(u(a)||u(b))return!1;if(a.type!==b.type||a.fieldName!==b.fieldName||!U(a.offset,b.offset)||a.dataOnly!==b.dataOnly||a.labelOnly!==b.labelOnly||a.grandRow!==b.grandRow||a.grandCol!==b.grandCol||a.axis!==b.axis)return!1;if(a.references===B&&b.references!==B||a.references!==B&&b.references===B)return!1;if(a.references!==B&&b.references!==B){if(a.references.length!==b.references.length)return!1;for(Y(a),c=b.references,d=a.references,e=0,f=d.length;e<f;e++)if(g=d[e],h=g.fieldName,i=W(h,c),!V(g,i))return!1}return!0}function Y(a){a.references&&a.references.length>1&&a.references.sort(function(a,b){return a.fieldName>b.fieldName?-1:a.fieldName<b.fieldName?1:void 0})}function Z(a){switch(a){case"origin":return h.PivotAreaType.corner;case"button":return h.PivotAreaType.button;case"topRight":case"topEnd":return h.PivotAreaType.topRight;default:return}}function $(a){switch(a){case h.PivotAreaType.corner:return"origin";case h.PivotAreaType.button:return"button";case h.PivotAreaType.topRight:return"topRight";default:return}}function _(a){var b,c,d=[],e={start:a[0],end:a[0]};for(b=1,c=a.length;b<c;b++)a[b]-1===a[b-1]?e.end=a[b]:(d.push(e),e={start:a[b],end:a[b]});return d.push(e),d}function aa(a){var b,c,d,e,f,g,h,i={},j=a.pivotArea;if(j){i.pivotArea={};for(b in j)if(j.hasOwnProperty(b))if("references"===b&&j.references)for(c=i.pivotArea.references=[],d=0;d<j.references.length;d++){e=j.references[d],f={};for(g in e)if(e.hasOwnProperty(g))if("items"===g&&e.items){if(e.items)for(f.items=[],h=0;h<e.items.length;h++)f.items.push(e.items[h])}else f[g]=e[g];c.push(f)}else i.pivotArea[b]=j[b]}return a.style&&(i.style=ba(a.style)),i}function ba(a){if(a instanceof d.Style)return a.clone();var b=new d.Style;if("string"==typeof a)b.fromJSON(JSON.parse(a),!1,void 0);else{if("object"!=typeof a)return null;b.fromJSON(a,!1,void 0)}return b}function ca(a,b,c,d,e,f){var i,j,k,l,m,n,o;if(void 0===f&&(f=3),i=c.pivotTables.all(),j=!1,e=!!e,f&h.overlapCheck.pt&&g.vhc(i,function(a){var f,g,h,i,k,l,m;if((a.name()!==d||!d)&&(f=a.getRange(),g=f.page,h=f.content,i=!1,k=!1,g&&(i=null!==g.getIntersect(b,0,0)),k=null!==h.getIntersect(b,0,0),k||i))return l=F().PivotTableErrorMessage_Overlap,m={message:l,cancel:!1,force:!0},e?c.pivotTables.Os(!1,{type:11,args:m}):c.Os(11,m),j=!0,!0}),j)return!0;if(f&h.overlapCheck.value)for(k=c.ITa.XTa(3).dataTable,l=b.row;l<b.row+b.rowCount;l++)for(m=b.col;m<b.col+b.colCount;m++)if(k[l]&&a&&!a.contains(l,m)&&k[l][m]&&k[l][m].value)return n=F().PivotTableErrorMessage_ExistData.replace("{}",c.name()),o={message:n,cancel:!1,force:!1},e?c.pivotTables.Os(!1,{type:11,args:o}):c.Os(11,o),!0;return!1}b.IOc=ca,M=function(){function a(a){this.AW=[],this.dPc={fieldLevel:{},itemLevel:{}},this.ePc=a}return a.prototype.no=function(){this.ePc=C,this.AW=C,this.dPc=C},a.prototype.fPc=function(a){var b,c,d=this,e=d.AW,f=[],g=u(a);for(b=0;b<e.length;b++)if(e[b].pivotAreas)for(c=0;c<e[b].pivotAreas.length;c++)(g||X(a,e[b].pivotAreas[c]))&&f.push(e[b].conditionalRule);return f},a.prototype.gPc=function(a,b,c){var d=this;d.hPc(a,b,c)},a.prototype.hPc=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(u(a)||a.length<=0)&&b&&(d=this,e=d.AW,f=d.ePc,g=f.qo,!u(g.conditionalFormats)&&(h={conditionalRule:b,pivotAreas:a},b.pivotTableAreas=a,b.pivotTableName=f.name(),e.push(h),!c))){for(i=[],k=0;k<a.length;k++)j=f.getPivotAreaRanges(a[k]),j&&j.length>0&&(i=i.concat(j));i.length>0&&(b.ranges(i),g.conditionalFormats.addRule(b))}},a.prototype.jPc=function(){var a,b,c,d=this,e=d.AW,f=d.ePc,g=f.qo,h=g.conditionalFormats;if(!u(h)){for(d.AW=[],a=0,b=e.length;a<b;a++)c=e[a],h.removeRule(c.conditionalRule);for(a=0,b=e.length;a<b;a++)c=e[a],d.gPc(c.pivotAreas,c.conditionalRule)}},a.prototype.zR=function(){return this.AW},a.prototype.aPc=function(a){var b,c=this.AW;for(b=0;b<c.length;b++)c[b].conditionalRule&&c[b].conditionalRule.priority()===a&&c.splice(b,1)},a.prototype.kPc=function(a,b){var c,d,e,f=this,g=f.AW,h=f.ePc;for(c=0;c<g.length;c++){if(a===g[c].conditionalRule){for(d=[],e=0;e<b.length;c++)d=d.concat(h.getPivotAreaRanges(b[e]));a.ranges(d)}g[c].pivotAreas=b}},a.prototype.lPc=function(a){var b,c=this,d=c.AW,e=c.ePc,f=e.qo;for(b=0;b<d.length;b++)a===d[b].conditionalRule&&f.conditionalFormats.removeRule(a)},a.prototype.mPc=function(a){var b,c,d,e,f=this,g=f.AW,h=f.ePc,i=h.qo;for(b=0;b<g.length;b++)if(c=g[b],c.pivotAreas){if(a.length!==c.pivotAreas.length)continue;for(d=!0,e=0;e<a.length;e++)if(!X(a[e],c.pivotAreas[e])){d=!1;break}d&&(i.conditionalFormats.removeRule(c.conditionalRule),g.splice(b,1))}},a.prototype.nPc=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.ePc,m=l.qo,n=m.conditionalFormats,o=[],p=n.UV(a.ranges());for(f=0,g=y(p);f<g;f++)h=n.IW(p[f],b,c,d,e),h&&(o=o.concat(h));if(y(o)>0){for(i=[],f=0;f<o.length;f++)j=m.pivotTables.getRangePivotAreas(o[f]),j&&i.push(j);k.kPc(a,i)}else k.lPc(a)},a.prototype.oPc=function(){this.AW.length=0,this.dPc={fieldLevel:{},itemLevel:{}}},a.prototype.count=function(){return y(this.AW)},a}(),b.PivotTableConditionalFormats=M;function da(a,b){return b.priority=a.priority&&a.priority(),b.scope=a.scope&&a.scope(),b.type=a.type&&a.type(),b}function ea(a){var b,c;if(!a)return!0;if(v(a))return!0;b=!0;for(c in a)if(a.hasOwnProperty(c)&&"_id"!==c){b=!1;break}return b}function fa(a,b,c){var d,e,f=b.row,g=b.col,h=b.rowCount,i=b.colCount;if(c.borderLeft)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),u(a[f+d][g])&&(a[f+d][g]={}),a[f+d][g].borderLeft=!0;if(c.borderRight)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),u(a[f+d][g+i-1])&&(a[f+d][g+i-1]={}),a[f+d][g+i-1].borderRight=!0;if(c.borderTop)for(a[f]||(a[f]={}),e=0;e<i;e++)u(a[f][g+e])&&(a[f][g+e]={}),a[f][g+e].borderTop=!0;if(c.borderBottom)for(a[f+h-1]||(a[f+h-1]={}),e=0;e<i;e++)u(a[f+h-1][g+e])&&(a[f+h-1][g+e]={}),a[f+h-1][g+e].borderBottom=!0}function ga(a,b){a.sort(function(a,c){return b?a.row-c.row:a.col-c.col})}function ha(a){var b,c,d,e;if(!a)return[];for(b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);if(b.length<=1)return b;if(d=[],b[0].row===b[1].row&&b[0].rowCount===b[1].rowCount)for(ga(b,!1),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].col+b[c].colCount!==b[e].col||b[c].row!==b[e].row||b[c].rowCount!==b[e].rowCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].colCount=b[c].colCount+b[e].colCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else if(b[0].col===b[1].col&&b[0].colCount===b[1].colCount)for(ga(b,!0),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].row+b[c].rowCount!==b[e].row||b[c].col!==b[e].col||b[c].colCount!==b[e].colCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].rowCount=b[c].rowCount+b[e].rowCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else d=b;return d}N=function(a){O(b,a);function b(b,c,d,e,i,k,m,n){var o,p,q=a.call(this,b,n)||this;return q.FWc=0,o=q,o.Lia=0,o.$jc={row:u(d)?0:d,col:u(e)?3:e},o.suspendLayout(),o.ys=new j.PivotDataModel,o.qo=c,o.$jc={row:u(d)?0:d,col:u(e)?3:e},p=o.refresh.bind(o),o.options=f.Ql(I,q,p),o.HIc(m),o.Zaa=k||l.PivotTableThemes.light16,o.oNb=[],o.pNb=[],u(i)?o.wic=h.PivotTableLayoutType.outline:o.wic=i,o.vic.setSigmaValuePosition(g.DataPosition.col,0),o.tOc={sOc:[],uOc:[],pPc:[],qPc:[]},o.rPc=[],o.hOc=[],o.sPc={},o.tPc={},o.NWc={},M&&(o.U5=new M(o)),o.views=new L(o.deserialize.bind(o),o.serialize.bind(o)),o.uPc="",o.vPc="",o.resumeLayout(),q}return b.prototype.getPivotDetails=function(a){if(u(a))throw Error(F().param_error);var b=this;return b.vic?b.vic.ANc(a):void 0},b.prototype.getSource=function(){var a,b=this.vic;if(b&&(a=b.uNc(),"string"==typeof a))return a},b.prototype.getSourceFields=function(){var a,b,c,d,e,f=this.vic,h=[];if(f&&(a=f.vNc(),!u(a)))for(c=0,d=a;c<d.length;c++)e=d[c],b={name:e.name},g.Fa(e.fieldType)||(b.fieldType=e.fieldType),h.push(b);return h},b.prototype.updateSource=function(){var a=this,b=a.vic;b&&b.DNc(a.qo)},b.prototype.serialize=function(){return this.wPc(2047)},b.prototype.wPc=function(a){var b,c,d,e,i,j,k,l,m,n,o,p,q=this,r=q.layoutType(),s={},t=[],u=q.options,v=q.vic,w=q.$jc,x=q.vic.getSigmaValuePosition(),y={};if(a&h.SerializeIndex.options){for(b in u)u.hasOwnProperty(b)&&"object"!=typeof u[b]&&(s[b]=u[b]);y.options=s}if(a&h.SerializeIndex.layout&&(y.layoutType=r),a&h.SerializeIndex.position&&(y.pivotTablePosition=[w.row,w.col]),a&h.SerializeIndex.theme&&(y.theme=q.theme().name()),a&h.SerializeIndex.styles)for(c=y.styles=[],d=q.hOc,e=0;e<d.length;e++)c.push(aa(d[e]));if(!(a&h.SerializeIndex.fields))return y;for(e=0;e<4;e++){for(i=v.Shc(e),j=[],k=0;k<i.length;k++)l=i[k],m={sourceName:l.whc,displayName:l.Cj},g.Fa(l.Fhc)||(m.subtotal=l.Fhc),a&h.SerializeIndex.filter&&(n=q.labelFilter(l.Cj),o=q.valueFilter(l.Cj),n&&(m.labelFilter=n),o&&o.conditionByName&&(m.valueFilter=o)),a&h.SerializeIndex.sort&&l.zZ&&(m.sortInfo=l.zZ),3===e&&a&h.SerializeIndex.showValueAs&&q.xPc&&(p=q.showDataAs(l.Cj),p&&(y.showDataAsList||(y.showDataAsList=[]),y.showDataAsList.push({valueFieldName:l.Cj,showDataAsInfo:p}))),j.push(m);t[e]=j}return x&&(y.valuePosition=x),a&h.SerializeIndex.collapse&&(y.collapseItems=f.GNc(v.Xhc)||{}),y.fieldsInfo=t,y},b.prototype.deserialize=function(a){this.ROc(a,2047)},b.prototype.ROc=function(a,b){var c,d,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this;A.qo.suspendPaint(),A.suspendLayout();try{for(c=A.vic,d=0;d<4;d++)c.yDc(d);if(b&h.SerializeIndex.position&&A.position(a.pivotTablePosition[0],a.pivotTablePosition[1]),b&h.SerializeIndex.layout&&A.layoutType(a.layoutType),b&h.SerializeIndex.options)for(e=Object.keys(a.options),d=0;d<e.length;d++)A.options[e[d]]!==a.options[e[d]]&&(A.options[e[d]]=a.options[e[d]]);if(b&h.SerializeIndex.theme&&a.theme&&A.theme(a.theme),b&h.SerializeIndex.styles)for(A.yPc(),f=a.styles||[],d=0;d<f.length;d++)A.setStyle(f[d].pivotArea,f[d].style);if(b&h.SerializeIndex.fields){for(d=0;d<4;d++)for(i=a.fieldsInfo[d],j=0;j<i.length;j++)k=i[j],l=k.sourceName,m=k.displayName,n=k.subtotal,c.isFieldActualExist(l)&&c.addFieldByName(l,m,d,n,void 0);a.valuePosition&&c.setSigmaValuePosition(a.valuePosition.positionType,a.valuePosition.positionIndex)}for(d=0;d<4;d++)for(i=a.fieldsInfo[d],j=0;j<i.length;j++)k=i[j],l=k.sourceName,m=k.displayName,o=k.valueFilter,p=k.labelFilter,q=k.sortInfo,b&h.SerializeIndex.filter&&(p&&c.isFieldActualExist(l)&&c.setLabelFilterInfo(m,p),o&&c.isFieldActualExist(l)&&c.setValueFilterInfo(m,o)),b&h.SerializeIndex.sort&&q&&c.isFieldActualExist(l)&&c.setSortInfo(l,q);if(b&h.SerializeIndex.collapse&&(r=a.collapseItems))for(s=0,t=Object.keys(r);s<t.length;s++)for(u=t[s],v=r[u],w=0,x=Object.keys(v);w<x.length;w++)y=x[w],A.collapse(u,y,v[y]);b&h.SerializeIndex.showValueAs&&(z=a.showDataAsList,z&&g.vhc(z,function(a){A.showDataAs(a.valueFieldName,a.showDataAsInfo)}))}catch(a){throw Error(a)}finally{A.resumeLayout(),A.qo.resumePaint()}},b.prototype.HIc=function(a){var b,c=this,d=c.options,e=I;if(!u(a))for(b in a)A(a,b)&&A(e,b)&&(d[b]=a[b])},b.prototype.altText=function(a,b){return u(a)&&u(b)?{altText:this.uPc,altTextSummary:this.vPc}:(u(a)||(this.uPc=a),void(u(b)||(this.vPc=b)))},b.prototype.name=function(a){var b,c;if(0===arguments.length)return this.Cj;if(this.qo&&this.qo.parent&&(b=this.qo.parent.ekc(a)))throw Error(F().RepeatName);c=this.Cj,this.Cj=a,this.qo.parent.Zjc(a,!0,c),this.RVa({pivotTable:this,name:a,oldName:c,type:"name",pivotType:0})},b.prototype.position=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=this;if(0===arguments.length)return{row:m.$jc.row,col:m.$jc.col,sheetName:m.qo.name()};if(d=m.qo,f=d&&d.parent,!u(m.qo)&&"number"==typeof a&&"number"==typeof b){if(h=m.$jc.row,i=m.$jc.col,m.$jc.row=a,m.$jc.col=b,!u(c)&&c!==d.name()){if(e=f&&f.getSheetFromName(c),u(e))return;for(g=d.pivotTables,j=g&&g.Vjc,k=j.length,l=0;l<k;l++)if(j[l].name()===m.Cj){j.splice(l,1);break}e.pivotTables.Vjc.push(m)}m.RVa({pivotTable:m,row:a,col:b,oldCol:i,oldRow:h,sheetName:d.name(),type:"position",pivotType:0}),m.refresh(),e&&(m.qo=e,m.NOc(e.pivotTables.GOc,e.pivotTables.HOc))}},b.prototype.sort=function(a,b){return 1===arguments.length?this.vic.getSortInfo(a):(arguments.length>1&&this.vic.setSortInfo(a,b),void this.refresh())},b.prototype.group=function(a){var b=this.vic.uic(a);"boolean"==typeof b?(this.vic.Ehc=!0,this.refresh()):this.qo.Os(10,b)},b.prototype.getGroupInfo=function(a){var b,c,d;if(!u(a)&&""!==a)return b=this,c=b.vic,d=c.WNc(a),u(d)?void 0:P({},d)},b.prototype.ungroup=function(a){var b,c;this.vic.WFc(a),this.vic.Ehc=!0,b=this.qo,b&&(c=b.getParent(),c.FNc()),this.refresh()},b.prototype.add=function(a,b,c,d,e){var f,i=this,j=i.vic;if(!u(a)&&!u(b)&&u(j.Ohc[b])&&(f=i.vic.tNc(a))){if(!u(f.Yw)){if(c!==h.PivotTableFieldType.valueField)return void r.throwError(F().FieldAreaLimited);d=g.SubtotalType.sum}j.addFieldByName(a,b,c,d,e),this.refresh()}},b.prototype.remove=function(a){var b=this.vic,c=b.Ohc[a],d=b.removeFieldOrSigmaByName(a);d instanceof r.PivotViewField&&(c===h.PivotTableFieldType.valueField?b.clearValueFilterOfValueField(a):b.wNc(a,!1)),this.refresh()},b.prototype.theme=function(a){if(0===arguments.length)return this.Zaa;if("string"==typeof a){var b=l.PivotTableThemes[a.toLowerCase()]||l.PivotTableThemes.light0;this.RVa({pivotTable:this,theme:b,type:"changeTheme",oldTheme:this.Zaa&&this.Zaa.name(),pivotType:0}),this.Zaa=b}else this.RVa({pivotTable:this,theme:a,type:"changeTheme",oldTheme:this.Zaa&&this.Zaa.name(),pivotType:0}),this.Zaa=a;this.refresh()},b.prototype.RVa=function(a){var b,c,d=this.qo;d&&(b=d.getParent(),g.Fa(b.PNc)&&this.getRange&&(b.PNc={range:this.getRange()}),c=d.ITa,c.JOc(this,a))},b.prototype.RUa=function(a){var b=this,c=a.type;switch(c){case"changeTheme":b.theme(a.oldTheme);break;case"layoutType":b.layoutType(a.oldLayoutType);break;case"name":b.name(a.oldName);break;case"position":b.position(a.oldRow,a.oldCol,a.sheetName);break;case"setStyle":b.setStyle(a.pivotArea,a.oldStyle);break;case"options":b.options[a.pn]=a.old;break;case"addCalcField":b.removeCalcField(a.fieldName);break;case"removeCalcField":b.addCalcField(a.fieldName,a.formula);break;case"showDataAs":u(a.oldShowDataAs)?b.showDataAs(a.fieldName,{showDataAs:g.PivotShowDataAs.normal}):b.showDataAs(a.fieldName,a.oldShowDataAs);break;case"resetPivotStyle":b.yPc(a.areaModel,a.rangeModel);break;case"adjustRange":b.$jc.row=a.oldRow;break;case"conditionalRulesChange":b.U5.AW=a.originalConditionalRules,b.U5.jPc()}},b.prototype.updateField=function(a,b,c){var d=this,e=d.vic;a===F().sigmaValue?e.setSigmaValuePosition(b-1,c):u(a)||e.changeFieldArea(a,b,c),this.refresh()},b.prototype.MWc=function(a,b,c){var d,e,i,j,k,l,m=this,n=m.vic,o=n.getFieldInfoByName(a),p=n.Ohc;if(b&&o){if(p[a]===h.PivotTableFieldType.valueField)f.GWc(m,a,o.pNc&&o.pNc.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(p[a]!==h.PivotTableFieldType.filterField)for(d=n.Shc(h.PivotTableFieldType.valueField),e=0,i=d;e<i.length;e++)j=i[e],j.pNc&&j.pNc.baseFieldName===a&&f.GWc(m,j.Cj,j.pNc&&j.pNc.showDataAs)}else if(o&&!b)if(p[a]===h.PivotTableFieldType.valueField&&c!==h.PivotTableFieldType.valueField)f.GWc(m,a,o.pNc&&o.pNc.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(!(p[a]!==h.PivotTableFieldType.rowField&&p[a]!==h.PivotTableFieldType.columnField||c!==h.PivotTableFieldType.filterField&&c!==h.PivotTableFieldType.valueField))for(d=n.Shc(h.PivotTableFieldType.valueField),k=0,l=d;k<l.length;k++)j=l[k],j.pNc&&j.pNc.baseFieldName===a&&(f.GWc(m,a,j.pNc&&j.pNc.showDataAs),m.showDataAs(j.Cj,{showDataAs:g.PivotShowDataAs.normal}))},b.prototype.updateFieldName=function(a,b){var c=this.vic.getFieldInfoByName(a);"string"==typeof b&&(c&&this.vic.changeFieldName(c,b)?(this.vic.Ehc=!0,this.refresh()):this.qo.Os(10,F().PivotTableErrorMessage_EmptyFieldName))},b.prototype.autoFitColumn=function(){var a=this.APc(),b=this.qo;b.suspendPaint(),g.vhc(a,function(a){g.vhc(a,function(a){b.setColumnWidth(a.col,a.width)})}),b.resumePaint()},b.prototype.APc=function(){var a,b,c,e,f,h,i,j,k,l=this.$jc.col,m=this.ys.Uic[2],n=m.hF,o=m.Oic,p=this.ejc(),q=p.length,r=[],s=[],t=this.vic.getSigmaValuePosition(),u=!1,v=!1;for(t.display&&1===t.positionType&&(q+=1,t.positionIndex===q-2?u=!0:t.positionIndex===q-1||(v=!0)),a=this.$jc.row+this.$jc.rowCount,b=this.$jc.col;b<this.$jc.col+n;b++)c=d.Ul.xl(b,this.qo,3,1,a),r.push([{col:b,width:c}]);for(e=C,f=v?3:2,b=0;b<o.length;b++)h=o[b].path,i=o[b].isSubtotal,j=h.split(g.Separator),k=j[q-f],u&&(k=o[b].valueFieldName),c=d.Ul.xl(l+n+b,this.qo,3,1,a),null!==e&&e!==k?(this.BPc(s,r),s=[],s.push({col:l+n+b,width:c}),b===o.length-1&&r.push(s.slice())):(i&&(this.BPc(s,r),s=[]),s.push({col:l+n+b,width:c}),b===o.length-1&&this.BPc(s,r)),e=j[q-f],u&&(e=o[b].valueFieldName);return r},b.prototype.BPc=function(a,b){var c,d,e=[];a.forEach(function(a){e.push(a.width)}),c=Math.max.apply(Math,e),d=[],a.forEach(function(a){d.push({col:a.col,width:c})}),b.push(d.slice())},b.prototype.collapse=function(a,b,c){return 2===arguments.length?this.vic.getCollapse(a,b):void(arguments.length>2&&(this.vic.setCollapse(a,b,c),this.refresh()))},b.prototype.labelFilter=function(a,b){return 1===arguments.length?this.vic.getLabelFilterInfo(a):(this.vic.setLabelFilterInfo(a,b),void this.refresh())},b.prototype.valueFilter=function(a,b){return 1===arguments.length?this.vic.getValueFilterInfo(a):(this.vic.setValueFilterInfo(a,b),void this.refresh())},b.prototype.subtotalType=function(a,b){return this.subTotalType.apply(this,arguments)},b.prototype.subTotalType=function(a,b){var c=this;if(!u(c.vic)){if(1===arguments.length)return c.vic.xNc(a);c.vic.xNc(a,b),c.refresh()}},b.prototype.layoutType=function(a){var b,c=this;if(0===arguments.length)return c.wic;if(c.wic!==a){switch(b=c.wic,c.wic=a,a){case h.PivotTableLayoutType.compact:c.outline=!0,c.outlineData=!0,c.compact=void 0,c.compactData=void 0;break;case h.PivotTableLayoutType.outline:c.outline=!0,c.outlineData=!0,c.compact=!1,c.compactData=!1;break;case h.PivotTableLayoutType.tabular:c.compact=!1,c.compactData=!1,c.outline=void 0,c.outlineData=void 0}this.refresh(),this.RVa({pivotTable:this,layoutType:a,oldLayoutType:b,type:"layoutType",pivotType:0})}},b.prototype.dataPosition=function(a,b){var c,d=this;return 0===arguments.length?d.vic.getSigmaValuePosition():(c=d.getFieldsByArea(a+1).length,b<0?b=0:b>c&&(b=c),d.vic.setSigmaValuePosition(a,b),void d.refresh())},b.prototype.getItemsByField=function(a){return this.vic.SFc(a)},b.prototype.showDataAs=function(a,b){if(1===arguments.length)return this.vic.getFieldInfoByName(a).pNc;var c=this.vic.getFieldInfoByName(a).pNc;b.showDataAs===g.PivotShowDataAs.normal?this.xPc=!1:this.xPc=!0,this.vic.getFieldInfoByName(a).pNc=b,c&&(c=P({},c)),this.RVa({pivotTable:this,fieldName:a,oldShowDataAs:c,type:"showDataAs",pivotType:0}),this.refresh()},b.prototype.getFieldsByArea=function(a){var b,c,d,e,f=this.vic,h=this.vic.Shc(a)||[];return h.map(function(h){return d=h.Cj,a=f.Ohc[d],c=f.Shc(a),b=r.iNc(c,d),e={fieldName:d,sourceName:h.whc,dataType:h.ny,pivotArea:a,pivotIndex:b},h.ny!==g.PivotDataType.string&&(e.start=h.bGb,e.end=h.kNc),e})},b.prototype.getField=function(a){var b,c,d,e,f=this,h=f.vic,i=h.getFieldInfoByName(a);return i?(c=h.Ohc[a],d=h.Shc(c),e=r.iNc(d,a),b={fieldName:a,sourceName:i.whc,dataType:i.ny,pivotArea:c,pivotIndex:e},i.ny!==g.PivotDataType.string&&(b.start=i.bGb,b.end=i.kNc),b):null},b.prototype.addCalcField=function(a,b){this.vic.TNc(a,b),this.vic.Ehc=!0,this.refresh(),this.RVa({pivotTable:this,fieldName:a,formula:b,type:"addCalcField",pivotType:0})},b.prototype.getCalcFields=function(){return this.vic.UNc()},b.prototype.removeCalcField=function(a){var b,c,d,e,f,g,h,i=this,j=a,k=i.vic.getFieldInfoByName(a);for(k&&(j=k.whc),b=this.vic.Ihc,c=this.vic.qo,d=c.getCalcFields(b),i.vic.rDc(a),i.vic.NNc(j),i.vic.Ehc=!0,e=this.qo,e&&(f=e.getParent(),f.FNc()),this.refresh(),g=0;g<d.length;g++)h=d[g],h.Cj===a&&this.RVa({pivotTable:this,fieldName:a,formula:h.Yw,type:"removeCalcField",pivotType:0})},b.prototype.adjustRange=function(){var a=this.ys.Uic[0],b=a.Xj,c=this.$jc.row,d=c,e=this.$jc.col;b>0&&c-(b+1)<0&&(this.$jc.row=b+1,this.RVa({pivotTable:this,oldRow:d,oldCol:e,type:"adjustRange",pivotType:0}))},b.prototype.EZ=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.qo;m.suspendPaint(),l.adjustRange(),a=this.ys.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],b.setStartInfo(0,0),l._jc={row:this.$jc.row-(b.Xj+1),col:this.$jc.col,rowCount:b.Xj,colCount:b.OZ},l.$jc.rowCount=c.Xj+e.Xj,l.$jc.colCount=c.OZ+d.OZ,c.setStartInfo(0,0),d.setStartInfo(0,c.OZ),e.setStartInfo(d.Xj,0),f.setStartInfo(d.Xj,e.OZ),l.CPc(),l.DPc(),l.U5.jPc(),g=l.qo&&l.qo.getParent(),g&&g.PNc&&(h=g.PNc.range,i=l.getRange(),h&&(j=h.page?h.page.union(h.content):h.content,k=i.page?i.page.union(i.content):i.content,j.rowCount&&j.colCount&&ca(j,k,l.qo,l.Cj,!0)&&l.qo.pivotTables.Os(!0)),g.PNc=C),m.pivotTables.NOc(),m.resumePaint()},b.prototype.getValue=function(a,b){var c,d,e,f=a-this.$jc.row,i=b-this.$jc.col,j=this.ys.Uic,k=j[0],l=j[1],m=j[2],n=j[3],o=j[4],p=k.Xj>0&&k.OZ>0,q=a,r=b;return p&&(q=a-this._jc.row,r=b-this._jc.col),p&&k.Xj>q?k.ge(q,r):l.Xj>f?l.OZ>i?l.ge(f,i):m.ge(f,i-l.OZ):n.OZ>i?(c=n.ge(f-l.Xj,i),g.Fa(c)?c:this.wic===h.PivotTableLayoutType.compact?c+"":c):0===this.vic.Shc(3).length?C:(d=o.ge(f-l.Xj,i-l.OZ),d===g.EmptyValue?C:this.EPc(n,a)&&!(this.isTitleRow(n,a)||this.isSubtotalRow(n,a)||this.isBlankRow(n,a))?(e=this.FPc(d),g.Fa(e)?d:e):d)},b.prototype.yq=function(a,b,c){var d,e=a-this.$jc.row,f=b-this.$jc.col,g=this.ys.Uic,i=g[0],j=g[1],k=g[2],l=g[3],m=i.Xj>0&&i.OZ>0,n=a,o=b;m&&(n=a-this._jc.row,o=b-this._jc.col),m&&i.Xj>n&&i.yq(n,o,c),j.Xj>e&&(j.OZ>f?j.yq(e,f,c):k.yq(e,f-j.OZ,c)),l.OZ>f&&(d=this.wic===h.PivotTableLayoutType.compact?c+"":c,l.yq(e-j.Xj,f,d))},b.prototype.FPc=function(a){var b,c=this;if(u(a)){if(c.xPc)return;if(c.options.showMissing){if(b=c.options.missingCaption,f.XNc(a)&&!g.Fa(b))return b}else if(f.XNc(a))return 0}else if(a instanceof q.CalcError||a===1/0){if(c.options.isShowErrorValue&&!u(c.options.errorValueInfo))return c.options.errorValueInfo;if(a===1/0)return q.Errors.Number}},b.prototype.NOc=function(a,b){var c=this.getRange(),d=c.content,e=c.page;e&&this.GPc(a,b,e),this.GPc(a,b,d)},b.prototype.GPc=function(a,b,c){var d;for(d=c.row;d<c.row+c.rowCount;d++)a[d]=!0;for(d=c.col;d<c.col+c.colCount;d++)b[d]=!0},b.prototype.EPc=function(a,b){return 3===a.ILa&&this.$jc.rowCount+this.$jc.row>b},b.prototype.isSubtotalRow=function(a,b){var c=a.Nic[b-a.nU-this.$jc.row];return c&&c.isSubtotal},b.prototype.isBlankRow=function(a,b){var c=a.Nic[b-a.nU-this.$jc.row];return c&&c.isBlankRow},b.prototype.isTitleRow=function(a,b){if(this.wic===h.PivotTableLayoutType.tabular)return!1;var c=a.Nic[b-a.nU-this.$jc.row];return!!c&&(void 0===c.isValueFieldDim||!c.isValueFieldDim)},b.prototype.UOc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,x,y,z=this.getPivotInfoImp(a,b,!0);if(z){if(e=B,f=void 0,g=void 0,h=void 0,i=z.value,j=z.area,k=z.menuArea,l=z.valueFieldName,m=z.rowInfos,n=z.colInfos,o=z.colHeadFieldInfo,p=z.activeRowFieldInfo,q=z.activeColFieldInfo,r=this.HPc(a,b)&&this.HPc(a,b).formatter,u(r)||(i=d.mn.un(i,r)),3===k)return e;switch(this.options.showMissing&&(h=this.options.missingCaption),j){case 3:if(!u(m)){if(5===k||1===m.length&&m[0].fieldName===H){i=i||m[0].itemName||h,u(i)||(e=[i]);break}if(p){for(;p.index>=0&&m[p.index]&&u(m[p.index].itemName);)p.index=p.index-1;s=m[p.index],s&&(f=s.itemName+" ("+s.fieldName+")")}g=F().toolTipContent_Row+T(m),e=[f,g]}break;case 2:if(!u(o))break;if(!u(n)){if(5===k||1===n.length&&n[0].fieldName===H){i=i||n[0].itemName||h,u(i)||(e=[i]);break}if(q){for(;q.index>=0&&n[q.index]&&u(n[q.index].itemName);)q.index=q.index-1;t=n[q.index],t&&(f=t.itemName+" ("+t.fieldName+")")}g=F().toolTipContent_Column+T(n),e=[f,g]}break;case 4:u(l)||(i=i||h,u(i)&&(i=F().toolTipContent_NoValue),f=F().toolTipContent_Value+i,e=[l,f],u(m)||(v=F().toolTipContent_Row+T(m),e.push(v)),u(n)||(x=F().toolTipContent_Column+T(n),e.push(x)))}if(!u(e)){for(y=0;y<e.length;y++)e[y]=w.Ob(e[y]);c?e.unshift(F().PivotTableForAccessibility+this.Cj):e[0]="<b>"+e[0]+"</b>",e=e.join("\r\n")}return e}},b.prototype.getPivotInfo=function(a,b){var c,d=this,e=d.getRange();if((e.content.contains(a,b)||e.page&&e.page.contains(a,b))&&(c=d.getPivotInfoImp(a,b),!u(c)))return c.row=a,c.col=b,c},b.prototype.getPivotInfoImp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=a-u.$jc.row,w=b-u.$jc.col;return u.iT()?{menuArea:3}:(f=a-u._jc.row,g=b-u._jc.col,h=u.ys.Uic,i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=u.vic,o=n.Jhc,p=n.Khc,q=n.Mhc,i.Xj>f?(r=u.IPc(f,g,i),r.row=a,r.col=b,s=i.Lic(f,g),s&&(r.pageFieldInfo={fieldName:s}),r.menuArea=0,r):j.Xj>v?j.OZ>w?(r=u.IPc(v,w,j),r.row=a,r.col=b,t=j.Mic[w],r.menuArea=3,v===j.Xj-1&&t?(r.cornerFieldInfo={fieldName:t.fieldName,isDim:t.isDim,isCompactRoot:t.isCompactRoot},t.isCompactRoot||(r.menuArea=2)):0===v&&0===w&&1===u.fic().length&&r.value&&(r.menuArea=1),r):u.JPc(v,w-j.OZ,k,p,!1,c,d,e):l.OZ>w?u.JPc(v-j.Xj,w,l,o,!0,c,d,e):u.KPc(v-j.Xj,w-j.OZ,[l,k,m],[o,p,q],c,d,e))},b.prototype.IPc=function(a,b,c){return{relativeRow:a,relativeColumn:b,value:c.ge(a,b),area:c.ILa}},b.prototype.KPc=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p=this,q=c[0],r=c[1],s=c[2],t=d[0],v=d[1],w=d[2],x=p.kOc,y={};return p.vic.Mhc.length>1&&(y=p.vic.getSigmaValuePosition()),j=y.positionType,k=y.positionIndex,l=p.wic===h.PivotTableLayoutType.compact,m=R(a,b,q,t,x,0===j?k:B,!0,l,e,f,g),n=S(a,b,r,v,x,1===j?k:B,!0,l,e,f,g),o=p.IPc(a,b,s),o.menuArea=4,m&&m.isValueFieldDim===!1&&(u(j)&&!g||(o.menuArea=3)),m&&m.isBlankRow&&(o.menuArea=3),m&&(o.rowInfos=m.Bs),n&&!n.isBlankColumn&&(o.colInfos=n.Cs),i=0===j?m&&m.ADc:n&&n.ADc,u(i)&&1===p.vic.Mhc.length&&(i=w[0].Cj),f&&1===p.vic.Mhc.length&&(i=this.vic.getFieldInfoByName(i).whc),o.area=s.ILa,o.valueFieldName=i,o},b.prototype.JPc=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,o,p,q,r,s,t,v,w,x=this,y=x.kOc,z=x.wic===h.PivotTableLayoutType.compact,A=x.IPc(a,b,c),C=x.vic.Mhc.length>1,D={};return C&&(D=x.vic.getSigmaValuePosition()),k=D.positionType,l=D.positionIndex,e?(m=c.Nic,n=m[a],n&&(A.menuArea=2,n.isBlankRow&&(A.menuArea=3),n.isGrandTotal&&(A.menuArea=5),o=0===k?l:B,(!z&&!u(o)&&b===o&&n.valueFieldName||z&&n.isSigmaValue)&&(A.menuArea=4),g||(j=R(a,b,c,d,y,o,!1,z,f,g,i),j&&(A.activeRowFieldInfo=j.activeRowFieldInfo,A.rowInfos=j.Bs,j.ADc&&(A.valueFieldName=j.ADc))))):0===a?(p="",q=c.Mic[b],q?(p=q.fieldName,r=q.isCompactRoot,p&&(A.colHeadFieldInfo={fieldName:p,itemName:"",isRootCell:!0,isCompactRoot:r},z?A.menuArea=3:A.menuArea=2)):0===d.length&&A.value&&x.vic.Mhc.length>=1?A.menuArea=4:A.menuArea=3):(s=c.Oic,t=s[b],t&&(A.menuArea=2,v=t.isGrandTotal,w=t.isBlankColumn,w||(v&&(A.menuArea=5),o=1===k?l:B,u(o)||a-1!==o||(A.menuArea=4),g||(j=S(a,b,c,d,y,o,!1,z,f,g,i),j&&(A.activeColFieldInfo=j.activeColFieldInfo,A.colInfos=j.Cs,j.ADc&&(A.valueFieldName=j.ADc)))))),A},b.prototype.iT=function(){var a=this.vic,b=a.Lhc,c=a.Jhc,d=a.Khc,e=a.Mhc;return!(b.length>0||c.length>0||d.length>0||e.length>0)},b.prototype.Olc=function(){return this.vic.queryItem()},b.prototype.eic=function(){return this.vic.eic()},b.prototype.fjc=function(){return this.vic.Jhc},b.prototype.ejc=function(){return this.vic.Khc},b.prototype.gjc=function(){return this.vic.Lhc},b.prototype.djc=function(){return this.vic.Mhc},b.prototype.hkc=function(){return this.vic.getSigmaValuePosition().positionType},b.prototype.cic=function(){var a=this.vic;return[].concat(a.Lhc,a.Jhc,a.Khc)},b.prototype.fic=function(){var a=this.vic;return[].concat(a.Mhc)},b.prototype.getRange=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n=this;return n.iT()?{page:C,content:new d.Range(n.$jc.row,n.$jc.col,18,3)}:(a=n.$jc,b=a.row,c=a.col,e=a.rowCount,f=a.colCount,g=new d.Range(b,c,e,f),n._jc&&(h=n._jc,i=h.row,j=h.col,k=h.rowCount,l=h.colCount,m=new d.Range(i,j,k,l),m.colCount*m.rowCount)?{page:m,content:g}:{page:C,content:g})},b.prototype.clone=function(a,c,d,e){var g,h,i,j=this,k=j.qo,l=k.parent;if(!u(a)&&0!==a.trim().length&&l&&(g=l.AO.getPivotCacheByName(j.vic.Ihc)))return h=f.iua(a,l),i=l.Yjc(g.getName(),h),new b(h,c,d,e,(void 0),(void 0),(void 0),i)},b.prototype.suspendLayout=function(){this.Lia<=0&&(this.zPc=this.getRange()),this.Lia++},b.prototype.resumeLayout=function(){this.Lia--,this.refresh()},b.prototype.refresh=function(){if(this.Lia<=0){this.Lia=0,this.vic.Thc(),this.zPc=C;var a=this.qo;a&&a.cMc()&&a.repaint()}},b.prototype.paint=function(){this.ys.hZ(),this.qo.suspendPaint();var a=this.qo,b=this._jc,c=this.$jc,e=a.pivotTables.vWc;switch(a.suspendCalcService(),e||(b&&b.rowCount*b.colCount&&a.cg(b.row,b.col,b.rowCount,b.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0),c&&a.cg(c.row,c.col,c.rowCount,c.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0)),this.wic){case h.PivotTableLayoutType.outline:n.PivotTableOutlineLayout.render(this);break;case h.PivotTableLayoutType.tabular:o.PivotTableTabularLayout.render(this);break;case h.PivotTableLayoutType.compact:m.PivotTableCompactLayout.render(this)}a.resumeCalcService(!1),this.qo.resumePaint()},b.prototype.LPc=function(a,b){var c=this,d=a-c.$jc.row,e=b-c.$jc.col,f=c.ys.Uic,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=g.Xj>0&&g.OZ>0,m=a,n=b;return l&&(m=a-c._jc.row,
n=b-c._jc.col),l&&g.Xj>m?g.Gq(m,n):h.Xj>d?h.OZ>e?h.Gq(d,e):i.Gq(d,e-h.OZ):j.OZ>e?j.Gq(d-h.Xj,e):k.Gq(d-h.Xj,e-h.OZ)},b.prototype.MPc=function(a,b,c){var d=this,e=d.Zaa;e&&0!==Object.keys(e).length||(e=new l.PivotTableTheme),e.Yo(a,b,c,d)},b.prototype.HPc=function(a,b){var c,e=this,f=e.sPc,g=e.tPc,h=e.NWc,i=f[a]&&f[a][b],j=h[a]&&h[a][b],k=g[i],l=e.LPc(a,b);if(k||j||l)return c=new d.Style,u(k)||c.Yo(k),u(j)||c.Yo(j),u(l)||c.Yo(l),c},b.prototype.getStyle=function(a){var b,c,d=this,e=d.hOc;for(b=0,c=e.length;b<c;b++)if(X(a,e[b].pivotArea))return e[b].style},b.prototype.setStyle=function(a,b){var c,d=this;u(a)||(a.references&&a.references.length>0&&Y(a),c=this.getStyle(a),c&&(c=c.clone()),d.NPc(a,b),this.RVa({pivotTable:this,pivotArea:a,style:b,type:"setStyle",oldStyle:c,pivotType:0}),d.refresh())},b.prototype.NPc=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!u(a)){for(f=this,g=f.hOc,b&&(b.clone?h=b.clone():(h=new d.Style,h.fromJSON(b,!1,B))),i=0,j=g.length;i<j;i++)if(X(a,g[i].pivotArea)){if(k=g[i].style,c){u(b)||u(k)||(h.Yo(k),g[i].style=h);continue}return u(b)?g.splice(i,1):g[i].style=h,void f.DPc()}l={style:h,pivotArea:a,isFakeStyle:e},m=f.hOc.push(l)-1,c||(n=f.getPivotAreaRanges(l.pivotArea),f.OPc(n,m,h))}},b.prototype.yPc=function(a,b){var c=this,e=[],f={};d.GC$.extend(e,c.hOc),d.GC$.extend(f,c.sPc),c.hOc=a||[],c.sPc=b||{},c.RVa({type:"resetPivotStyle",areaModel:e,rangeModel:f,pivotTable:c,pivotType:0})},b.prototype.clearAll=function(){var a,b,c,d,e,f=this;for(f.suspendLayout(),a=f.getFieldsByArea(),b=a.length,c=b-1;c>=0;c--)f.remove(a[c].fieldName);for(f.yPc(),d=f.U5.zR(),e=d.length-1;e>-1;e--)f.U5.lPc(d[e].conditionalRule);f.resumeLayout()},b.prototype.getConditionalRules=function(a){return this.U5.fPc(a)},b.prototype.addConditionalRule=function(a,b){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.gPc(a,b)},b.prototype.removeConditionalRule=function(a){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.lPc(a)},b.prototype.nPc=function(a,b,c,d,e){this.U5.nPc(a,b,c,d,e)},b.prototype.oPc=function(){this.U5.oPc()},b.prototype.aPc=function(a){this.U5.aPc(a)},b.prototype.OPc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,v,w,x,y,z,A,C,D,E,F,G;if(a&&a.length>0&&c){for(e=this,f=e.sPc,g=e.tPc,h=e.NWc,i=0,j=a.length;i<j;i++)for(k=a[i],l=ba(c),m=k.row,n=k.col,o=k.rowCount,p=k.colCount,q=void 0,(l.borderLeft||l.borderRight||l.borderTop||l.borderBottom)&&(q={},fa(q,k,l)),r=l.borderLeft,t=l.borderRight,v=l.borderTop,w=l.borderBottom,l.borderLeft=B,l.borderRight=B,l.borderTop=B,l.borderBottom=B,x=0;x<o;x++)for(f[m+x]||(f[m+x]={}),q&&q[m+x]&&!h[m+x]&&(h[m+x]={}),y=0;y<p;y++)u(f[m+x][n+y])?(g[b]||(g[b]=ba(l)),f[m+x][n+y]=b,q&&q[m+x]&&q[m+x][n+y]&&(z=new d.Style,A=q[m+x][n+y],z.borderLeft=A.borderLeft?r:B,z.borderRight=A.borderRight?t:B,z.borderTop=A.borderTop?v:B,z.borderBottom=A.borderBottom?w:B,h[m+x][n+y]=z)):(C=f[m+x][n+y]+"-"+b,g[C]||(D=ba(g[f[m+x][n+y]]),D.Yo(l),g[C]=D,q&&q[m+x]&&q[m+x][n+y]&&h[m+x]&&h[m+x][n+y]&&(z=new d.Style,A=q[m+x][n+y],z.borderLeft=A.borderLeft?r:B,z.borderRight=A.borderRight?t:B,z.borderTop=A.borderTop?v:B,z.borderBottom=A.borderBottom?w:B,h[m+x][n+y].Yo(z))),f[m+x][n+y]=C);if(E=c&&c.formatter,E&&"string"==typeof E&&s(E))for(F=0;F<a.length;F++)G=a[F],e.qo.fJb(G.row||0,G.col||0,E)}},b.prototype.PPc=function(a){return!(a.labelOnly===!0&&a.dataOnly===!0||a.labelOnly===!0&&!a.references&&u(a.type)&&!a.grandRow&&!a.grandCol)},b.prototype.getPivotAreaRanges=function(a){var b,c,e;return u(a)||!this.PPc(a)?[]:(b=this,a.grandRow||a.grandCol?b.QPc(a):u(a.references)?u(a.type)?a.labelOnly!==!0?(c=b.ys.Uic,e=b.$jc,[new d.Range(c[4].nU+e.row,c[4].hF+e.col,c[3].Xj,c[2].OZ)]):[]:b.SPc(a):b.RPc(a))},b.prototype.QPc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G=this,H=G.options.grandTotalPosition,I=H===h.GrandTotalPosition.both||H===h.GrandTotalPosition.row,J=H===h.GrandTotalPosition.both||H===h.GrandTotalPosition.col;if(!I&&!J)return[];if(c=G.ys.Uic,e=c[4],f=c[3],i=c[2],j=a.references,k=a.references&&a.references.length>0,l=G.$jc,m=l.row,n=l.col,o=new d.Range(e.nU+m,e.hF+n,f.Xj,i.OZ),p=new d.Range(f.nU+m,f.hF+n,f.Xj,f.OZ),q=new d.Range(i.nU+m+1,i.hF+n,i.Xj-1,i.OZ),r=G.vic.Mhc.length,s=G.vic.getSigmaValuePosition(),t=s.positionType===g.DataPosition.row,u=s.display,v=new d.Range(o.row+o.rowCount-(u&&t?r:1),p.col,u&&t?r:1,p.colCount+o.colCount),w=new d.Range(q.row,o.col+o.colCount-(u&&!t?r:1),q.rowCount+o.rowCount,u&&!t?r:1),y=a.grandRow===!0&&I,z=a.grandCol===!0&&J,y)x=v;else{if(!z)return[];x=w}if(k&&(A={dataOnly:a.dataOnly,labelOnly:a.labelOnly,references:j},B=G.RPc(A),B&&B.length>0)){for(C=[],E=0;E<B.length;E++)y&&(B[E]=v.getIntersect(B[E],0,0)),z&&B[E]&&(B[E]=w.getIntersect(B[E],0,0)),B[E]&&C.push(B[E]);return C}if(a.grandRow===!0&&a.grandCol===!0)return I&&J?(b=v.getIntersect(w,0,0),b?[b]:[]):[];if(!k)return b=x.getIntersect(a.labelOnly&&!a.dataOnly?a.grandRow?p:q:o,0,0),b?[b]:[];if(A=D(a),A.dataOnly=!0,A.labelOnly=!1,B=G.RPc(A),B&&B.length>0){for(C=[],F=0;F<B.length;F++)b=x.getIntersect(B[F],0,0),b&&C.push(b);return C=ha(C)}return[]},b.prototype.SPc=function(a){var b,c,e,f,g,i,j,l,m,n,o,p,q,r,s,t=this,v=t.$jc,w=v.row,x=v.col,y=t.ys.Uic[2],z=y.nU,A=y.hF,B=y.OZ,C=t.ys.Uic[3],D=C.nU;if(a.type===h.PivotAreaType.corner){if(u(a.offset))return[new d.Range(w,x,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,w,x,!0)[0].ranges,c=new d.Range(w,x,D-w,A-x),e=new d.Range(w+b.row,x+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=c.getIntersect(e,0,0),!u(f))return[f]}else if(a.type===h.PivotAreaType.topRight){if(g=y.Mic.length,u(a.offset))return[new d.Range(w+z,x+A+g,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,w+z,x+A+g,!0)[0].ranges,i=new d.Range(w+z,x+A+g,1,B-g),e=new d.Range(w+z+b.row,x+A+g+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=i.getIntersect(e,0,0),!u(f))return[f]}else if(a.type===h.PivotAreaType.button&&!u(a.fieldName)){for(j=t.vic.Ohc[a.fieldName],l=void 0,m=void 0,0===j?m=t._jc:1===j?(l=t.ys.Uic[3],m={row:w+l.nU,col:x+l.hF}):2===j&&(l=t.ys.Uic[2],m={row:w+l.nU,col:x+l.hF}),n=void 0,o=[],1===j?o=t.ys.Uic[3].Oic:2===j&&(o=t.ys.Uic[2].Nic),p=0;p<o.length;p++)o[p]&&o[p].path===a.fieldName&&(n=p);if(u(n)){if(0===j)for(q=t.vic.Lhc,p=0;p<q.length;p++)if(q[p]&&q[p].Cj===a.fieldName)return r=t.options.displayFieldsInPageFilterArea,s=t.options.reportFilterFieldsPerColumn,r===h.DisplayFields.downThenOver?0===s?[new d.Range(m.row+p,m.col,1,1)]:[new d.Range(m.row+p%s,m.col+Math.floor(p/s),1,1)]:0===s?[new d.Range(m.row,m.col+3*p,1,1)]:[new d.Range(m.row+Math.floor(p/s),m.col+p%s,1,1)];return[]}if(1===j)return[new d.Range(m.row-1,m.col+ +n,1,1)];if(2===j)return[new d.Range(m.row,m.col+ +n-1,1,1)]}return[]},b.prototype.RPc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A,C,D,E,G,H,I,J,K,L,M,N,O=this,P=O.ys.Uic[4],Q=O.$jc.row,R=O.$jc.col,S=P.nU,T=P.hF,U=O.ys.Uic[3].Xj,V=O.ys.Uic[2].OZ,W=O.vic.Ohc,X=O.options.subTotalsPosition,Y=O.vic.Mhc.length,Z=[],$=1===a.references.length,_={};for(c=0,e=a.references.length;c<e;c++)f=a.references[c],i=f.fieldName,_[i]=f;for(j=!1,k=O.vic.Jhc,l=O.vic.Khc,c=k.length-1;c>=0;c--)_[k[c].Cj]&&(j===!1?j=!0:_[k[c].Cj].TPc=!0);for(j=!1,c=l.length-1;c>=0;c--)_[l[c].Cj]&&(j===!1?j=!0:_[l[c].Cj].TPc=!0);for(c=0,e=a.references.length;c<e;c++){if(f=a.references[c],i=f.fieldName,m=f.items,n=a.labelOnly,o=a.dataOnly,p=f.subtotal,q=[],i===F().Values&&Y>1)b=O.vic.getSigmaValuePosition().positionType===g.DataPosition.row?1:2;else{if(i===F().Values&&1===Y&&(u(m)||1===m.length&&m[0]===O.vic.Mhc[0].Cj)){q=[new d.Range(Q+S,R+T,U,V)],Z.push(q);continue}b=W[i]}if(r=void 0,s=void 0,1===b)s=O.ys.Uic[3];else if(2===b)s=O.ys.Uic[2];else{if(0!==b){Z.push([]);continue}if(s=O.ys.Uic[0],u(m)&&a.labelOnly){for(t=O.vic.Lhc,v=0;v<t.length;v++)if(t[v]&&t[v].Cj===i){if(w=O.options.displayFieldsInPageFilterArea,x=O.options.reportFilterFieldsPerColumn,w===h.DisplayFields.downThenOver){if(0===x){q=[new d.Range(O._jc.row+v,O._jc.col,1,1)];break}q=[new d.Range(O._jc.row+v%x,O._jc.col+Math.floor(v/x)+1,1,1)];break}if(0===x){q=[new d.Range(O._jc.row,O._jc.col+3*v,1,1)];break}q=[new d.Range(O._jc.row+Math.floor(v/x),O._jc.col+v%x+1,1,1)];break}Z.push(q);continue}}if(r=s&&s._Nc){if(o===!1&&u(n)?(o=!0,n=!0):(o===!1&&n===!1||o===B&&n===B)&&(o=!0),u(m))if(E=O.vic.getFieldInfoByName(i),G=E&&E._items,G&&G.length>0){for(y=O.vic.Mhc,z={},v=0;v<Y;v++)z[y[v].Cj]=v;for(v=0;v<G.length;v++)G[v]&&!u(G[v].value)&&(C=G[v].value,D=r[i]&&r[i][C],u(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===F().Values,C,z[C],f.TPc))))}else{H=r[i],I=0;for(J in H)H.hasOwnProperty(J)&&(D=r[i]&&r[i][J],u(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===F().Values,J,I,f.TPc))))}else{for(y=O.vic.Mhc,z={},v=0;v<Y;v++)z[y[v].Cj]=v;for(v=0,A=m.length;v<A;v++)C=m[v],D=r[i]&&r[i][C],u(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===F().Values,m[v],z[m[v]],f.TPc)))}Z.push(q)}}if($)return Z[0];for(K=Z[0],c=1;c<Z.length;c++){for(L=[],v=0;v<K.length;v++)for(M=0;M<Z[c].length;M++)N=K[v]&&Z[c][M]&&K[v].getIntersect(Z[c][M]),N&&L.push(N);K=L}return K=ha(K)},b.prototype.UPc=function(a,b,c,d,e,f,i,j,k,l,m,n,o,p,q,r,s){var t,u,v,w,x,y,z=this,A=[],B=a.ranges,C=a.level,D=n===h.SubtotalsPosition.top||n===h.SubtotalsPosition.bottom;return B&&(t=_(B),u=void 0,v=void 0,w=z.vic.getSigmaValuePosition(),1===b?(x=z.vic.Jhc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.row&&x+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.row&&x-w.positionIndex<C?z.vic.Mhc.length:1,z.VPc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r,s)):2===b&&(y=z.vic.Khc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.col&&y+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.col&&y-w.positionIndex<C?z.vic.Mhc.length:1,z.WPc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r))),A},b.prototype.VPc=function(a,b,c,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t){var v,w,x,y,z,A,B,C=this,D=C.layoutType();for(v=0,w=b.length;v<w;v++)u(b[v])||(!j||l&&!q||(x=new d.Range(0,0,0,0),x.row=e+b[v].start,x.col=D===h.PivotTableLayoutType.compact?f-1:f-c,x.rowCount=D===h.PivotTableLayoutType.tabular||t?b[v].end-b[v].start+1:1,x.colCount=D===h.PivotTableLayoutType.outline?c:n?1:c,a.push(x)),!k||l&&!q||(y=new d.Range(0,0,0,0),y.row=e+b[v].start,y.col=f,y.rowCount=q||t?b[v].end-b[v].start+1:1,y.colCount=i,a.push(y)),o&&l&&!q&&(z=m===h.SubtotalsPosition.top&&this.layoutType()!==h.PivotTableLayoutType.tabular?e+b[v].end-1:e+b[v].end+1,j?(x=new d.Range(0,0,0,0),x.row=z,x.col=f-c,x.rowCount=p,x.colCount=n?1:c,a.push(x)):(y=new d.Range(0,0,0,0),y.row=z,y.col=f,y.rowCount=p,y.colCount=i,a.push(y))));k&&q&&(A=this.vic.Mhc.length,B=new d.Range(0,0,0,0),B.row=e+g-(A-s),B.col=f,B.rowCount=1,B.colCount=i,a.push(B))},b.prototype.WPc=function(a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,v,w,x,y;for(s=0,t=b.length;s<t;s++)u(b[s])||(!i||k&&!p||(v=new d.Range(0,0,0,0),v.row=e-c,v.col=f+b[s].start,v.rowCount=m?1:c,v.colCount=b[s].end-b[s].start+1,a.push(v)),!j||k&&!p||(w=new d.Range(0,0,0,0),w.row=e,w.col=f+b[s].start,w.rowCount=g,w.colCount=b[s].end-b[s].start+1,a.push(w)),n&&k&&!p&&(i?(v=new d.Range(0,0,0,0),v.row=e-c,v.col=f+b[s].end+1,v.rowCount=m?1:c,v.colCount=o,a.push(v)):(w=new d.Range(0,0,0,0),w.row=e,w.col=f+b[s].end+1,w.rowCount=g,w.colCount=o,a.push(w))));j&&p&&(x=this.vic.Mhc.length,y=new d.Range(0,0,0,0),y.row=e,y.col=f+h-(x-r),y.rowCount=g,y.colCount=1,a.push(y))},b.prototype.CPc=function(){var a=this,b=a.tOc,c=a.qo;c.suspendPaint(),a.XPc(),a.options.mergeItem&&(a.YPc(),a.ZPc()),c.resumePaint(),b.sOc=[],b.uOc=[]},b.prototype.XPc=function(){var a=this,b=a.tOc,c=a.qo,d=b.qPc,e=b.pPc;0===e.length&&0===d.length||(g.vhc(e,function(a){c.removeSpan(a.row,a.col)}),g.vhc(d,function(a){c.removeSpan(a.row,a.col)}),g.vhc(a.rPc,function(a){c.getRange(a.row,a.col,a.rowCount,a.colCount).vAlign(a.vAlign).hAlign(a.hAlign)}),b.qPc=[],b.pPc=[],a.rPc=[])},b.prototype.ZPc=function(){var a,b,c,d,e,f,h,i,j,k,l,m=this,n=m.qo,o=m.ys.Uic[3],p=m.ys.Uic[2],q=m.tOc;(!o||o.OZ<2)&&(!p||p.Xj<3)||(a=m.$jc,b=a.row,c=a.col,d=o.nU,e=o.hF,f=p.nU,h=p.hF,i=q.uOc,j=q.sOc,k=q.qPc,l=q.pPc,g.vhc(j,function(a){var f=a.row,g=a.col,h=a.rowCount,i=a.colCount;f+=d+b,g+=e+c,n.Sq(f,g,h,i),k.push({row:f,col:g,rowCount:h,colCount:i})}),g.vhc(i,function(a){var d=a.row,e=a.col,g=a.rowCount,i=a.colCount;d+=f+b,e+=h+c,n.Sq(d,e,g,i),l.push({row:d,col:e,rowCount:g,colCount:i})}))},b.prototype.YPc=function(){var a=this,b=a.qo,c=a.rPc,d=a.ys.Uic[3].getRange(),e=a.ys.Uic[2].getRange(),f=a.ys.Uic[1].getRange(),g=a.$jc,i=g.row,j=g.col;a.layoutType()!==h.PivotTableLayoutType.compact&&c.push(a.$Pc(b.getRange(d.row+i,d.col+j,d.rowCount,d.colCount))),c.push(a.$Pc(b.getRange(e.row+i,e.col+j,e.rowCount,e.colCount))),c.push(a.$Pc(b.getRange(f.row+i,f.col+j,f.rowCount,f.colCount)))},b.prototype.$Pc=function(a){var b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount,vAlign:a.vAlign(),hAlign:a.hAlign()};return a.hAlign(1).vAlign(1),b},b.prototype.$Sb=function(a){var b=this.vic;return b.getFieldInfoByName(a)},b.prototype.fromJson=function(a,b){var c,e,f,g,i,j,k,m,n,o,p,q,r,s,t,v,w,x,y,z,A=this;if(A._Pc(a),u(a.multipleFieldFilters)?A.options.allowMultipleFiltersPerField=!0:A.options.allowMultipleFiltersPerField=a.multipleFieldFilters,u(a.styleName)||(c=K[a.styleName.toUpperCase()],c?(e=a.styleName.replace("PivotStyle","").toLowerCase(),A.theme(e)):(f=a.style,g=new l.PivotTableTheme,g.fromJSON(f),A.theme(g))),a.rowGrandTotals===!1&&a.colGrandTotals===!1?A.options.grandTotalPosition=h.GrandTotalPosition.none:a.rowGrandTotals===!1?A.options.grandTotalPosition=h.GrandTotalPosition.row:a.colGrandTotals===!1?A.options.grandTotalPosition=h.GrandTotalPosition.col:A.options.grandTotalPosition=h.GrandTotalPosition.both,u(a.showRowHeaders)||(A.options.showRowHeader=a.showRowHeaders),u(a.showColHeaders)||(A.options.showColumnHeader=a.showColHeaders),u(a.showRowStripes)||(A.options.bandRows=a.showRowStripes),u(a.showColStripes)||(A.options.bandColumns=a.showColStripes),u(a.pageOverThenDown)||(A.options.displayFieldsInPageFilterArea=a.pageOverThenDown?h.DisplayFields.overThenDown:h.DisplayFields.downThenOver),u(a.pageWrap)||(A.options.reportFilterFieldsPerColumn=a.pageWrap),u(a.showFilter)||(A.options.showFilter=a.showFilter),u(a.showDrill)||(A.options.showDrill=a.showDrill),u(a.showToolTip)||(A.options.showToolTip=a.showToolTip),u(a.showMissing)||(A.options.showMissing=a.showMissing),u(a.missingCaption)||(A.options.missingCaption=a.missingCaption),u(a.indent)?A.options.rowLabelIndent=2:A.options.rowLabelIndent=a.indent+1,u(a.errorCaption)||(A.options.errorValueInfo=a.errorCaption),u(a.showError)||(A.options.isShowErrorValue=a.showError),u(a.showDataTips)||(A.options.showToolTip=a.showDataTips),u(a.showHeaders)||(A.options.showFilter=a.showHeaders),u(a.mergeItem)||(A.options.mergeItem=a.mergeItem),u(a.dataCaption)||(A.dataCaption=a.dataCaption),u(a.fillDownLabels)||(A.options.fillDownLabels=a.fillDownLabels),u(a.printDrill)||(A.options.printDrill=a.printDrill),u(a.itemPrintTitles)||(A.options.itemPrintTitles=a.itemPrintTitles),u(a.fieldPrintTitles)||(A.options.fieldPrintTitles=a.fieldPrintTitles),u(a.rowHeaderCaption)||(A.options.rowHeaderCaption=a.rowHeaderCaption),u(a.colHeaderCaption)||(A.options.colHeaderCaption=a.colHeaderCaption),!u(a.formats))for(i=0;i<a.formats.length;i++)j=a.formats[i],k=A.excelPivotAreaToSheetPivotArea(j.pivotArea),m=new d.Style,m.fromJSON(j.style,!1,B),A.NPc(k,m,!0);if(n=A.qo,o=n.conditionalFormats,!u(a.pivotTableConditionFormats)&&o){for(p=[],q=[],i=0;i<a.pivotTableConditionFormats.length;i++)a.pivotTableConditionFormats[i]&&a.pivotTableConditionFormats[i].rule&&(p[a.pivotTableConditionFormats[i].rule.priority-1]=a.pivotTableConditionFormats[i]);for(i=p.length-1;i>=0;i--)p[i]&&q.push(p[i]);for(a.pivotTableConditionFormats=q,i=0;i<a.pivotTableConditionFormats.length;i++){for(r=a.pivotTableConditionFormats[i],s=[],t=0;t<r.pivotAreas.length;t++)s.push(A.excelPivotAreaToSheetPivotArea(r.pivotAreas[t]));r.rule&&(v=void 0,r.rule.ruleType?v=o.iga(r.rule,n,!1):r.rule.priority&&b.conditionalFormats&&b.conditionalFormats.rules&&(v=o.iga(b.conditionalFormats.rules[r.rule.priority-1],n,!1)),A.U5.gPc(s,v,!0))}}if(u(a.views)||A.views.fromJson(a.views),u(a.altText)||(A.uPc=a.altText),u(a.altTextSummary)||(A.vPc=a.altTextSummary),a.dataFields&&a.dataFields.length>0)for(w=a.dataFields,x=0,y=w;x<y.length;x++)z=y[x],u(z.showDataAs)||(A.xPc=!0)},b.prototype._Pc=function(a){var b,c,e,f,g,h,i,j=this,k=a.fields;for(b=0,c=k.length;b<c;b++)e=k[b],u(e.numberFormat)||(f={labelOnly:!0,references:[{fieldName:e.name}]},g=new d.Style,g.formatter=e.numberFormat,j.NPc(f,g,!0,!0));if(h=a.dataFields,h&&h.length>0)if(i=h.length,1!==i||u(h[0].numberFormat))for(b=0;b<i;b++)e=h[b],u(e.numberFormat)||(f={dataOnly:!0,references:[{fieldName:F().Values,items:[e.name]}]},g=new d.Style,g.formatter=e.numberFormat,j.NPc(f,g,!0,!0));else f={dataOnly:!0},g=new d.Style,g.formatter=h[0].numberFormat,j.NPc(f,g,!0,!0)},b.prototype.excelPivotAreaToSheetPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l=this,m=l.vic.HL,n={};if(u(a.labelOnly)||(n.labelOnly=a.labelOnly),u(a.dataOnly)||(n.dataOnly=a.dataOnly),u(a.grandCol)||(n.grandCol=a.grandCol),u(a.grandRow)||(n.grandRow=a.grandRow),"axisRow"===a.axis?n.axis=h.PivotAreaAxisType.row:"axisCol"===a.axis&&(n.axis=h.PivotAreaAxisType.col),!u(a.references)&&a.references.length>0){for(n.references=[],b=0;b<a.references.length;b++)if(c=a.references[b],d={},e=c.field===J||c.field===+J?{Cj:F().Values,_items:[]}:m[c.field],e){if(f=e.Cj,c.indexes){for(g=[],i=0,j=c.indexes.length;i<j;i++)k=c.indexes[i],u(k)||g.push(f===F().Values?l.vic.Mhc[k].Cj:e._items[k]&&e._items[k].value);g.length>0&&(d.items=g)}d.fieldName=f,u(c.defaultSubtotal)||(d.subtotal=c.defaultSubtotal),n.references.push(d)}}else u(a.type)||(n.type=Z(a.type),n.fieldName=m&&m[a.field]&&m[a.field].Cj,n.offset=a.offset);return n},b.prototype.toJson=function(a){var b,c,d,e,f,i,j,m,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,G,H,I,J,K,L,M,N,O=this,P=O.vic,Q=P&&P.Lqa?P.Lqa:{},R=O.layoutType();switch(R){case h.PivotTableLayoutType.outline:Q.compact=!1,Q.compactData=!1,Q.outline=!0,Q.outlineData=!0;break;case h.PivotTableLayoutType.tabular:Q.compact=!1,Q.compactData=!1,Q.outline=!1,Q.outlineData=!1;break;default:Q.outline=!0,Q.outlineData=!0}if(u(O.Cj)||(Q.name=O.Cj),u(O.options.allowMultipleFiltersPerField)||(Q.multipleFieldFilters=O.options.allowMultipleFiltersPerField),b=P.getSigmaValuePosition(),b.display&&b.positionType===g.DataPosition.row&&(Q.dataOnRows=!0),c=O.theme()&&O.theme().name(),u(c)||(d=l.PivotTableThemes[c.toLowerCase()],d?(c=c.replace(/^[a-z]{1}/g,function(a){return a.toUpperCase()}),Q.styleName="PivotStyle"+c):Q.styleName=c),u(O.options.showRowHeader)||(Q.showRowHeaders=O.options.showRowHeader),u(O.options.showColumnHeader)||(Q.showColHeaders=O.options.showColumnHeader),u(O.options.bandRows)||(Q.showRowStripes=O.options.bandRows),u(O.options.bandColumns)||(Q.showColStripes=O.options.bandColumns),u(O.options.displayFieldsInPageFilterArea)||(Q.pageOverThenDown=O.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown),u(O.options.reportFilterFieldsPerColumn)||(Q.pageWrap=O.options.reportFilterFieldsPerColumn),u(O.options.showFilter)||(Q.showFilter=O.options.showFilter),u(O.options.showDrill)||(Q.showDrill=O.options.showDrill),u(O.options.showMissing)||(Q.showMissing=O.options.showMissing),u(O.options.showToolTip)||(Q.showToolTip=O.options.showToolTip),u(O.options.missingCaption)||(Q.missingCaption=O.options.missingCaption),u(O.options.fillDownLabels)||(Q.fillDownLabels=O.options.fillDownLabels),u(O.options.rowLabelIndent)||2===O.options.rowLabelIndent||(Q.indent=O.options.rowLabelIndent-1),u(O.options.printDrill)||(Q.printDrill=O.options.printDrill),u(O.options.itemPrintTitles)||(Q.itemPrintTitles=O.options.itemPrintTitles),u(O.options.fieldPrintTitles)||(Q.fieldPrintTitles=O.options.fieldPrintTitles),u(O.options.mergeItem)||(Q.mergeItem=O.options.mergeItem),u(O.options.grandTotalPosition)||(e=O.options.grandTotalPosition,e!==h.GrandTotalPosition.none&&e!==h.GrandTotalPosition.col||(Q.colGrandTotals=!1),e!==h.GrandTotalPosition.none&&e!==h.GrandTotalPosition.row||(Q.rowGrandTotals=!1)),u(O.dataCaption)?Q.dataCaption="Values":Q.dataCaption=O.dataCaption,u(O.options.errorValueInfo)||(Q.errorCaption=O.options.errorValueInfo),u(O.options.isShowErrorValue)||(Q.showError=O.options.isShowErrorValue),u(O.options.showToolTip)||(Q.showDataTips=O.options.showToolTip),u(O.options.showFilter)||(Q.showHeaders=O.options.showFilter),u(O.options.rowHeaderCaption)||(Q.rowHeaderCaption=O.options.rowHeaderCaption),u(O.options.colHeaderCaption)||(Q.colHeaderCaption=O.options.colHeaderCaption),u(O.views)||(Q.views=O.views.toJson()),u(O.uPc)||(Q.altText=O.uPc),u(O.vPc)||(Q.altTextSummary=O.vPc),u(Q.createdVersion)&&(Q.createdVersion=6),f=O.ys&&O.ys.Uic&&O.ys.Uic&&O.ys.Uic[4]&&O.ys.Uic[4].nU||0,i=O.ys&&O.ys.Uic&&O.ys.Uic&&O.ys.Uic[4]&&O.ys.Uic[4].hF||0,O.djc()&&O.djc().length>0||O.fjc()&&O.fjc().length>0||O.ejc()&&O.ejc().length>0?Q.firstHeaderRow=1:Q.firstHeaderRow=0,Q.firstDataRow=f,Q.firstDataCol=i,j=O.vic.Lhc&&O.vic.Lhc.length,m=!u(O.options.reportFilterFieldsPerColumn),O.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown?0===O.options.reportFilterFieldsPerColumn?(Q.rowPageCount=1,Q.colPageCount=j):(Q.rowPageCount=m?Math.ceil(j/O.options.reportFilterFieldsPerColumn):1,Q.colPageCount=m?Math.min(O.options.reportFilterFieldsPerColumn,j):j):0===O.options.reportFilterFieldsPerColumn?(Q.rowPageCount=j,Q.colPageCount=1):(Q.rowPageCount=j?Math.min(O.options.reportFilterFieldsPerColumn,j):j,Q.colPageCount=j?Math.ceil(j/O.options.reportFilterFieldsPerColumn):1),n=O.getRange().content,Q.ref=k.rangesToFormula([n],0,0,15,!1),P.qDc(),O.hOc&&O.hOc.length>0){for(Q.formats=[],o=0;o<O.hOc.length;o++)if(p=O.hOc[o],q=p.pivotArea,r=p.style,!ea(r)&&!p.isFakeStyle&&(Q.formats.push({style:r,pivotArea:O.sheetPivotAreaToExcelPivotArea(q)}),q.references&&1===q.references.length&&p.style&&!u(p.style.formatter)))if(s=O.vic,q.references[0].fieldName===F().Values){for(t=s.Mhc,v=t.length,w={},x=0;x<v;x++)w[t[x].Cj]=x;if(y=q.references[0].items,!y)for(y=[],z=0;z<v;z++)y.push(t[z].Cj);for(z=0;z<y.length;z++)u(w[y[z]])||(t[w[y[z]]].nNc=p.style.formatter)}else!q.labelOnly||q.dataOnly||q.references[0].items&&0!==q.references[0].items.length||(A=s.HNc(q.fieldName),A&&(A.nNc=p.style.formatter));B=a.data.dataTable,C=O.sPc,D=O.NWc;for(E in C)if(C.hasOwnProperty(E)){G=C[E];for(H in G)G.hasOwnProperty(H)&&(u(B[E])&&(B[E]={}),u(B[E][H])&&(B[E][H]={}),r=ba(O.tPc[G[H]]),I=D[E]&&D[E][H],I&&r.Yo(I),B[E][H].style&&r.Yo(B[E][H].style),B[E][H].style=r)}}if(O.U5.AW&&O.U5.AW.length>0)for(Q.pivotTableConditionFormats=[],o=0;o<O.U5.AW.length;o++){for(J=O.U5.AW[o],K=J.pivotAreas,L=[],z=0;z<K.length;z++)L.push(O.sheetPivotAreaToExcelPivotArea(K[z]));M=da(J.conditionalRule,J.conditionalRule.toJSON(O.qo)),N={rule:M,pivotAreas:L},Q.pivotTableConditionFormats.push(N)}return P.toJson(O,Q),Q.rowItems=O.ikc(!0),Q.columnItems=O.ikc(!1),Q},b.prototype.sheetPivotAreaToExcelPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s=this,t={},v=s.vic;if(t.type=$(a.type),t.offset=a.offset,b=v.HNc(a.fieldName))for(t.field=b.mi,c=s.vic.Ohc[a.fieldName],d=[],0===c?(t.axis="axisPage",d=s.vic.Lhc):1===c?(t.axis="axisRow",d=s.vic.Jhc):2===c&&(t.axis="axisCol",d=s.vic.Khc),e=0;e<d.length;e++)d[e]&&d[e].Cj===a.fieldName&&(t.fieldPosition=e);if(t.dataOnly=a.dataOnly,t.labelOnly=a.labelOnly,a.labelOnly===!0&&t.dataOnly===B&&(t.dataOnly=!1),a.labelOnly===!0&&t.dataOnly===!0&&(t.dataOnly=!1,t.labelOnly=!1),t.grandRow=a.grandRow,t.grandCol=a.grandCol,u(a.axis)||(t.axis=a.axis===h.PivotAreaAxisType.row?"axisRow":"axisCol"),a.references&&a.references.length>0){for(f=[],g=0;g<a.references.length;g++){if(i={},j=a.references[g],k=void 0,j.fieldName===F().Values){for(i.field=J,l=v.Mhc,m=l.length,n={},o=0;o<m;o++)n[l[o].Cj]=o;if(j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)p.push(n[j.items[o]]);i.indexes=p}}else{if(k=v.HNc(j.fieldName),u(k))continue;if(q=k.LWc(v),i.field=k.mi,j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)r=k.KWc(j.items[o],q),u(r)||p.push(r);i.indexes=p}}i.defaultSubtotal=j.subtotal,f.push(i)}f.length>0&&(t.references=f)}return t},b.prototype.ikc=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p=this;if(p.iT())return[];if(b=p.ys.Uic,c=a?b[3].Nic:b[2].Oic,d=[],e=[],f=p.vic,i=p.layoutType()===h.PivotTableLayoutType.tabular,j=p.options.subtotalsPosition===h.SubtotalsPosition.top,a&&0===f.Jhc.length||!a&&0===f.Khc.length){for(k=0;k<c.length;k++)l={pivotItemIndexes:[]},l.pivotItemIndexes.push(k),d.push(l);return d}for(k=0;k<c.length;k++)if(l={},m=c[k],!u(m)){for(n=m.path.split(g.Separator),l.pivotItemIndexes=[],o=0;o<n.length;o++)n[o]===e[o]?l.repeatCount=l.repeatCount?l.repeatCount+1:1:l.pivotItemIndexes.push(+n[o]);e=n,0===m.grandTotalLevel?l.type="grand":a&&m.isBlankRow?(l.type="blank",delete l.repeatCount):!m.isSubtotal||0===m.collapseIndex||j&&!i||(l.type="default"),m.valueFieldName&&(l.dataFieldIndex=f.tic(m.valueFieldName)),d.push(l)}return d},b.prototype.evaluateGetPivotDataFunction=function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,r,s,t,v,w,x,y,z,A,C,D,E,F=this,G=[],H=F.vic.hic,I=H._Fc,J=F.kOc,K=F.vic.getSigmaValuePosition().positionType,L=F.vic.Jhc.length,M=F.vic.Mhc.length;for(c=0;c<b.length;c++){if(d=b[c],e=b[c+1],c++,h=I[d],u(h))return q.Errors.Reference;if(i=void 0,J[d]){if(e instanceof Date&&(e=f.formatDateToString(e)),i=J[d].indexOf(e),i<0)return q.Errors.Reference}else{if(0!==F.vic.RFc(d))return q.Errors.Reference;i=e}G[h]=i}for(j=G.slice(0,L),j=j.filter(function(a){return a!==B}),k=j.join(g.Separator),l=G.slice(L),l=l.filter(function(a){return a!==B}),m=l.join(g.Separator),n={},o={},p=F.ys.Uic[3].Nic,r=F.ys.Uic[2].Oic,s=F.ys.Uic[4].dataTable,c=0;c<p.length;c++)t=p[c],v=t.path,w=t.valueFieldName,0===K&&M>1?(u(n[v])&&(n[v]={}),n[v][w]=c):n[v]=c;for(c=0;c<r.length;c++)x=r[c],v=x.path,y=x.valueFieldName,1===K&&M>1?(u(o[v])&&(o[v]={}),o[v][y]=c):o[v]=c;if(F.vic.Mhc.length>0&&(z=F.vic.pDc(a),A=F.vic.getFieldInfoByName(a),a=z&&z.Cj||A&&A.Cj),u(a))return q.Errors.Reference;if(C=n[k]instanceof Object?n[k][a]:n[k],D=o[m]instanceof Object?o[m][a]:o[m],u(C)||u(D))return q.Errors.Reference;try{E=s[C][D],F.options.showMissing&&u(E)&&(E={value:F.options.missingCaption})}catch(a){return q.Errors.Reference}return E&&E.value},b.prototype.DPc=function(){var a,b,c=this,d=c.hOc.concat([]);for(c.sPc={},c.NWc=[],c.hOc=[],c.tPc={},a=0,b=d.length;a<b;a++)c.NPc(d[a].pivotArea,d[a].style,B,d[a].isFakeStyle)},b.prototype.aQc=function(){var a=this,b=a.getFieldsByArea();g.vhc(b,function(b){var c,d,e=a.$Sb(b.fieldName);e.isFilter()&&(c=0,d=e.getFilterInfo(),d.labelFilter.condition&&(c+=1),d.labelFilter.textItem&&(c+=1),d.valueFilter&&(c+=1),c>1&&a.vic.clearFilterInfo(b.fieldName,0))})},b.prototype.dispose=function(){a.prototype.dispose.call(this);var b=this;b.qo=C,b.ys=C,b.hOc=C,b.NWc=C,b.sPc=C,b.tPc=C,b.options=C,b.$jc=C,b._jc=C,b.oNb=C,b.pNb=C,b.kOc=C,b.tOc=C,b.rPc=C,b.Zaa=C,b.zPc=C,u(b.U5)||(b.U5.no(),b.U5=C),u(b.views)||(b.views.no(),b.views=C)},b}(i.PivotView),b.PivotTable=N},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR),i=h.getResource.bind(h),j="gc-drop-down-list",k=j+"-link-hover",l=j+"-item-noHover",m=j+"-block",n=j+"-item",o=j+"-icon",p=j+"-link",q=n+" "+l,r=j+"-span",s=n+" "+k,t="icon-Move-Report",u="icon-Move-Row",v="icon-Move-Col",w="icon-Move-Value",x="icon-Move-Remove",y="icon-Move-Setting",z="icon-Be-Used",A="clear-filter-icon-default",B="clear-filter-icon",C="label-of-string",D="valueFilter",E="label-of-number",F="label-of-date",G="all-date",H=null,I=void 0,J={dropDownListOfField:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Up,command:"moveUp",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Down,command:"moveDown",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_End,command:"moveEnd",class:s,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_DropDownList_Row,command:"moveRow",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_DropDownList_Col,command:"moveCol",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_DropDownList_Values,command:"moveValue",class:s,iconClass:o+" "+w,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Remove,command:"removeField",class:s,iconClass:o+" "+x,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Set,command:"fieldSet",class:s,iconClass:o+" "+y,linkClass:p}]}]},pivotCacheFieldsData:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:s,iconClass:o+" "+w,linkClass:p}]}]},dataOfString:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+C,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,
command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+C,iconClass:o,linkClass:p}]}]},dataOfDate:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+F,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotDateFilterOperator.equalsTo,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Before,command:g.PivotDateFilterOperator.before,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_After,command:g.PivotDateFilterOperator.after,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotDateFilterOperator.Between,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Tomorrow,command:g.PivotDateFilterOperator.tomorrow,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Today,command:g.PivotDateFilterOperator.today,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Yesterday,command:g.PivotDateFilterOperator.yesterday,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextWeek,command:g.PivotDateFilterOperator.nextWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisWeek,command:g.PivotDateFilterOperator.thisWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastWeek,command:g.PivotDateFilterOperator.lastWeek,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextMonth,command:g.PivotDateFilterOperator.nextMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisMonth,command:g.PivotDateFilterOperator.thisMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastMonth,command:g.PivotDateFilterOperator.lastMonth,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextQuarter,command:g.PivotDateFilterOperator.nextQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:g.PivotDateFilterOperator.thisQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastQuarter,command:g.PivotDateFilterOperator.lastQuarter,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextYear,command:g.PivotDateFilterOperator.nextYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisYear,command:g.PivotDateFilterOperator.thisYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastYear,command:g.PivotDateFilterOperator.lastYear,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_YearToDate,command:g.PivotDateFilterOperator.yearToDate,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:s+" "+G,iconClass:o,linkClass:p}]}]},dataOfNumber:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+E,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+E,iconClass:o,linkClass:p}]}]},dataOfValueFilter:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+D,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotValueFilterOperator.equalsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotValueFilterOperator.notEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotValueFilterOperator.greaterThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotValueFilterOperator.greaterThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotValueFilterOperator.lessThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotValueFilterOperator.lessThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotValueFilterOperator.between,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotValueFilterOperator.notBetween,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilter_Top10,command:"Top10",class:s+" "+D,iconClass:o,linkClass:p}]}]},dataOfDateSecondary:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().Q1,command:g.PivotDateFilterOperator.Q1,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Q2,command:g.PivotDateFilterOperator.Q2,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Q3,command:g.PivotDateFilterOperator.Q3,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Q4,command:g.PivotDateFilterOperator.Q4,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().Jan,command:g.PivotDateFilterOperator.M1,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Feb,command:g.PivotDateFilterOperator.M2,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Mar,command:g.PivotDateFilterOperator.M3,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Apr,command:g.PivotDateFilterOperator.M4,class:s+" "+F,iconClass:o,linkClass:p},{text:i().May,command:g.PivotDateFilterOperator.M5,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Jun,command:g.PivotDateFilterOperator.M6,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Jul,command:g.PivotDateFilterOperator.M7,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Aug,command:g.PivotDateFilterOperator.M8,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Sep,command:g.PivotDateFilterOperator.M9,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Oct,command:g.PivotDateFilterOperator.M10,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Nov,command:g.PivotDateFilterOperator.M11,class:s+" "+F,iconClass:o,linkClass:p},{text:i().Dec,command:g.PivotDateFilterOperator.M12,class:s+" "+F,iconClass:o,linkClass:p}]}]}},function(a){a[a.teamLeader=1]="teamLeader",a[a.teamMiddle=2]="teamMiddle",a[a.teamTail=3]="teamTail"}(K||(K={})),function(a){a[a.filters=0]="filters",a[a.rows=1]="rows",a[a.columns=2]="columns",a[a.values=3]="values"}(L||(L={})),function(a){a[a.string=1]="string",a[a.number=2]="number",a[a.date=3]="date"}(M||(M={})),N=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,0)||this;return i.vic=c,i._ic=d,i.$ic=e,i.kkc=f,i.lkc=g,i.GZ=h,i}return b.prototype.OT=function(a,b){var c,d=this;d.SH=a,d.i6=b,c=d.Sla(a.x,a.y),c.html(this.mkc(this.OY(b))),this.Ao()},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.UDc(),this.QQ()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top","height"],[a,b,this.nkc]),c.addClass(j+" gc-no-user-select"),c},b.prototype.UDc=function(){var a,b,c,d=this,e=this.xo;f.GC$(d.qo).hasClass("filter-condition")&&(a=d.GZ,b=f.GC$(d.qo).position(),c=f.GC$(e).width(),f.GC$(d.qo).width()+a.SH.x+c>=document.body.scrollWidth?d.SH.x=-c:d.SH.x=f.GC$(d.qo).width(),d.SH.y=b.top,d.Sla(d.SH.x,d.SH.y))},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this._ic=I,this.$ic=I,this.kkc=I,this.lkc=I,this.GZ=H,this.qo=H,this.vic=H},b}(f.Go),O=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.bQc=h,i.nkc="244px",i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=W(a[b]);return c},b.prototype.OY=function(a){return this.xf=f.GC$.extend(!0,[],J.dropDownListOfField()),this.initSeatData(a,this.xf[0].child),this.initAreaData(a,this.xf[1].child),this.initSettingData(a,this.xf[3].child),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+n).bind("click",function(b){f.GC$(this).hasClass(l)||(a.Eo(),a.sendCommand(this),a.close())})},b.prototype.Tla=function(){f.GC$("."+n).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.kkc,d=b.lkc,e=b.vic,g=f.GC$(a).attr("command");switch(g){case"moveUp":g="moveField",d--;break;case"moveDown":g="moveField",d++;break;case"moveBeginning":g="moveField",d=0;break;case"moveEnd":g="moveField",d=Y(c,e)+1;break;case"moveReportFilter":g="moveField",c=0,d=Y(c,e);break;case"moveRow":g="moveField",c=1,d=Y(c,e);break;case"moveCol":g="moveField",c=2,d=Y(c,e);break;case"moveValue":g="moveField",c=3,d=Y(c,e);break;case"removeField":break;case"fieldSet":}b.vic.nic({cmd:g,sheetName:"",cmdOption:{fieldName:b.$ic,targetArea:c,targetIndex:d,pivotName:b._ic,isSusPaint:b.bQc}})},b.prototype.initSeatData=function(a,b){if(a.isAlone)for(var c=0;c<b.length;c++)b[c].class=q;else{if(a.location===K.teamMiddle)return;a.location===K.teamLeader?(b[0].class=q,b[2].class=q):(b[1].class=q,b[3].class=q)}},b.prototype.initAreaData=function(a,b){switch(a.area){case 0:b[0].class=q;break;case 1:b[1].class=q;break;case 2:b[2].class=q;break;case 3:b[3].class=q}a.isSigma&&(b[0].class=q,b[3].class=q)},b.prototype.initSettingData=function(a,b){3===a.area&&(b[0].text=i().PivotPanel_DropDownList_ValueSet,b[0].command="openValueFieldSettingDialogCmd",b[0].class=s),a.isSigma&&(b[0].class=q)},b}(N),b.PivotDropDown=O,P=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.nkc="95px",i.bQc=h,i}return b.prototype.mkc=function(a){return W(a[0])},b.prototype.OY=function(){return this.xf=f.GC$.extend(!0,[],J.pivotCacheFieldsData()),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+k).bind("click",function(b){a.sendCommand(this),a.close()})},b.prototype.Tla=function(){f.GC$("."+k).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.kkc||-1,d=f.GC$(a).attr("command");switch(d){case"AddToReportField":c=0;break;case"AddToRowLabel":c=1;break;case"AddToColLabel":c=2;break;case"AddToValue":c=3}b.vic.nic({cmd:"AddField",sheetName:"",cmdOption:{fieldName:b.$ic,targetArea:c,pivotName:b._ic,isSusPaint:b.bQc}})},b}(N),b.PivotCacheFieldsDropdownDialog=P,Q=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=W(a[b]);return c},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],J.dataOfValueFilter()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+D).bind("click",function(b){var c,d=a.vic,e=a.$ic,g=this,h=a._ic,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,command:j,clearType:2}}),a.GZ.close(),void a.close()):isNaN(+j)&&"Top10"!==j?(a.GZ.close(),void a.close()):(c=i().getValueFilterItemText(),a.GZ.close(),a.close(),void d.nic({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,content:c,command:j}}))})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+D).unbind("click")},b.prototype.sendCommand=function(){},b}(N),b.PivotValuesDialog=Q,R=function(a){V(b,a);function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=W(a[b]);return c},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],J.dataOfString()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+C).bind("click",function(b){Z(this,a)}),f.GC$(a.qo).bind("mouseleave",function(b){a.close()})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+C).unbind("click")},b.prototype.sendCommand=function(){},b}(N),b.PivotStringFilterDialog=R,S=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=W(a[b]);return c},b.prototype.OY=function(a){var b,c,d,e,h,i,j;for(this.xf=f.GC$.extend(!0,[],J.dataOfDate()),b=a.existed,c=this.xf,b&&0!==b.length?this.xf[0].child[0].iconClass=B+" "+o:c[0].child[0].class=q,h=1;h<c.length;h++)for(e=c[h].child,i=0;i<e.length;i++)for(d=+e[i].command,j=0;j<b.length;j++)if(b[j]>g.PivotDateFilterOperator.Q1&&b[j]<=g.PivotDateFilterOperator.M12&&(c[9].child[0].iconClass=o+" "+z),b[j]===d){c[h].child[i].iconClass+=" "+z,b.splice(j,1);break}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+F).bind("click",function(b){var c=i().getDateLabelFilterItemText(),d=a.vic,e=a.$ic,g=document.body,h=a._ic,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,clearType:1}}),a.GZ.close(),void a.close()):(a.GZ.close(),a.close(),void d.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,command:j,dateLabel:c,isWholeDay:!1}}))}),f.GC$("."+G).bind("mouseenter",function(b){var c,d,e,f=this,g=a.vic,h=a._ic,i=a.$ic,j=a.i6,k=[];j.existed.forEach(function(a){a>=24&&a<=39&&k.push(a)}),c=new T(f,g,h,i,H,H,a),d=a.GZ,e={x:b.x-a.SH.x-d.SH.x,y:b.y-a.SH.y-d.SH.y},c.OT(e,{existed:k,dataType:2})})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+F).unbind("click"),f.GC$("."+G).unbind("mouseenter")},b.prototype.sendCommand=function(){},b}(N),b.PivotDateFilterDialog=S,T=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=W(a[b]);return c},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],J.dataOfDateSecondary()),b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c]-24,d=0;d<this.xf.length;d++){if(this.xf[d].child[b]){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+F).bind("click",function(b){var c=a.vic,d=a.$ic,e=this,g=a._ic,h=f.GC$(this).attr("command"),i=a.GZ;i.GZ.close(),i.close(),a.close(),c.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h,isWholeDay:!1}})})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+F).unbind("click")},b.prototype.sendCommand=function(){},b}(N),b.PivotDateSecondaryFilterDialog=T,U=function(a){V(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=W(a[b]);return c},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],J.dataOfNumber()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+E).bind("click",function(b){Z(this,a)})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+E).unbind("click")},b.prototype.sendCommand=function(){},b}(N),b.PivotNumberFilter=U;function W(a){var b,c="";for(b=0;b<a.child.length;b++)c+=X(a.child[b]);return'<div class="'+a.className+'" height="21px">\n            '+c+'\n            <span class="'+a.ListSpan+'"></span>\n            </div>'}function X(a){return'<div class="'+a.class+'" command="'+a.command+'">\n                <div class="'+a.iconClass+'"></div>\n                <div class="'+a.linkClass+'">'+a.text+"</div>\n            </div>"}function Y(a,b){var c,d,e=0;switch(a){case 0:e=b.Lhc.length;break;case 1:e=b.Jhc.length;break;case 2:e=b.Khc.length;break;case 3:e=b.Mhc.length;break;default:return 0}return c=0,d=b.getSigmaValuePosition(),d.display&&d.positionType===a-1&&c++,e+c}function Z(a,b){var c=b.vic,d=b.$ic,e=b,g=b._ic,h=f.GC$(a).attr("command");return"ClearFilter"===h?(c.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:g,command:h,clearType:1}}),b.GZ.close(),void b.close()):isNaN(+h)?(b.GZ.close(),void b.close()):(b.GZ.close(),b.close(),void c.nic({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h}}))}},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR),i=h.getResource.bind(h),j=d.Formatter.GeneralFormatter,k="filter-dialog-container",l="label-title-class",m="label-filter-body",n="label-title",o="cancel-icon",p="cancel-class",q="label-show",r="split-line",s="prompt-info",t="ok-label",u="filter-confirm",v="label-select",w="label-input",x="confirm-class",y="label_input",z="input-between-container",A="input-between",B="and-joiner",C="top-ten-content",D="filter-value-dialog-container",E="value-title-class",F="split-line-class",G="value-filter-body",H="value-select",I="field-value",J="value-filter",K="filter-top-ten-container",L="top-ten-filter-body",M="split-line-of-top-ten",N="value-of-top-ten",O="top-ten-select",P="top-ten-title-class",Q="close-dialog",R="by-joiner-class",S="top-ten",T="filter-date-dialog-container",U="date-title-class",V="date-filter-body",W="date-split-line",X="date-select",Y="is-whole-days",Z=null,$=void 0,_=function(a){ca(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.okc=c,h.vic=d,h.$ic=e,h._ic=f,h.IIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(b.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.JIc()},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.okc=Z,this.$ic=$,this._ic=$,this.IIc=$,this.qo=Z,this.vic=Z},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.qkc=function(){var a,b,c="",d=this.okc,e=this.IIc;for(b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=da(e>=g.PivotCaptionFilterOperator.between?!0:!1),'<div class="'+k+'">\n                    <div class="'+l+'">\n                        <span class="'+n+'">'+(i().Label_Title+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+m+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().Label_Show+'</span>\n                            <span class="'+r+'"></span>\n                        </div>\n                        <div class="'+x+'">\n                            <select class="'+v+'">'+c+'</select>\n                            <div class="'+z+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+x+'">\n                            <span class="'+s+'">'+i().Use_Single_Character+'</span>\n                            <span class="'+s+'">'+i().Use_Series_Characters+'</span>\n                        </div>\n                        <div>\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+p).bind("click",function(b){a.WT()}),f.GC$("."+t).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+w)[0],k=Z,l=f.GC$("."+A);l.length>0&&(j=l[0],k=l[1]),c=j?j.value:Z,d=k?k.value:Z,e=a.IIc,g=a.vic,h=a.$ic,i=a._ic,g.nic({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:g,fieldName:h,pivotName:i,selectValue:e,inputValue:c,inputValueEnd:d}}),a.WT()}),f.GC$("."+v).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.Tla=function(){f.GC$("."+p).unbind("click"),f.GC$("."+t).unbind("click"),f.GC$("."+v).unbind("change")},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotCaptionFilterOperator.between&&b.IIc<g.PivotCaptionFilterOperator.between||c<g.PivotCaptionFilterOperator.between&&b.IIc>=g.PivotCaptionFilterOperator.between)&&(d=da(c>=g.PivotCaptionFilterOperator.between?!0:!1),f.GC$("."+z).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.vic,l=j.$ic,m=k.getFieldInfoByName(l),n=j.IIc,o=m.getFilterInfo();o&&o.labelFilter&&o.labelFilter.condition&&(a=o.labelFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===n&&(g=f.GC$("."+y),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b}(f.Go),b.LabelFilter=_,aa=function(a){ca(b,a);function b(b,c,d,e,f,g,h,i){var j=a.call(this,b,2e3,!0)||this;return j.LIc=c,j.vic=e,j.$ic=f,j._ic=g,j.rkc=d,j.IIc=h,j.cQc=i,j.Eo(),j.Ao(),j}return b.prototype.Ao=function(){var b=this;b.xo.html(this.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.MIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.LIc=Z,this.$ic=$,this._ic=$,this.IIc=$,this.qo=Z,this.vic=Z},b.prototype.MIc=function(){var a=this;a.cQc?a.NIc():a.JIc()},b.prototype.qkc=function(){return this.cQc?this.skc():this.tkc()},b.prototype.skc=function(){var a,b="",c=this.rkc;for(a=0;a<c.length;a++)b+=this.Ql(c[a],a);return'<div class="'+K+'">\n                    <div class="'+P+'">\n                        <span class="'+n+'">'+(i().Top_Ten_Filter+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+L+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().TopTenShow+'</span>\n                            <span class="'+M+'"></span>\n                        </div>\n                        <div class="'+(x+" "+C)+'">\n                            <select class="'+O+'">\n                                <option>'+i().Top+"</option>\n                                <option>"+i().Bottom+'</option>\n                            </select>\n                            <input class="'+N+'" type="number" value=10 min=1></input>\n                            <select class="'+O+'">\n                                <option>'+i().Top_Item+"</option>\n                                <option>"+i().Top_Percent+"</option>\n                                <option>"+i().Top_Sum+'</option>\n                            </select>\n                            <div class="'+R+'">'+i().ByJoiner+'</div>\n                            <select class="'+O+'">'+b+'</select>\n                        </div>\n                        <div class="'+Q+'">\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u+" "+S)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.tkc=function(){var a,b,c,d,e="",f=this.LIc,h=this.IIc;for(b=0;b<f.length;b++)e+=this.Ql(f[b],b);for(c="",d=this.rkc,b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=h===g.PivotValueFilterOperator.between||h===g.PivotValueFilterOperator.notBetween?da(!0,!0):da(!1,!0),'<div class="'+D+'">\n                    <div class="'+E+'">\n                        <span class="'+n+'">'+(i().Value_Title+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+G+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().Value_Show+'</span>\n                            <span class="'+F+'"></span>\n                        </div>\n                        <div class="'+x+'">\n                            <select class="'+H+'">'+c+'</select>\n                            <select class="'+(H+" "+I)+'">'+e+'</select>\n                            <div class="'+z+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+p).bind("click",function(b){a.WT()}),f.GC$("."+t).bind("click",function(b){f.GC$(this).hasClass(S)?a.ukc():a.vkc(),a.WT()}),f.GC$("."+I).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.NIc=function(){var a,b,c,d,e,h=this,i=h.rkc,j=h.vic,k=h.$ic,l=j.getFieldInfoByName(k),m=l.getFilterInfo();m&&m.valueFilter&&m.valueFilter.conditionByName&&(a=m.valueFilter.condition,a.getConditionType()===g.PivotConditionType.top10&&(b=a.toJSON(),c=b.val,d=b.type,e=b.operator,f.GC$("."+O)[2].selectedIndex=i.indexOf(m.valueFilter.conditionByName),f.GC$("."+O)[0].selectedIndex=e>0?0:1,f.GC$("."+O)[1].selectedIndex=d,f.GC$("."+N).attr("value",c)))},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotValueFilterOperator.between&&b.IIc<g.PivotValueFilterOperator.between||c<g.PivotValueFilterOperator.between&&b.IIc>=g.PivotValueFilterOperator.between)&&(d=c>=g.PivotValueFilterOperator.between?da(!0,!0):da(!1,!0),f.GC$("."+z).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.vic,l=j.$ic,m=k.getFieldInfoByName(l),n=j.IIc,o=m.getFilterInfo();o&&o.valueFilter&&o.valueFilter.condition&&(a=o.valueFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===n&&(g=f.GC$("."+y),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b.prototype.Tla=function(){f.GC$("."+p).unbind("click"),f.GC$("."+t).unbind("click"),f.GC$("."+I).unbind("change")},b.prototype.vkc=function(){var a,b,c,d,e,g,h,i=this,j=f.GC$("."+H),k=j[0],l=j[1],m=f.GC$("."+w)[0],n=Z,o=f.GC$("."+A);o.length>0&&(m=o[0],n=o[1]),a=f.GC$(k.options[k.selectedIndex]).text(),b=f.GC$(l.options[l.selectedIndex]).attr("command"),c=m?m.value:Z,d=n?n.value:Z,e=i.vic,g=i.$ic,h=i._ic,e.nic({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldsModel:e,fieldName:g,pivotName:h,valueOfField:a,valueOfFieldValue:b,inputValue:c,inputValueEnd:d}})},b.prototype.ukc=function(){var a=this,b=a.vic,c=a._ic,d=f.GC$("."+O),e=d[0],g=f.GC$("."+N)[0],h=d[1],i=d[2],j=f.GC$(e.options[e.selectedIndex]).text(),k=g.value,l=f.GC$(h.options[h.selectedIndex]).text(),m=f.GC$(i.options[i.selectedIndex]).text();b.nic({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:b,fieldName:a.$ic,valueFieldName:m,pivotName:c,TopOrBottomValue:j,inputValue:k,selectTypeValue:l}})},b}(f.Go),b.ValueFilter=aa,ba=function(a){ca(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.okc=c,h.vic=d,h.$ic=e,h._ic=f,h.IIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(this.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.JIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.$ic=$,this._ic=$,this.IIc=$,this.okc=Z,this.qo=Z,this.vic=Z},b.prototype.qkc=function(){var a,b,c="",d=this.okc;for(b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=da(this.IIc>=g.PivotDateFilterOperator.Between?!0:!1),
'<div class="'+T+'">\n                    <div class="'+U+'">\n                        <span class="'+n+'">'+(i().DateFilterTitle+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+V+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().DateShow+'</span>\n                            <span class="'+W+'"></span>\n                        </div>\n                        <div class="'+x+'">\n                            <select class="'+X+'">'+c+'</select>\n                            <div class="'+z+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+x+'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="'+Y+'">\n                            <label for="WholeDays">'+i().WholeDays+'</label>\n                        </div>\n                        <div>\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+p).bind("click",function(b){a.WT()}),f.GC$("."+t).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+X)[0],k=f.GC$("."+w)[0],l=Z,m=f.GC$("."+A),n=f.GC$("."+Y)[0].checked;m.length>0&&(k=m[0],l=m[1]),c=f.GC$(j.options[j.selectedIndex]).attr("command"),d=k?k.value:Z,e=l?l.value:Z,g=a.vic,h=a.$ic,i=a._ic,g.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:h,pivotName:i,command:c,isWholeDay:n,value1:d,value2:e}}),a.WT()}),f.GC$("."+X).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotDateFilterOperator.Between&&b.IIc<g.PivotDateFilterOperator.Between||c<g.PivotDateFilterOperator.Between&&b.IIc>=g.PivotDateFilterOperator.Between)&&(d=da(c>=g.PivotDateFilterOperator.Between?!0:!1),f.GC$("."+z).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j,k,l,m=this,n=m.vic,o=m.$ic,p=n.getFieldInfoByName(o),q=m.IIc,r=p.getFilterInfo();r&&r.labelFilter&&r.labelFilter.condition&&(a=r.labelFilter.condition.toJSON(),b=a.isWholeDay,c=a.operator,d=a.val,c===q&&(e=d[0],g=d[1],h=m.formatDate(e,g),e=h.value1,g=h.value2,i=f.GC$("."+y),j=f.GC$("#WholeDays"),k=i[0],l=i[1],k.value=e,l&&g&&g.length>0&&(l.value=g),j.attr("checked",b)))},b.prototype.formatDate=function(a,b){var c=new j,d=c.getPreferredEditingFormatter(a),e=c.getPreferredEditingFormatter(b);return{value1:d.format(a),value2:e.format(b)}},b.prototype.Tla=function(){f.GC$("."+p).unbind("click"),f.GC$("."+t).unbind("click"),f.GC$("."+X).unbind("change")},b}(f.Go),b.DateFilterDialog=ba;function da(a,b){var c="",d="";return b&&(c="type = 'number'",d=J),a?'<input class="'+(A+" "+y+" "+d)+'" '+c+' width=100px></input>\n                    <div class="'+B+'">'+i().AndJoiner+'</div>\n                <input class="'+(A+" "+y+" "+d)+'" '+c+" width=100px></input>":'<input class="'+(w+" "+y+" "+d)+'" '+c+"></input>"}},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new e.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=d.Ul.Nl,k="cancel-icon",l="cancel-class",m="ok-label",n="filter-confirm",o="date-group-startingAt-isActive",p="date-group-startingAt-value",q="date-group-endingAt-isActive",r="date-group-endingAt-value",s="date-group-by-value",t="date-group-dialog-sub-container",u="date_group_dialog_group-by-subContainer",v="date-group-by",w="date-group-by-selected",x="click",y="change",z=function(a){A(b,a);function b(b,c,e,f,g,h,i,j,k,l,m){var n,o;return void 0===m&&(m="m/d/yyyy"),n=a.call(this,b,0,!0)||this,o=n,o.dQc=c,o.$ic=e,o.vic=f,o.Tlc=h&&d.mn.un(h,m)||"",o.eQc=g&&d.mn.un(g,m),o.fQc=o.eQc===o.Tlc,o.Ulc=j&&d.mn.un(j,m)||"",o.gQc=i&&d.mn.un(i,m),o.hQc=o.gQc===o.Ulc,o.iQc=k,o.GLc=l,o.Eo(),n}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(j("div"));a[0].innerHTML=this.jQc(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+l).bind(x,function(b){a.WT()}),d.GC$("."+m).bind(x,function(b){var c=a.dQc,e=a.$ic,g=d.GC$("."+p).val().trim(),h=d.GC$("."+r).val().trim(),i=a.iQc;a.vic.nic({cmd:"pivotTableGroup",cmdOption:{dataType:f.PivotDataType.date,fieldName:e,pivotName:c,startingAtValue:g,endingAtValue:h,groupByValueArray:i,selections:a.GLc}}),a.WT()}),d.GC$("."+v).bind(x,function(b){var c=parseInt(d.GC$(this).attr("value"),10);a.iQc.indexOf(c)>-1?(d.GC$("."+v).css("border","initial"),d.GC$(this).removeClass(w),a.iQc.splice(a.iQc.indexOf(c),1)):(d.GC$("."+v).css("border","initial"),d.GC$(this).addClass(w),d.GC$(this).css("border","1px dotted rgb(255,135,34)"),a.iQc.push(c))}),d.GC$("."+p).bind(y,function(b){a.fQc=!1,d.GC$("."+o)[0].checked=!1}),d.GC$("."+r).bind(y,function(b){a.hQc=!1,d.GC$("."+q)[0].checked=!1}),d.GC$("."+o).bind(x,function(b){this.checked&&d.GC$("."+p).val(a.eQc)}),d.GC$("."+q).bind(x,function(b){this.checked&&d.GC$("."+r).val(a.gQc)})},b.prototype.jQc=function(){var a=v+(this.iQc.indexOf(f.DateGroupType.seconds)>-1?" "+w:""),b=v+(this.iQc.indexOf(f.DateGroupType.minutes)>-1?" "+w:""),c=v+(this.iQc.indexOf(f.DateGroupType.hours)>-1?" "+w:""),d=v+(this.iQc.indexOf(f.DateGroupType.days)>-1?" "+w:""),e=v+(this.iQc.indexOf(f.DateGroupType.months)>-1?" "+w:""),g=v+(this.iQc.indexOf(f.DateGroupType.quarters)>-1?" "+w:""),h=v+(this.iQc.indexOf(f.DateGroupType.years)>-1?" "+w:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                        <span class="'+(l+" "+k)+'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+o+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+p+'" value = "'+this.Tlc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+q+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+r+'" value = "'+this.Ulc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <span style = "display: inline-block;">'+i().groupBy+'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="'+u+'">\n                                <span value = '+f.DateGroupType.seconds+' class="'+a+'">'+i().seconds+"</span>\n                                <span value = "+f.DateGroupType.minutes+' class="'+b+'">'+i().minutes+"</span>\n                                <span value = "+f.DateGroupType.hours+' class="'+c+'">'+i().hours+"</span>\n                                <span value = "+f.DateGroupType.days+' class="'+d+'">'+i().days+"</span>\n                                <span value = "+f.DateGroupType.months+' class="'+e+'">'+i().months+"</span>\n                                <span value = "+f.DateGroupType.quarters+' class="'+g+'">'+i().quarters+"</span>\n                                <span value = "+f.DateGroupType.years+' class="'+h+'">'+i().years+'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="'+(l+" "+n)+'">'+i().Cancel+'</span>\n                            <span class="'+(m+" "+n)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+l).unbind(x),d.GC$("."+m).unbind(x)},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotDateGroupDialog=z},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),i=new f.Common.ResourceManager(g.SR),j=i.getResource.bind(i),k=d.Ul.Nl,l=".pivot-field-content-base-field-item.active",m=".pivot-field-content-base-item-item.active",n="pivot-field-content-hide",o="pivot-field-content-base-item-item",p=".pivot-field-show-value-as-content-base-item",q=".pivot-field-show-value-as-content-base-field",r=".pivot-field-show-value-as-content-type-list",s=".pivot-field-setting-control-format",t=".pivot-field-setting-control-ok",u=".pivot-field-setting-control-cancel",v=".gc-filter-dialog-close",w=".pivot-field-custom-name",x="click",y="change",z="active",A="disable",B="pivot-field-content-item",C="pivot-field-summarize-item",D="pivot-field-summarize-content",E=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'+C+" "+z+'">'+j().SummarizeValue+'</div>\n            <div id="ShowValueAs" class="'+C+'">'+j().ShowValueAs+"</div>\n        </div>\n    "},F=function(a){I(b,a);function b(b,c,d,e,f){var g,h=a.call(this,document.body,999,!0)||this;return h.Vo=374,h._v=317.5,h.$l=!1,h.nNc="",h.kQc=[],h.lQc=c,h.vic=b,h.$ic=d,h.xkc=d,h._ic=e,h.Wqa=f,g=h.vic.getFieldInfoByName(d),h._X=g.whc,h.mQc=g.getSubTotalType(),h.nQc(f),h.Eo(),h}return b.prototype.nQc=function(a){var b,c,d,e,f=this;if(f.Wqa)for(b=0;b<f.Wqa.length;b++)if(f.Wqa[b]&&f.Wqa[b].pivotArea&&f.Wqa[b].pivotArea.dataOnly&&(c=f.Wqa[b].pivotArea.references))for(d=0;d<c.length;d++)if(c[d].items.indexOf(f.$ic)>-1){e=f.Wqa[b].style,e&&e.formatter&&(f.nNc=e.formatter);break}},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.BPa()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.oQc=(d-b)/2+"px",this.pQc=(e-c)/2+"px",this.xo.css(["position","left","top"],["absolute",this.oQc,this.pQc])},b.prototype.dialogHeader=function(a){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '+a+'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        '},b.prototype.dialogFieldNameArea=function(a,b){var c="pivot-field-row-wrap";return'\n            <div class ="pivot-field-setting-name-area">\n                <div class='+c+">\n                    <label>"+j().SourceName+" </label> <span>"+a+"</span>\n                </div>\n                <div class="+c+">\n                    <label>"+j().CustomName+' </label> <span><input class="pivot-field-custom-name" type="text" value="'+b+'"></span>\n                </div>\n            </div>\n        '},b.prototype.dialogFooter=function(a){var b="";return a!==e.PivotDataType.number&&a!==e.PivotDataType.date||(b='\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'+j().Format+'">\n                </div>\n            '),'\n            <div class="pivot-field-setting-footer">\n                '+b+'\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "'+j().Ok+'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "'+j().Cancel+'">\n                </div>\n            </div>\n        '},b.prototype.yl=function(){var a=d.GC$(k("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.dialogHeader(this.lQc)+'\n                <div class="gc-pivot-field-setting-content">\n                    '+this.dialogFieldNameArea(this._X,this.$ic)+"\n                    "+this.kQc.join("\n")+"\n                </div>\n            "+this.dialogFooter(this.vic.RFc(this.$ic)),this.xo.append(a),d.GC$(".pivot-field-content-item[data-subtype='"+this.mQc+"']",this.xo[0]).addClass(z),this.xo.width(this.Vo),this.xo.height(this._v)},b.prototype.Hhc=function(){this.vic=null,this.$ic=void 0},b.prototype.WT=function(){this.Hhc(),a.prototype.close.call(this)},b}(d.Go),b.PivotSettingBaseDialog=F,G=function(a){I(b,a);function b(b,c,d,e){var f=a.call(this,b,j().ValueSetting,c,d,e)||this;return f.tQc(),f.yl(),f.uQc(),f.LXa(),f}return b.prototype.tQc=function(){this.Bkc()},b.prototype.uQc=function(){var a,b,c,e,f=this,g=this.vic.getFieldInfoByName(f.$ic).pNc;if(g&&(f.sQc=g.showDataAs,f.cXc=g.baseFieldName,f.dXc=g.baseFieldItem,a=g.showDataAs+"",d.GC$(r,this.xo[0]).value=a,["4","7","8","9","10","11","12","13"].indexOf(a)>-1)){for(d.GC$(q).removeClass(A),b=f.vic.Shc(1).concat(f.vic.Shc(2)),c=0;c<b.length;c++)if(b[c].Cj===g.baseFieldName){f.qQc=c;break}if(["4","8","9"].indexOf(a)>-1)if(d.GC$(p).removeClass(A),1===g.baseFieldItemType)f.rQc=1;else if(2===g.baseFieldItemType)f.rQc=0;else for(e=f.vic.SFc(g.baseFieldName).slice(),c=0;c<e.length;c++)if(e[c]+""===g.baseFieldItem){f.rQc=c+2;break}}},b.prototype.Bkc=function(){var a=this.Dkc(),b=this.Ekc(),c=this.vQc();this.kQc.push('\n            <div class="pivot-field-summarize-area">\n            '+a+"\n            "+b+"\n            "+c+"\n            </div>\n        ")},b.prototype.Dkc=function(){return E()},b.prototype.Ekc=function(){return'\n        <div class="'+D+'">\n            <div class="'+D+'-header">'+j().SummarizeValueField+'</div>\n            <div class="'+D+'-desc">'+j().ChooseType+'</div>\n            <ul class="'+D+'-list">\n                <li data-subtype="8" class="'+B+'">'+j().Sum+'</li>\n                <li data-subtype="1" class="'+B+'">'+j().Count+'</li>\n                <li data-subtype="0" class="'+B+'">'+j().Average+'</li>\n                <li data-subtype="3" class="'+B+'">'+j().Max+'</li>\n                <li data-subtype="4" class="'+B+'">'+j().Min+'</li>\n                <li data-subtype="5" class="'+B+'">'+j().Product+'</li>\n                <li data-subtype="2" class="'+B+'">'+j().CountNumbers+'</li>\n                <li data-subtype="6" class="'+B+'">'+j().StdDev+'</li>\n                <li data-subtype="7" class="'+B+'">'+j().StdDevp+'</li>\n                <li data-subtype="9" class="'+B+'">'+j().Var+'</li>\n                <li data-subtype="10" class="'+B+'">'+j().Varp+"</li>\n            </ul>\n        </div>\n        "},b.prototype.vQc=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'+j().ShowValueAsField+'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">'+j().noCalculation+'</option>\n                <option value="1">'+j().percentGrandTotal+'</option>\n                <option value="2">'+j().percentColumnTotal+'</option>\n                <option value="3">'+j().percentRowTotal+'</option>\n                <option value="4">'+j().percentEllipsis+'</option>\n                <option value="5">'+j().percentParentRowTotal+'</option>\n                <option value="6">'+j().percentParentColumnTotal+'</option>\n                <option value="7">'+j().percentParentTotal+'</option>\n                <option value="8">'+j().difference+'</option>\n                <option value="9">'+j().percentDifference+'</option>\n                <option value="10">'+j().runningTotal+'</option>\n                <option value="11">'+j().percentRunningTotal+'</option>\n                <option value="12">'+j().rankSmallestLargest+'</option>\n                <option value="13">'+j().rankLargestSmallest+'</option>\n                <option value="14">'+j().index+'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>'+j().baseField+'</div>\n                <ul class="pivot-field-show-value-as-content-base-field '+A+'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>'+j().baseItem+'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  '+A+'">\n                </ul>\n            </div>\n        </div>\n        '},b.prototype.LXa=function(){var a=this;d.GC$(v,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(u,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(w,this.xo[0]).bind(y,function(){a.$l=!0,a.$ic=d.GC$(this).val()}),d.GC$("."+B,this.xo[0]).bind(x,function(){d.GC$("."+B+"."+z).removeClass(z),a.$l=!0,a.mQc=+d.GC$(this).addClass(z).attr("data-subtype");var b=a.vic.getFieldInfoByName(a.xkc).whc,c=a.vic.JNc(b,b,a.mQc);d.GC$(w).val(c),a.$ic=c}),d.GC$(t,this.xo[0]).bind(x,function(){var b=e.Fa(a.sQc)?"0":a.sQc+"",c,f=a.cXc,g=a.dXc,h=a.eXc;d.GC$(l)[0]&&["4","7","8","9","10","11","12","13"].indexOf(b)>-1&&["4","8","9"].indexOf(b)>-1&&(c={value:g,index:h}),a.vic.nic({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:a._ic,oldFieldName:a.xkc,subtotalType:a.mQc,fieldName:a.$ic,showValueAsType:parseInt(b,10),baseField:f,baseItem:c},formatter:a.nNc}),a.nNc="",a.WT()}),d.GC$("."+C,this.xo[0]).bind(x,function(){var b,c;d.GC$("."+C+"."+z).removeClass(z),d.GC$(".pivot-field-content-hide").removeClass(n),d.GC$(this).addClass(z),d.GC$(q).empty(),"SummarizeValue"===this.id?d.GC$(".pivot-field-show-value-as-content").addClass(n):(a.sQc>-1&&(d.GC$(r)[0].value=a.sQc,a.qQc>-1&&(d.GC$(q).removeClass(A),a.rQc>-1&&d.GC$(p).removeClass(A))),d.GC$("."+D).addClass(n),a.wQc=a.vic.Shc(1).concat(a.vic.Shc(2)),a.wQc.forEach(function(b,c){var e=document.createElement("li");e.className="pivot-field-content-base-field-item",e.value=c,a.qQc>-1&&a.qQc===c&&e.classList.add(z),e.innerText=b.Cj,d.GC$(q)[0].appendChild(e)}),a.rQc>-1&&(b=a.vic.getFieldInfoByName(a.$ic).pNc,c=a.vic.SFc(b.baseFieldName).slice(),c.unshift(j().BaseItemNext),c.unshift(j().BaseItemPrevious),c.forEach(function(b,c){var e=document.createElement("li");e.className=o,e.value=c,e.innerText=b,c===a.rQc&&e.classList.add(z),d.GC$(p)[0].appendChild(e)})))}),d.GC$(q,this.xo[0]).bind(x,function(b){var c,e;this.classList.contains(A)||"LI"!==b.target.tagName||(d.GC$(l).removeClass(z),d.GC$(p).empty(),b.target.classList.add(z),c=b.target.textContent,a.cXc=c,["4","8","9"].indexOf(a.sQc+"")<0||(e=a.vic.SFc(c).slice(),e.unshift(j().BaseItemNext),e.unshift(j().BaseItemPrevious),e.forEach(function(a,b){var c=document.createElement("li");c.className=o,c.value=b,c.innerText=a,0===b&&c.classList.add(z),d.GC$(p)[0].appendChild(c)})))}),d.GC$(p,this.xo[0]).bind(x,function(b){this.classList.contains(A)||"LI"!==b.target.tagName||(d.GC$(m).removeClass(z),b.target.classList.add(z),a.dXc=b.target.textContent,a.eXc=b.target.value)}),d.GC$(r,this.xo[0]).bind(y,function(b){var c,e,f=b.target.value;d.GC$(p).empty(),a.nNc=void 0,a.sQc=parseInt(f,10),["4","7","8","9","10","11","12","13"].indexOf(f)>-1?(d.GC$(q).removeClass(A),d.GC$(".pivot-field-content-base-field-item")[0].classList.add(z),["4","8","9"].indexOf(f)>-1&&(d.GC$(p).removeClass(A),c=a.wQc[0].Cj,e=a.vic.SFc(c).slice(),e.unshift(j().BaseItemNext),e.unshift(j().BaseItemPrevious),e.forEach(function(a,b){var c=document.createElement("li");c.className=o,c.value=b,0===b&&c.classList.add(z),c.innerText=a,d.GC$(p)[0].appendChild(c)}))):(d.GC$(p).addClass(A),d.GC$(q).addClass(A),d.GC$(l).removeClass(z),d.GC$(m).removeClass(z))}),d.GC$(s,this.xo[0]).bind(x,function(){new h.PivotFieldSettingNumberFormatDialog(a,a.oQc,a.pQc,a.nNc).Ao()})},b.prototype.Tla=function(){d.GC$(v).unbind(x),d.GC$(q).unbind(x),d.GC$(p).unbind(x),d.GC$(r).unbind(y),d.GC$(s).unbind(x)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(F),b.PivotValuesFieldSettingDialog=G,H=function(a){I(b,a);function b(b,c,d,e){var f=a.call(this,b,j().FieldSetting,c,d,e)||this;return f.yl(),f.LXa(),f}return b.prototype.xQc=function(){return E()},b.prototype.Bkc=function(){var a=this.xQc();this.kQc.push('\n            <div class="pivot-field-summarize-area">\n                '+a+"\n            </div>\n        ")},b.prototype.LXa=function(){var a=this;d.GC$(v,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(u,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(w,this.xo[0]).bind(y,function(){a.$l=!0,a.$ic=d.GC$(this).val()}),d.GC$(s,this.xo[0]).bind(x,function(){new h.PivotFieldSettingNumberFormatDialog(a,a.oQc,a.pQc,a.nNc).Ao()}),d.GC$(t,this.xo[0]).bind(x,function(){a.vic.nic({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:a._ic,oldFieldName:a.xkc,fieldName:a.$ic},formatter:a.nNc}),a.nNc="",a.WT()})},b.prototype.Tla=function(){d.GC$(v).unbind(x),d.GC$(u).unbind(x),d.GC$(w).unbind(y),d.GC$(s).unbind(x),d.GC$(t).unbind(x)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(F),b.PivotDimFieldSettingDialog=H},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Ul.Nl,f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=".pivot-field-number-format-show-value",k=".pivot-field-number-format-sample-value",l=d.Ul.lHb,m=null,n=void 0,o="click",p="active",q=function(a){r(b,a);function b(b,c,d,e){var f=a.call(this,null,1e4)||this;return f.zWa=!0,f.FB=d,f.EB=c,f.yQc=b,f.nNc=e,f.Bla(),f}return b.prototype.BPa=function(){this.xo.css(["position","left","top"],["absolute",this.EB,this.FB])},b.prototype.Hhc=function(){this.yQc=m,this.nNc=n},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Tla=function(){d.GC$(".pivot-field-content-number-format-item").unbind(o),d.GC$(".pivot-field-setting-number-format-control-ok").unbind(o),d.GC$(".gc-filter-dialog-close",this.xo[0]).unbind(o),d.GC$(".pivot-field-setting-number-format-control-cancel").unbind(o),d.GC$(j).unbind(o)},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.zQc(),this.LXa(),this.BPa()},b.prototype.LXa=function(){var a=this;d.GC$(".pivot-field-content-number-format-item",this.xo[0]).bind(o,function(a){d.GC$(".pivot-field-content-number-format-item.active").removeClass(p),this.classList.add(p),d.GC$(j)[0].value=this.innerText,l(this.innerText)||(d.GC$(k)[0].value=d.mn.un(12345,this.innerText))}),d.GC$(".pivot-field-setting-number-format-control-ok",this.xo[0]).bind(o,function(){var b=d.GC$(j)[0].value,c=i().CustomFormats;c.indexOf(b)<0&&c.push(b),a.yQc.nNc=d.GC$(j)[0].value,a.WT()}),d.GC$(".gc-filter-dialog-close",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(".pivot-field-setting-number-format-control-cancel",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(j,this.xo[0]).bind("input",function(){l(this.value)||(d.GC$(k)[0].value=d.mn.un(12345,this.value))})},b.prototype.Bla=function(){var a=d.GC$(e("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.zkc()+'<div class="gc-pivot-field-setting-content">'+this.AQc()+"</div>"+this.Ckc(),this.xo.append(a)},b.prototype.zkc=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'+i().FormatCells+'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>'},b.prototype.Ckc=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'+i().Ok+'">\n          <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "'+i().Cancel+'">\n          </div>\n        </div>'},b.prototype.AQc=function(){var a=this.BQc();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'+i().Number+"</div>\n            </div>\n            "+a+"\n        </div>\n        "},b.prototype.BQc=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'+i().Sample+'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">'+i().Type+'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        '},b.prototype.zQc=function(){var a=i().CustomFormats,b=this;b.nNc&&a.indexOf(b.nNc)<0&&a.push(b.nNc),a.forEach(function(a,c){var e=document.createElement("li");e.className="pivot-field-content-number-format-item",e.value=c,e.innerText=a,b.nNc||0!==c?b.nNc===a&&(e.classList.add(p),l(a)?d.GC$(j)[0].value=a:d.GC$(j)[0].value=d.mn.un(12345,a)):(e.classList.add(p),d.GC$(j)[0].value=a),d.GC$(".pivot-field-number-format-content-list")[0].appendChild(e)})},b}(d.Go),b.PivotFieldSettingNumberFormatDialog=q},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("CellTypes"),h=c("Pivot"),i=new d.Common.ResourceManager(e.SR),j=i.getResource.bind(i),k=f.Ul.Nl,l="gc-Filter-list",m="gc-Filter-list-block",n="gc-Filter-list-select-block",o="gc-Filter-list-icon",p="gc-Filter-list-link",q="gc-Filter-list-item",r="gc-Filter-list-link-arrow",s="gc-Filter-list-sort-item",t="gc-Filter-list-icon-selected",u="item-hover",v="item-noHover",w="clear-filter-icon-default",x="clear-filter-icon",y="gc-Filter-list-span",z="filter-list-box",A="filter-confirm",B="filter-dialog-confirm",C="filter-confirm-enable",D="filter-bottom-line",E="filter-sort-icon-one",F="filter-sort-icon-two",G="filter-list-box-icon",H="filter-list-box-container",I="filter-search",J="filter-list-box-host",K="filter-search-input",L="filter-select-all-container",M="filter-select-icon",N="filter-select-all-link",O="filter-check-all-icon",P="filter-uncheck-all-icon",Q="check-all",R="uncheck-all",S="gc-Filter-list-icon-selected",T="select-class",U="ok-class",V="cancel-class",W="filter-sort",X="filter-condition",Y=null,Z=void 0,$=function(){return{type:2,child:[{text:j().PivotPanel_Sort_A_Z,className:s+" "+W,iconClass:o+" "+E,commandName:"asc"},{text:j().PivotPanel_Sort_Z_A,className:s+" "+W,iconClass:o+" "+F,commandName:"desc"}]}},_=function(){return{type:3,child:[{text:j().PivotPanel_Filter_Clear,className:s+" "+X,iconClass:o+" "+w,commandName:"ClearFilter"},{text:j().PivotPanel_Filter_Label,className:s+" "+u+" "+X,iconClass:o,commandName:"LabelFilter",rightArrow:!0},{text:j().PivotPanel_Filter_Value,className:s+" "+u+" "+X,iconClass:o,commandName:"ValueFilter",rightArrow:!0}]}},aa=function(){return{type:5,child:[{text:j().Cancel,className:B+" "+C,commandName:"Cancel"},{text:j().Ok,className:B+" "+C,commandName:"OK"}]}},function(a){a[a.selectFields=1]="selectFields",a[a.sortArea=2]="sortArea",a[a.filters=3]="filters",a[a.listBox=4]="listBox",a[a.confirmButton=5]="confirmButton"}(ba||(ba={})),ca=function(){function a(){}return a.getData=function(b,c,d){return a.getDataModel(b,c,d)},a.getDataModel=function(b,c,d){var e=[];return 1&b&&e.push(a.getSelectData(d)),2&b&&e.push(a.getSortSData(d)),4&b&&e.push(a.getFilterData(d,c)),8&b&&e.push(a.getListBoxData(d)),16&b&&e.push(a.getConfirmData()),e},a.getSelectData=function(a){var b,c={type:1,child:[]};if(a.areaFieldName)for(b=0;b<a.areaFieldName.length;b++)c.child.push({text:""}),c.child[b].text=a.areaFieldName[b];return c},a.getSortSData=function(a){var b,c=f.GC$.extend(!0,{},$());return a.fieldIsNumber&&(c.child[0].text=j().PivotPanel_Sort_Smallest_Largest,c.child[1].text=j().PivotPanel_Sort_Largest_Smallest),a.isColOrRow?(c.child[0].className+=" "+u,c.child[1].className+=" "+u):(c.child[0].className+=" "+v,c.child[1].className+=" "+v),h.Fa(a.sortInfo)||(b=c.child[a.sortInfo],h.Fa(b)||(~b.iconClass.indexOf(E)?b.iconClass=b.iconClass.replace(E,t):~b.iconClass.indexOf(F)&&(b.iconClass=b.iconClass.replace(F,t)))),c},a.getFilterData=function(a,b){var c=f.GC$.extend(!0,{},_());return c.child[0].text=c.child[0].text.replace("{0}",'"'+b+'"'),
a.hasLabelCondition||a.hasValueCondition||a.hasLabelManual?c.child[0].className+=" "+u:c.child[0].className+=" "+v,a.hasLabelCondition&&(c.child[1].iconClass+=" "+S,c.child[0].iconClass=o+" "+x),a.isDateType&&(c.child[1].text=j().PivotPanel_Date_Filter),a.hasValueCondition&&(c.child[2].iconClass+=" "+S,c.child[0].iconClass=o+" "+x),c},a.getListBoxData=function(a){var b={type:4,child:[]};return b.child=a.fields,b},a.updateListBoxData=function(a,b,c){var d,e;if(a&&0!==a.child.length){if(d=a.child,0===b)for(e=0;e<d.length;e++)d[e].status=c;else d[b].status=c;return a}},a.getConfirmData=function(){return f.GC$.extend(!0,{},aa())},a}(),da=function(a){ea(b,a);function b(b,c,d){var e=a.call(this,b,1e3)||this;return e.vic=c,e._ic=d,e}return b.prototype.init=function(b,c,d,e){this.hZ(),this.$ic=c,this.Fkc=b,this.SH=d,this.i6=e,a.prototype.ad.call(this),e.isDateType=2===this.vic.getFieldInfoByName(c).ny;var f=ca.getData(b,c,e);this.open(f,d)},b.prototype.hZ=function(){this.OC&&(this.OC.no(),this.OC=null)},b.prototype.open=function(a,b){var c,d,e,f="";for(c=0;c<a.length;c++)switch(a[c].type){case 1:f+=this.renderSelectField(a[c]);break;case 2:f+=this.renderSort(a[c]);break;case 3:f+=this.renderFilters(a[c]);break;case 4:f+=this.renderListBox(a[c]);break;case 5:f+=this.renderConfirm(a[c])}d=this.Sla(b.x,b.y),d.html(f),e=this.cXa(),this.Ao(),e&&window.Yl.Hm(),this.Gkc()},b.prototype.Sla=function(a,b){var c,d=this.yo(),e=f.GC$(this.zo()).offset();return d.css(["left","top"],[e.left,e.top]),c=f.GC$("."+l),0===c.length&&(c=f.GC$(k("div"))),c.css(["left","top"],[a,b]),c.addClass(l),c.appendTo(d),c},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.Do()},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.Hkc=Y,this.Kkc=Y,this.vic=Y,this.SH=Y,this.i6=Y,this.OC=Y},b.prototype.QQ=function(a){var b=this,c=this;a.bind(f.Events.CellClick,function(d,e){var g=b.Hkc;e.row>=g.length||(g[e.row].status=!g[e.row].status,b.Ikc(g,a.getActiveSheet()),c.Jkc?f.GC$("."+U).addClass(C):f.GC$("."+U).removeClass(C))}),a.bind(f.Events.TouchToolStripOpening,function(a,b){b.handled=!0}),a.bind(f.Events.ButtonClicked,function(d,e){var g=b.Hkc;e.row>=g.length||(g[e.row].status=!g[e.row].status,b.Ikc(g,a.getActiveSheet()),c.Jkc?f.GC$("."+U).addClass(C):f.GC$("."+U).removeClass(C))}),f.GC$("."+Q).bind("click",function(c){var d,e=b.Hkc;if(!(e.length<=0)){for(d=0;d<e.length;d++)e[d].status=!0;b.Ikc(e,a.getActiveSheet()),f.GC$("."+U).addClass(C)}}),f.GC$("."+R).bind("click",function(c){var d,e=b.Hkc;if(!(e.length<=0)){for(d=0;d<e.length;d++)e[d].status=!1;b.Ikc(e,a.getActiveSheet()),f.GC$("."+U).removeClass(C)}}),f.GC$("."+T).bind("change",function(a){var b=this.options[this.selectedIndex].value,d=c.vic,e=c._ic,f=c.SH,g=c.Fkc;d.nic({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:b,pivotName:e,configurationNumber:g,position:f,filterDialog:c}})}),f.GC$("."+U).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(C)&&(b=c.$ic,d=c.vic,e=c._ic,g=c.Hkc,d.nic({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:b,pivotName:e,dataOfListBox:g}}),c.close())}),f.GC$("."+V).bind("click",function(a){c.close()}),f.GC$("."+W).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(v)||(b=f.GC$(this).attr("command"),d=c.vic,e=c.$ic,g=c._ic,d.nic({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:g,commandName:b}}),c.close())}),f.GC$("."+X).bind("click",function(a){var b,d,e,g=f.GC$(this).attr("command");f.GC$(this).hasClass(v)||"ClearFilter"!==g||(b=c.vic,d=c.$ic,e=c._ic,b.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:g,clearType:0}}),c.close())}),f.GC$("."+X).bind("mouseenter",function(a){var b,d,e,g,h,i=f.GC$(this),j=i.attr("command");i.hasClass(v)||"ClearFilter"===i.attr("command")||(b=c.vic,d=c.$ic,e=c._ic,g=this,h={x:c.SH.x,y:c.SH.y},b.nic({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:j,host:g,position:h,filterDialog:c}}))})},b.prototype.Tla=function(){f.GC$("."+Q).unbind("click"),f.GC$("."+R).unbind("click"),f.GC$("."+T).unbind("change"),f.GC$("."+U).unbind("click"),f.GC$("."+V).unbind("click"),f.GC$("."+W).unbind("click"),f.GC$("."+X).unbind("click"),f.GC$("."+X).unbind("mouseenter"),f.GC$("."+K).unbind("change")},b.prototype.renderSelectField=function(a){var b,c='<select class="'+T+'" style="width:100%">';for(b=0;b<a.child.length;b++)c+=this.renderDropDown(a.child[b].text);return"<div class='"+n+"'>\n                    <div class='"+q+"'>\n                    "+j().Select_Field+"\n                    </div>\n                    <div class='"+q+"'>\n                        "+c+"\n                        </select>\n                    </div>\n                </div>"},b.prototype.renderSort=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+m+'">\n                    '+c+'\n                    <div class="'+y+'"></div>\n                </div>'},b.prototype.renderFilters=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+m+'">\n                    '+c+'\n                    <div class="'+y+'"></div>\n                </div>'},b.prototype.renderListBox=function(a){var b,c,d,e;for(this.Kkc=H,this.Hkc=a.child,b="",c=a.child,d=0;d<c.length;d++)c[d].status===!1&&(b=t+" "+o);return e=this.Lkc(),'<div class="'+z+'">\n                    '+e+'\n                    <div class="'+J+'">\n                    <div class="'+G+'">\n                        <div class="'+b+'"></div>\n                    </div>\n                    <div class="'+H+'"></div>\n                    </div>\n                <div>'},b.prototype.renderConfirm=function(a){return'<div class="'+m+'">\n                    <div class="'+s+'">\n                        <div class="'+(a.child[0].className+" "+V)+'" command="'+a.child[0].commandName+'">'+a.child[0].text+'</div>\n                        <div class="'+(a.child[1].className+" "+U)+'" command="'+a.child[1].commandName+'">'+a.child[1].text+'</div>\n                    </div>\n                    <div class="'+D+'"></div>\n                </div>'},b.prototype.renderDropDown=function(a){return"<option>"+a+"</option>"},b.prototype.createItem=function(a){return a.rightArrow?'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+p+'">'+a.text+'</div>\n                        <div class="'+r+'"></div>\n                    </div>':'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+p+'">'+a.text+"</div>\n                    </div>"},b.prototype.Gkc=function(a){var b,c,d,e,g;a||(a=this.Hkc),b=this.Kkc,c=new f.Workbook(document.getElementsByClassName(b)[0],{sheetCount:1}),c.jDc=!0,c.options.scrollByPixel=!0,this.OC=c,d=c.sheets[0],c.suspendEvent(),d.suspendPaint(),e=c.options,g=d.options,e.allowContextMenu=!1,e.showHorizontalScrollbar=!1,e.showVerticalScrollbar=!1,e.scrollbarMaxAlign=!0,e.tabStripVisible=!1,e.allowUserResize=!1,e.allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserZoom=!1,e.grayAreaBackColor="white",g.colHeaderVisible=!1,g.rowHeaderVisible=!1,g.selectionBackColor="transparent",g.selectionBorderColor="transparent",g.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},g.isProtected=!0,d.defaults.rowHeight=21,d.defaults.colWidth=23,a.length>8&&(e.showVerticalScrollbar=!0),this.Ikc(a,d),d.resumePaint(),c.resumeEvent(),this.QQ(c)},b.prototype.Ikc=function(a,b){var c,d,e=this;for(b.suspendPaint(),e.Jkc=!1,c=0;c<a.length;c++)if(a[c].status){e.Jkc=!0;break}b.setDataSource(a),b.bindColumns([{name:"status",cellType:new g.CheckBox},{name:"text"}]),b.setColumnWidth(1,500),d=b.getActualStyle(-1,2),d.hAlign=0,b.setStyle(-1,2,d),b.resumePaint()},b.prototype.Lkc=function(){var a=M+" "+O,b=M+" "+P,c=N+" "+Q,d=N+" "+R;return'<div class="'+L+'">\n                    <a class="'+c+'">\n                        <span class="'+a+'"></span>\n                        <span>'+j().PivotPanel_Filter_SelectAll+'</span>\n                    </a>\n                    <a class="'+d+'">\n                        <span class="'+b+'"></span>\n                        <span>'+j().PivotPanel_Filter_NoSelectAll+"</span>\n                    </a>\n                </div>"},b.prototype.Do=function(){var a,b,c,d,e,g,h,i,j,k,l,m=f.GC$(this.xo[0].children[0]),n=this.zo();0!==m.length&&(a=f.GC$(n).offset(),b=parseInt(m.css("left"),10)+a.left,c=parseInt(m.css("top"),10)+a.top,d=m.width(),e=m.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=document.documentElement,j=i.clientWidth,k=i.clientHeight,l=m[0].getBoundingClientRect(),l.left+d>j&&(h=l.left+d-j),l.top+e>k&&(g=l.top+e-k),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),m.css({left:b-a.left+"px",top:c-a.top+"px"}))))},b}(f.Go),b.PivotFilterDialog=da},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=new e.Common.ResourceManager(f.SR),i=h.getResource.bind(h),j=e.Common.u,k=d.Ul.Nl,l="cancel-icon",m="cancel-class",n="ok-label",o="filter-confirm",p="number-group-startingAt-isActive",q="number-group-startingAt-value",r="number-group-endingAt-isActive",s="number-group-endingAt-value",t="number-group-by-value",u="number-group-dialog-sub-container",v=function(a){w(b,a);function b(b,c,d,e,f,g,h,i,j){var k=a.call(this,b,0,!0)||this;return k.dQc=c,k.$ic=d,k.vic=e,k.Tlc=g||0,k.eQc=f,k.fQc=f===k.Tlc,k.Ulc=i||0,k.gQc=h,k.hQc=h===k.Ulc,k.CQc=j,k.Eo(),k}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(k("div"));a[0].innerHTML=this.jQc(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+m).bind("click",function(b){a.WT()}),d.GC$("."+n).bind("click",function(b){var c=a.dQc,e=a.$ic,f=parseInt(d.GC$("."+q).val().trim(),10),h=parseInt(d.GC$("."+s).val().trim(),10),i=parseInt(d.GC$("."+t).val().trim(),10);a.vic.nic({cmd:"pivotTableGroup",cmdOption:{dataType:g.PivotDataType.number,fieldName:e,pivotName:c,startingAtValue:f,endingAtValue:h,groupByValue:i}}),a.WT()}),d.GC$("."+q).bind("change",function(b){a.fQc=!1,d.GC$("."+p)[0].checked=!1}),d.GC$("."+s).bind("change",function(b){a.hQc=!1,d.GC$("."+r)[0].checked=!1}),d.GC$("."+p).bind("click",function(b){this.checked&&d.GC$("."+q).val(a.eQc)}),d.GC$("."+r).bind("click",function(b){this.checked&&d.GC$("."+s).val(a.gQc)})},b.prototype.jQc=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                      <span class="'+(m+" "+l)+'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+p+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+q+'" value = '+this.Tlc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+r+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+s+'" value = '+this.Ulc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <span style = "margin-left: 24px">'+i().groupBy+'</span>\n                            <input class="'+t+'" value= '+this.CQc+'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="'+(m+" "+o)+'">'+i().Cancel+'</span>\n                            <span class="'+(n+" "+o)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+m).unbind("click"),d.GC$("."+n).unbind("click")},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotNumberGroupDialog=v},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=f.Common.u,k=d.Ul.Nl,l="show-value-as-dialog-container",m="show-value-as-dialog-header",n="show-value-as-dialog-content",o="cancel-icon",p="cancel-class",q="ok-label",r="filter-confirm",s="show-value-as-dialog-content-item",t="show-value-as-dialog-content-select",u=".baseFieldList",v=".baseFieldItem",w=function(a){x(b,a);function b(b,c,d,e,f,g){var h,j,k,l,m,n,o,p=a.call(this,b,0,!0)||this;if(p.vic=c,p.$ic=d,p.hi=g,p._ic=e,f){if(p.ADc=f.valueFieldName,h=void 0,j=p.vic.Jhc,k=p.vic.Khc,4===f.menuArea)if(4===f.area){for(l=f.rowInfos&&f.rowInfos.length-1;l>=0;l--)if(f.rowInfos[l].fieldName!==i().sigmaValue){h=f.rowInfos[l];break}}else 3===f.area?(m=f.activeRowFieldInfo&&f.activeRowFieldInfo.index,0===m?m+=1:m===f.rowInfos&&f.rowInfos.length-1?m=f.rowInfos.length-2:m-=1,h=f.rowInfos[m]):2===f.area&&(n=void 0,o=void 0,j[0]?(n=j[0]&&j[0].Cj,o=j[0]._items[0].value):k[0]&&(n=k&&k[0].Cj,o=k[0]._items[0].value),h={fieldNameTemp:n,itemNameTemp:o});p.DQc=h.fieldName,p.EQc=h.itemName}return p.Eo(),p.Ao(),p}return b.prototype.Ao=function(){this.Bla(this.hi,this.ADc,this.FQc()),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.FQc=function(){return this.vic.Shc(1).concat(this.vic.Shc(2))},b.prototype.getBaseItemList=function(a){return this.vic.SFc(a).slice()},b.prototype.Bla=function(a,b,c){var e=d.GC$(k("div"));e[0].innerHTML=this.jQc(a,b,c),this.xo.append(e)},b.prototype.Ql=function(a,b,c){var d="";return c&&(d="selected"),'<option value="'+b+'" '+d+">"+j.Ob(a)+"</option>"},b.prototype.LXa=function(){var a=this;d.GC$("."+p).bind("click",function(b){a.WT()}),d.GC$("."+q).bind("click",function(b){var c,e=a.vic,f=d.GC$(u)[0],g=d.GC$(v)[0],h=f&&f.options[f.selectedIndex].text;g&&(c={index:g.selectedIndex,value:g.options[g.selectedIndex].text}),e.nic({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:a.hi,pivotName:a._ic,fieldName:a.$ic,baseField:h,baseItem:c}}),a.WT()}),d.GC$(u).bind("change",function(b){var c,f,g,h;if(!e.Fa(d.GC$(v)[0])){for(c=d.GC$(this.options[this.selectedIndex]).text(),f=a.vic.SFc(c).slice(),g="",f&&f.length>0&&(f.unshift(i().BaseItemNext),f.unshift(i().BaseItemPrevious)),h=0;h<f.length;h++)g+=a.Ql(f[h],h);d.GC$(v)[0].innerHTML=g}})},b.prototype.jQc=function(a,b,c){var d,f,g,h,j,k,u,v,w,x=[4,8,9],y="",z="",A=this.vic.getFieldInfoByName(this.ADc).pNc;for(A&&(f=A.showDataAs,g=A.baseFieldName,h=A.baseFieldItem,j=A.baseFieldItemType),k=a===f&&g||this.DQc,u=0;u<c.length;u++)d=k===c[u].Cj,y+=this.Ql(c[u].Cj,u,d);for(v=this.getBaseItemList(k),v&&v.length>0&&(v.unshift(i().BaseItemNext),v.unshift(i().BaseItemPrevious)),u=0;u<v.length;u++)d=e.Fa(h)?j===e.PivotShowDataAsBaseItemType.next&&1===u||j===e.PivotShowDataAsBaseItemType.previous&&0===u:h===v[u]||v[u]===this.EQc,z+=this.Ql(v[u],u,d);return w=x.indexOf(a)>-1?' <div class="'+s+'">\n                <span>'+i().BaseItemForDialog+'</span>\n                <select class="'+t+' baseFieldItem">'+z+"</select>\n               </div>":"",'<div class="'+l+'">\n                    <div class="'+m+'">\n                        <span>'+(i().ShowValueAs+"("+b+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+n+'">\n                        <div>\n                            <span>'+i().CalculationForDialog+"</span>\n                            <span>"+i().showValueAsDialog[a]+'</span>\n                        </div>\n\n                        <div class="'+s+'">\n                            <span>'+i().BaseFieldForDialog+'</span>\n                            <select class="'+t+' baseFieldList">'+y+"</select>\n                        </div>\n                        "+w+'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="'+(p+" "+r)+'">'+i().Cancel+'</span>\n                            <span class="'+(q+" "+r)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+p).unbind("click"),d.GC$("."+q).unbind("click"),d.GC$(u).unbind("change")},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotShowValueAsDialog=w},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f="gc-panel-button-delete",g="gc-panel-view-name",h="gc-panel-selected-view",i=function(a){j(b,a);function b(b,c,d){var e=a.call(this,b,0)||this;return e.views=c,e.currentViewName="",e.width=d,e}return b.prototype.init=function(b){a.prototype.ad.call(this),this.open(b)},b.prototype.open=function(a){var b,c,d,h="<ul>";e.vhc(this.views.all(),function(a){h+='<li>\n                        <span class="'+g+'">'+a.name+'</span>\n                        <input type="button" class="gc-panel-button '+f+'" value="\xd7"/>\n                    </li>'}),h+="</ul>",b=this.width||250,c='\n                <div class="gc-panel-viewList" style="width: '+b+'px"">\n                    '+h+"\n                </div>\n                ",d=this.Sla(a.x,a.y),d.html(c),this.Ao(),this.QQ()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c},b.prototype.Ao=function(){a.prototype.Ao.call(this)},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.qo=null,this.views=null},b.prototype.Do=function(){var a,b,c,e,f,g,h=d.GC$(this.xo.get(0).firstElementChild),i=d.GC$(this.xo);0!==h.length&&(a=h.width(),b=parseInt(i.css("left"),10),isNaN(b)||isNaN(a)||(c=0,e=document.documentElement,f=e.clientWidth,g=h[0].getBoundingClientRect(),g.left+a>f&&(c=g.left+a-f),(b<0||c>0)&&(b-=c,b<0&&(b=0),i.css({left:b+"px"}))))},b.prototype.QQ=function(){var a=this;d.GC$("."+f).bind("click",function(b){var c=b.target.previousElementSibling.textContent,d=b.target.parentElement;a.views.remove(c),d.remove()}),d.GC$("."+g).bind("click",function(b){var c=b.target.textContent;d.GC$("#"+h).val(c),a.close()})},b.prototype.Tla=function(){d.GC$("."+f).unbind("click"),d.GC$("."+g).unbind("click")},b}(d.Go),b.PivotViewListDialog=i},"./dist/plugins/pivot/pivot-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],i=d.Common.j.Fa,j=d.Common.CultureManager,k=d.Common.l,l=d.Common.D,m=new d.Common.ResourceManager(f.SR),n=m.getResource.bind(m);function o(a,b,c){var d=a[b];return d&&d.length>0?d[c]:c}b.mjc=o;function p(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=p(a[c]);return b}if(e){b=void 0;for(c in a)i(a[c])||(void 0===b&&(b={}),b[c]=p(a[c]));return b}return a}b.GNc=p;function q(a){return i(a)||""===a}b.XNc=q;function r(a,b,c){var d,e={_ps:{}};for(d in a)l(a,d)&&(s(e,d,b,c),e[d]=a[d]);return e}b.Ql=r;function s(a,b,c,d){Object.defineProperty(a,b,{get:function(){return this._ps[b]},set:function(a){var e,f,g=this._ps[b];g!==a&&(c.RVa({pivotTable:this,pn:b,old:g,value:a,type:"options"}),this._ps[b]=a,"subTotalsPosition"===b&&(e="subtotalsPosition",this._ps[e]=a),"subtotalsPosition"===b&&(e="subTotalsPosition",this._ps[e]=a)),"missingCaption"!==b||i(a)||(f=(a+"").toUpperCase(),"TRUE"!==f&&"FALSE"!==f||(this._ps.missingCaption="'"+a)),"allowMultipleFiltersPerField"===b&&(!!g==!0&&!!a==!1&&c.aQc(),c.vic&&c.vic.RNc(!!a)),"printDrill"!==b&&"itemPrintTitles"!==b&&"fieldPrintTitles"!==b&&"function"==typeof d&&d()},enumerable:!0})}b.nameSeparator="_";function t(a,c){var d,e=a.split(b.nameSeparator);return isNaN(parseInt(e[e.length-1],10))?a+=b.nameSeparator+"1":(d=e[e.length-1],e.splice(e.length-1,1,b.nameSeparator+(parseInt(d,10)+1)),a=e.join("")),c.ckc[a]&&(a=t(a,c)),a}b.iua=t;function u(a,b){var c,d,e,f,g,h,i,j,k,l=[];if(!b)return l;for(c=a.pivotTables.all(),d=0;d<c.length;d++)e=c[d],f=e.getRange(),g=f.page,h=f.content,i=g?g.union(h):h,j=b.row===-1?i.row:i.row-b.row,k=b.col===-1?i.col:i.col-b.col,b.containsRange(i)&&l.push({name:e.Cj,sheetName:a.name(),startPoint:[j,k]});return l}b.QOc=u;function v(a,b){var c=a.pivotTables.all(),d=[];return g.vhc(c,function(a){var c,e,f,g,h;a.iT()||(c=a.getRange(),e=c.page,f=c.content,e&&(g=e.intersect(b.row,b.col,b.rowCount,b.colCount),g&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(e,0,0)):d[a.Cj]=[b.getIntersect(e,0,0)])),h=f.intersect(b.row,b.col,b.rowCount,b.colCount),h&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(f,0,0)):d[a.Cj]=[b.getIntersect(f,0,0)]))}),d}b.TOc=v;function w(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1}function x(a){var b,c,d;for(b=0,c=h;b<c.length;b++)if(d=c[b],!i(a[d]))return!1;return!0}b.gOc=x,b.applyShowDataAsStyle=function(a,b,c,d){var f,g={dataOnly:!0,references:[{fieldName:n().Values,items:[b]}]},h=a.getStyle(g);h&&(f=p(h)),f||(f=new e.Style),d?f.formatter=d:w(c)?f.formatter="0.00%":(delete f.formatter,x(f)&&(f=null)),a.setStyle(g,f)},b.GWc=function(a,b,c){var d,e={dataOnly:!0,references:[{fieldName:n().Values,items:[b]}]},f=a.getStyle(e);f&&(d=p(f)),d&&"0.00%"===d.formatter&&w(c)&&(delete d.formatter,a.setStyle(e,d))};function y(a){var b=j.q4(j.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),k.Vb(a,c)}b.formatDateToString=y},"./dist/plugins/pivot/pivot.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/pivot/pivot.res.en.js");b.SR={en:d}},"./dist/plugins/pivot/pivot.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RepeatName="Repeat Name",b.NotExist="Not Exist",b.SubtotalType_Prefix_0="Average of ",b.SubtotalType_Prefix_1="Count of ",b.SubtotalType_Prefix_2="CountNums of ",b.SubtotalType_Prefix_3="Max of ",b.SubtotalType_Prefix_4="Min of ",b.SubtotalType_Prefix_5="Product of ",b.SubtotalType_Prefix_6="StdDev of ",b.SubtotalType_Prefix_7="StdDevp of ",b.SubtotalType_Prefix_8="Sum of ",b.SubtotalType_Prefix_9="Var of ",b.SubtotalType_Prefix_10="Varp of ",b.ColumnLabels="Column Labels",b.Total=" Total",b.All="All",b.MultipleItems="Multiple Items",b.RowLabels="Row Labels",b.GrandTotal="Grand Total",b.Values="Values",b.PivotPanel_Title="PivotTable Fields",b.PivotPanel_ReportText="Choose fields to add to report",b.PivotPanel_SearchPlaceholder="Search",b.PivotPanel_FieldAreaText="Drag fields between areas below:",b.PivotPanel_FiltersItemsTitle="Filters",b.PivotPanel_RowsItemsTitle="Rows",b.PivotPanel_ColumnsItemsTitle="Columns",b.PivotPanel_ValuesItemsTitle="Values",b.PivotPanel_DeferUpdateText="Defer Layout Update",b.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",b.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",b.PivotPanel_Update="Update",b.PivotPanel_DropDownList_Up="Move Up",b.PivotPanel_DropDownList_Down="Move Down",b.PivotPanel_DropDownList_Beginning="Move to Beginning",b.PivotPanel_DropDownList_End="Move to End",b.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",b.PivotPanel_DropDownList_Row="Move to Row Labels",b.PivotPanel_DropDownList_Col="Move to Column Labels",b.PivotPanel_DropDownList_Values="Move to Values",b.PivotPanel_DropDownList_Remove="Remove Field",b.PivotPanel_DropDownList_Set="Field Settings...",b.PivotPanel_DropDownList_ValueSet="Value Field Settings...",b.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",b.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",b.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",b.PivotPanel_Fields_MoveTo_Value="Add to Values",b.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",b.PivotPanel_ValueFilterOrLabel_Equals="Equals...",b.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",b.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",b.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",b.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_Between="Between...",b.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",b.PivotPanel_ValueFilter_Top10="Top 10...",b.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",b.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",b.PivotPanel_ValueFilterOrLabel_End="Ends With...",b.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",b.PivotPanel_ValueFilterOrLabel_Contain="Contains...",b.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",b.ValueFilterOrLabel_Equals="equals",b.ValueFilterOrLabel_NotEqual="does not equal",b.ValueFilterOrLabel_GreaterThan="greater than",b.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",b.ValueFilterOrLabel_LessThan="less than",b.ValueFilterOrLabel_LessOrTo="less than or equal to",b.ValueFilterOrLabel_Between="between",b.ValueFilterOrLabel_NotBetween="not between",b.ValueFilterOrLabelSelect_GreaterThan="is greater than",b.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",b.ValueFilterOrLabelSelect_LessThan="is less than",b.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",b.ValueFilterOrLabelSelect_Between="is between",b.ValueFilterOrLabelSelect_NotBetween="is not between",b.ValueFilterOrLabel_IsBeginWith="begins with",b.ValueFilterOrLabel_NotBegin="does not begin with",b.ValueFilterOrLabel_End="ends with",b.ValueFilterOrLabel_NotEndWith="does not end with",b.ValueFilterOrLabel_Contain="contains",b.ValueFilterOrLabel_NotContain="does not contain",b.PivotPanel_ValueFilterOrLabel_Before="Before...",b.PivotPanel_ValueFilterOrLabel_After="After...",b.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",b.PivotPanel_ValueFilterOrLabel_Today="Today",b.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",b.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",b.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",b.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",b.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",b.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",b.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",b.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",b.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",b.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",b.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",b.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",b.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",b.PivotPanel_ValueFilterOrLabel_YearToDate="Year To Date",b.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",b.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",b.PivotPanel_Sort_A_Z="Sort A to Z",b.PivotPanel_Sort_Z_A="Sort Z to A",b.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",b.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",b.PivotPanel_Sort_More="More Sort Options...",b.PivotPanel_Filter_Clear="Clear Filter From {0}",b.PivotPanel_Filter_Label="Label Filters",b.PivotPanel_Filter_Value="Value Filters",b.PivotPanel_Date_Filter="Date Filters",b.Ok="OK",b.Cancel="Cancel",b.Format="Number Format",b.Number="Number",b.FormatCells="Format Cells",b.Sample="Sample",b.Type="Type",b.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],b.Select_Field="Select field",b.PivotPanel_Filter_SelectAll="Check All",b.PivotPanel_Filter_NoSelectAll="Uncheck All",b.PivotPanel_Filter_Search="search",b.Label_Title="Label Filter",b.Label_Show="Show items for which the label",b.Use_Single_Character="Use ? to represent any single character",b.Use_Series_Characters="Use * to represent any series characters",b.Value_Show="Show items for which",b.Value_Title="Value Filter",b.Top_Ten_Filter="Top 10 Filter ",b.TopTenShow="show",b.Top="Top",b.Bottom="Bottom",b.Top_Item="Items",b.Top_Percent="Percent",b.Top_Sum="Sum",b.ByJoiner="by",b.AndJoiner="and",b.Q1="Quarter 1",
b.Q2="Quarter 2",b.Q3="Quarter 3",b.Q4="Quarter 4",b.Jan="January",b.Feb="February",b.Mar="March",b.Apr="April",b.May="May",b.Jun="June",b.Jul="July",b.Aug="August",b.Sep="September",b.Oct="October",b.Nov="November",b.Dec="December",b.IsBefore="is before",b.IsBeforeOrEqual="is before or equal to",b.IsAfter="is after",b.IsAfterOrEqual="is after or equal to",b.IsBetween="is between",b.IsNotBetween="is not between",b.DateFilterTitle="Date Filter",b.DateShow="Show items for which the date",b.WholeDays="Whole Days",b.wmk1="4164642d6f6e73204e6f7420456e61626c65643a205069766f745461626c65",b.wmk2="4164642d6f6e7320456e61626c65643a205069766f745461626c65",b.FieldSetting="Field Settings",b.ValueSetting="Value Field Settings",b.SourceName="Source Name:",b.CustomName="Custom Name:",b.SummarizeValue="Summarize Values By",b.ShowValueAs="Show Value As",b.CalculationForDialog="Calculation: ",b.BaseFieldForDialog="Base Field: ",b.BaseItemForDialog="Base Item: ",b.BaseItemNext="(next)",b.BaseItemPrevious="(previous)",b.SummarizeValueField="Summarize values field by",b.ShowValueAsField="Show value as",b.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",b.Sum="Sum",b.Count="Count",b.Average="Average",b.Max="Max",b.Min="Min",b.Product="Product",b.CountNumbers="Count Numbers",b.StdDev="StdDev",b.StdDevp="StdDevp",b.Var="Var",b.Varp="Varp",b.sigmaValue="\u2211 Values",b.sigmaValueTemp="Values",b.DateFormatError="This isn't a valid date",b.noCalculation="No Calculation",b.percentGrandTotal="% of Grand Total",b.percentColumnTotal="% of Column Total",b.percentRowTotal="% of Row Total",b.percentEllipsis="% Of ...";b.percentParentRowTotal="% of Parent Row Total";b.percentParentColumnTotal="% of Parent Column Total",b.percentParentTotal="% of Parent Total ...",b.difference="Difference From ...",b.percentDifference="Of Difference From ...",b.runningTotal="Running Total In ...",b.percentRunningTotal="% Running Total In ...",b.rankSmallestLargest="Rank Smallest to Largest ...",b.rankLargestSmallest="Rank Largest to Smallest ...",b.index="Index",b.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","Of Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],b.baseField="Base field:",b.baseItem="Base item:",b.grouping="Grouping",b.auto="Auto",b.startingAt="Starting at:",b.endingAt="Ending at:",b.groupBy="By:",b.seconds="Seconds",b.minutes="Minutes",b.hours="Hours",b.days="Days",b.months="Months",b.quarters="Quarters",b.years="Years",b.numberOfDays="Number of days",b.NoHaveSpread="workbook exception",b.SourceError="Source data exception, cannot create PivotTable report",b.SourceNotIsTableNameOrFormula="source data not is table name and formula",b.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",b.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",b.Views="Views",b.Group="Group",b.param_error="the param is null or undefine",b.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",b.DefaultPivotTableViewName="PivotView",b.toolTipContent_Row="Row: ",b.toolTipContent_Column="Column: ",b.toolTipContent_Value="Value: ",b.toolTipContent_NoValue="No value",b.deferLayoutUpdate="Defer Layout Update";function d(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabel_IsBeginWith,b.ValueFilterOrLabel_NotBegin,b.ValueFilterOrLabel_End,b.ValueFilterOrLabel_NotEndWith,b.ValueFilterOrLabel_Contain,b.ValueFilterOrLabel_NotContain,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getStringLabelFilterItemText=d;function e(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.IsBefore,b.IsBeforeOrEqual,b.IsAfter,b.IsAfterOrEqual,b.IsBetween,b.IsNotBetween]}b.getDateLabelFilterItemText=e;function f(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo]}b.getNumberLabelFilterItemText=f;function g(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getValueFilterItemText=g,b.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",b.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",b.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",b.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",b.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",b.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",b.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",b.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",b.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",b.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",b.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",b.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",b.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: "},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("SheetsCalc"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=c("./dist/plugins/pivot/pivot.ns.js"),k=new e.Common.ResourceManager(j.SR),l=k.getResource.bind(k),m="__rangeFormula__",n="__fieldName__",o="__ColInfo__",p="__RowInfo__",q=null,r=[{row:-1,rowCount:1,colCount:1},{}],s=[{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{type:h.PivotAreaType.corner,labelOnly:!0}],t=[{colCount:1,needGrandCol:!0,nullValue:!1},{row:0,rowCount:1,colCount:1,nullValue:!1},{rowCount:1,nullValue:!1}],u=[{labelOnly:!0,grandCol:!0},{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{labelOnly:!0,references:o}],v=[{rowCount:1,needGrandRow:!0,nullValue:!1},{colCount:1,nullValue:!1}],w=[{labelOnly:!0,grandRow:!0},{labelOnly:!0,references:p}],x=[{nullValue:!1,needGrandRow:!0,needGrandCol:!0},{nullValue:!1,rowCount:1,needGrandRow:!0},{nullValue:!1,colCount:1,needGrandCol:!0},{}],y=[{grandRow:!0,grandCol:!0,references:p+o},{grandRow:!0,references:p+o},{grandCol:!0,references:p+o},{references:p+o}];function A(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(a&&b){for(c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=a.getPivotInfo(c,d),h=a.getPivotInfo(c+e-1,d+f-1),i=g.area,j=h.area,k=K(i,j),l=[],k.indexOf(0)!==-1&&(m=L(0,a),n=b.getIntersect(m,0,0),l=F(a,n)),o=1;o<5;o++)k.indexOf(o)!==-1&&(m=L(o,a),n=b.getIntersect(m,0,0),p=[],n&&B(n,n.row,n.col,a,p,a.ys.Uic[o]),l=l.concat(E(p,o,a)));return l}}b.rangeToAreas=A;function B(a,b,c,e,f,g){var h,i,j=b,k=c,l=e.getPivotInfo(b,c),m=C(l),n=g.ILa;if(1===n||2===n&&0===l.relativeRow)(1===n&&!l.cornerFieldInfo||2===n&&!l.colHeadFieldInfo)&&(k=a.col+a.colCount-1,1===n&&b===a.row&&(j=a.row+a.rowCount-(1===a.rowCount?1:2)));else{for(i=c+1;i<c+a.colCount;i++){if(h=l,l=e.getPivotInfo(j,i),D(h,l,j,i,a,m,g,!1)){k=i-1;break}i===c+a.colCount-1&&(k=i)}for(i=b+1;i<b+a.rowCount;i++){if(h=l,l=e.getPivotInfo(i,k),D(h,l,i,k,a,m,g,!0)){j=i-1;break}i===b+a.rowCount-1&&(j=i)}}f.push(new d.Range(b,c,j-b+1,k-c+1)),j===a.row+a.rowCount-1&&k===a.col+a.colCount-1||(k===a.col+a.colCount-1?B(a,j+1,a.col,e,f,g):B(a,b,k+1,e,f,g))}!function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col"}(z||(z={}));function C(a,b,c){var d,e=a.rowInfos,f=a.colInfos,g=z.none;if(e&&!c)for(d=0;d<e.length;d++)(e[d].isSubtotal||e[d].isGrandTotal)&&(g+=z.row);if(f&&!b)for(d=0;d<f.length;d++)(f[d].isSubtotal||f[d].isGrandTotal)&&(g+=z.col);return g}function D(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=g.ILa;if(c>e.row+e.rowCount-1||d>e.col+e.colCount-1)return!0;if(a&&b)if(h){if(3===g.ILa){if(i=g.Nic,i&&(j=i[a.relativeRow],k=i[b.relativeRow],j&&k&&j.aN!==k.aN))return!0}else if(a.rowInfos&&b.rowInfos&&a.rowInfos.length!==b.rowInfos.length)return!0}else if(a.colInfos&&b.colInfos&&a.colInfos.length!==b.colInfos.length)return!0;if(4===n&&f){if(h&&f===z.col&&C(b,!0))return!0;if(!h&&f===z.row&&C(b,void 0,!0))return!0}else if(C(b))return!0;if(3===n&&!f&&!h)return!0;if(2===n&&!f&&h)return!0;if(f)if(3===n&&h){if(l=g.Nic[b.relativeRow],m=g.Nic[b.relativeRow-1],l.path!==m.path)return!0}else if(2!==n||h){if(4===n&&(f&z.row&&h||f&z.col&&!h))return!0}else if(l=g.Oic[b.relativeColumn],m=g.Oic[b.relativeColumn-1],l.path!==m.path)return!0;return!1}function E(a,b,c){switch(b){case 1:return G(c,a);case 2:return H(c,a);case 3:return I(c,a);case 4:return J(c,a)}}function F(a,b){var c,d,e,f=[];for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)e=a.getPivotInfo(c,d),e.relativeColumn%3===1?f.push({labelOnly:!0,references:[{fieldName:e.pageFieldInfo.fieldName}]}):e.relativeColumn%3===0&&f.push({labelOnly:!0,type:h.PivotAreaType.button,fieldName:e.pageFieldInfo.fieldName});return f}function G(a,b){var c=[],d=a.ys.Uic[1].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(r,s,k,b,d,a,1);l!==q&&c.push(l)}),c}function H(a,b){var c=[],d=a.ys.Uic[2].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(t,u,k,b,d,a,2);l!==q&&c.push(l)}),c}function I(a,b){var c=[],d=a.ys.Uic[3].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(v,w,k,b,d,a,3);l!==q&&c.push(l)}),c}function J(a,b){var c=[],d=a.ys.Uic[4].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(x,y,k,b,d,a,3);l!==q&&c.push(l)}),c}function K(a,b){if(0===b)return[0];if(1===b)return[1];if(3===b)return 1===a?[1,3]:[3];if(2===b)return 1===a?[1,2]:[2];if(4===b){if(1===a)return[1,2,3,4];if(2===a)return[2,4];if(3===a)return[3,4];if(4===a)return[4]}}function L(a,b){var c,d;return b.iT()||f.Fa(a)?q:0===a?b.getRange().page:(c=b.ys.Uic,d=c[a].getRange(),d.row+=b.$jc.row,d.col+=b.$jc.col,d)}function M(a,b,c,d,e,f,g){var h,i,j;for(h=0;h<a.length;h++)if(i=N(a[h],e),j=f.getPivotInfo(d.row,d.col),U(i,c,j,f))return P(b[h],c,d,j,f,g);return q}function N(a,b){var c=i.GNc(a)||{};return a.row===-1&&(c.row=b.rowCount-1),a.col===-1&&(c.col=b.colCount-1),c}function O(a){return a===l().sigmaValue?l().Values:a}function P(a,b,c,d,e,f){var h,j=i.GNc(a)||{};if(a.offset===m&&(j.offset=g.rangeToFormula(b,0,0,g.RangeReferenceRelative.allRelative,!1)),a.fieldName===n){if(h=Q(d,c,f),!h)return q;j.fieldName=O(h)}return a.references===o&&(j.references=R(c,e)),a.references===p&&(j.references=S(c,e)),a.references===p+o&&(j.references=T(c,e)),j}function Q(a,b,c){var d;switch(c){case 1:return d=a.cornerFieldInfo,d.fieldName||q;case 2:if(d=a.colHeadFieldInfo)return d.fieldName;d=a.activeColFieldInfo;break;case 3:d=a.activeRowFieldInfo}return d?d.name:q}function R(a,b){var c,d,e=[],g=a.row,h=function(c){var d,h=b.getPivotInfo(g,c);return h.value===q?"break":(d=h.colInfos,void(d&&f.vhc(d,function(b,f){if(c===a.col){var g={fieldName:O(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.col;c<a.col+a.colCount&&(d=h(c),"break"!==d);c++);return e}function S(a,b){var c,d,e=[],g=a.col,h=function(c){var d,h=b.getPivotInfo(c,g);return h.value===q?"break":(d=h.rowInfos,void(d&&f.vhc(d,function(b,f){if(c===a.row){var g={fieldName:O(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.row;c<a.row+a.rowCount&&(d=h(c),"break"!==d);c++);return e}function T(a,b){var c,d,e=[],g=[],h=a.row,i=a.col,j=function(c){var d,g=b.getPivotInfo(c,i),h=g.rowInfos;h&&(d=0,f.vhc(h,function(b){if(c===a.row){if(b.fieldName&&b.itemName){var f={fieldName:O(b.fieldName),items:[b.itemName]};b.isSubtotal&&(f.subtotal=!0),e[d]&&(d+=1),e[d]=f}}else d===h.length-1&&e[d].items.push(b.itemName),d+=1}))};for(c=a.row;c<a.row+a.rowCount;c++)j(c);for(d=function(c){var d,e=b.getPivotInfo(h,c),i=e.colInfos;i&&(d=0,f.vhc(i,function(b){if(c===a.col){if(b.fieldName&&b.itemName){var e={fieldName:O(b.fieldName)};f.Fa(b.itemName)||(e.items=[b.itemName]),b.isSubtotal&&(e.subtotal=!0),g[d]&&(d+=1),g[d]=e}}else d===i.length-1&&g[d].items.push(b.itemName),d+=1}))},c=a.col;c<a.col+a.colCount;c++)d(c);return e.concat(g)}function U(a,b,c,d){var e=a.row,f=a.col,g=a.rowCount,h=a.colCount,i=a.nullValue;return(void 0===e||b.row===e)&&((void 0===f||b.col===f)&&((void 0===g||b.rowCount===g)&&((void 0===h||b.colCount===h)&&((void 0===i||!(i&&c.value!==q||!i&&c.value===q))&&(!(a.needGrandCol&&!V(c,!1,!0))&&!(a.needGrandRow&&!V(c,!0,!1)))))))}function V(a,b,c){var d=a.rowInfos,e=a.colInfos,g=!1;return b&&d&&d.length>0&&f.vhc(d,function(a){a.isGrandTotal&&(g=!0)}),c&&e&&e.length>0&&f.vhc(e,function(a){a.isGrandTotal&&(g=!0)}),g}},"./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js":function(a,b,c){var d,e,f="object"==typeof f?f:{};f.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./pivot-entry.ts")}({"./pivot-entry.ts":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivotEngine.res.en.ts"),b.SR={en:d.resource},f(c("./src/pivot-interface.ts")),f(c("./src/pivot-util.ts")),f(c("./src/pivot-condition.ts")),f(c("./src/pivot-cache.ts")),f(c("./src/data-analyzer.ts")),f(c("./src/pivot-engine.ts")),f(c("./src/pivot-calc-engine.ts")),e=c("./src/pivot-sort.ts"),b._Rc=e._Rc},"./src/data-analyzer.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=c("CalcEngine"),g=null,h=Math.min,i=Math.max,j=Math.sqrt,k=isNaN,b.Separator="-&-",b.EmptyValue=f.Errors.Null;function C(a,b,c){if(a instanceof f.CalcError)return a;if(b instanceof f.CalcError)return b;switch(c){case 0:return a+b;case 1:return a-b;case 2:return a*b;case 3:return 0===b?f.Errors.DivideByZero:a/b;case 5:return i(a,b);case 6:return h(a,b);case 4:return j(a)}}b.Mkc=function(a,b){var c,d,f,g,h,i,j,k=b.calc;!e.Fa(a)&&e.Da(a)?(c=k.count,d=k.sum,f=k.max,g=k.min,h=k.sumx2,i=k.product,j=k.len,c++,d=C(d,a,0),f=C(f,a,5),g=C(g,a,6),h=C(h,C(a,a,2),0),i=C(i,a,2),j++,b.calc={count:c,sum:d,max:f,min:g,sumx2:h,product:i,len:j}):b.calc.len++},b.Nkc=function(a){return e.Fa(a)?{calc:{len:1,sum:0,count:0,max:-(1/0),min:1/0,sumx2:0,product:1}}:e.Da(a)?{calc:{len:1,count:1,sum:a,max:a,min:a,sumx2:a*a,product:a}}:a instanceof f.CalcError?{calc:{len:1,count:0,sum:a,max:a,min:a,sumx2:a,product:a}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},l=function(a,b){var c=b.calc,d=c.sum,e=c.count,f=c.max,g=c.min,h=c.sumx2,i=c.product,j=c.len;return a({sum:d,count:e,max:f,min:g,sumx2:h,product:i,len:j})},b.Okc=function(a){switch(a){case d.SubtotalType.average:return function(a){var b=a.sum,c=a.count;return b instanceof f.CalcError?b:C(b,c,3)};case d.SubtotalType.count:return function(a){var b=a.len;return b};case d.SubtotalType.countNums:return function(a){var b=a.count;return b};case d.SubtotalType.max:return function(a){var b=a.max;return b};case d.SubtotalType.min:return function(a){var b=a.min;return b};case d.SubtotalType.product:return function(a){var b=a.product;return b};case d.SubtotalType.stdDev:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=C(C(b,c,2),C(d,d,2),1),f=C(b,C(b,1,1),2),g=C(0,C(e,f,3),5);return C(g,null,4)};case d.SubtotalType.stdDevp:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=C(C(b,c,2),C(d,d,2),1),f=C(b,b,2),g=C(0,C(e,f,3),5);return C(g,null,4)};case d.SubtotalType.sum:return function(a){return a&&a.sum};case d.SubtotalType.varr:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=C(C(b,c,2),C(d,d,2),1),f=C(b,C(b,1,1),2),g=C(0,C(e,f,3),5);return g};case d.SubtotalType.varp:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=C(C(b,c,2),C(d,d,2),1),f=C(b,b,2),g=C(0,C(e,f,3),5);return g}}},m=function(a,b){return b(a)},n=function(a,b,c,f,g,h){var i,j,k=a.showDataAs,l=h.baseMinorPath,m=h.baseMajorPath,n=h.percentOfBasePath,o=h.baseIndex;switch(k){case d.PivotShowDataAs.normal:return{baseIndex:-1};case d.PivotShowDataAs.percentOfTotal:return{baseIndex:c.GQc};case d.PivotShowDataAs.percentOfRow:return b.Ajc?{baseIndex:c.GQc}:{baseIndex:c.BOc(b.yOc,!1)};case d.PivotShowDataAs.percentOfCol:return b.Ajc?{baseIndex:c.GQc}:{baseIndex:c.BOc(b.FOc,!0)};case d.PivotShowDataAs.percent:case d.PivotShowDataAs.difference:case d.PivotShowDataAs.percentDiff:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.percentOfParentRow:return{parentPath:g,minorPath:b.FOc};case d.PivotShowDataAs.percentOfParentCol:return{baseIndex:b.aN>f?b.HQc:b.AOc};case d.PivotShowDataAs.percentOfParent:return a.baseRootLevel>-1?{percentOfBasePath:n,minorPath:b.FOc}:{baseIndex:o,percentOfBasePath:n};case d.PivotShowDataAs.runTotal:case d.PivotShowDataAs.percentOfRunningTotal:case d.PivotShowDataAs.rankAscending:case d.PivotShowDataAs.rankDescending:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.index:return i=void 0,j=void 0,b.Ajc?(i=c.GQc,j=c.GQc):(i=c.BOc(b.yOc,!1),j=c.BOc(b.FOc,!0),e.Fa(i)&&(i=c.GQc),e.Fa(j)&&(j=c.GQc)),{rowTotalIndex:i,colTotalIndex:j}}},o=function(a,c,g,h,i,j,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=i.indexInfo,V=a.jOc[l];if(U&&(m=U.baseIndex,n=U.parentPath,o=U.minorPath,p=U.rowTotalIndex,q=U.colTotalIndex,r=U.baseMinorPath,s=U.baseMajorPath,t=U.percentOfBasePath,V))switch(u=V.showDataAs,v=void 0,w=void 0,u){case d.PivotShowDataAs.normal:return a.IQc(g,c,h);case d.PivotShowDataAs.percentOfTotal:return v=a.IQc(g,c,h),w=a.IQc(a.GQc,c,h),k(+v)?v:k(+w)?w:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percentOfRow:case d.PivotShowDataAs.percentOfCol:return v=a.IQc(g,c,h),w=a.IQc(m,c,h),k(+v)?v:k(+w)?w:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percentOfParentCol:return v=a.IQc(g,c,h),w=a.IQc(m,c,h),k(+v)?f.Errors.Value:k(+w)?w:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percent:if(e.Fa(a.cRc[a.jOc[l].baseFieldName]))return f.Errors.NotAvailable;if(x=void 0,y=!0,z=!0,V.baseRootLevel>j)return b.EmptyValue;if(A=a.xOc(r),!A)return f.Errors.NotAvailable;if(0===A.level&&V.isHeaderOfPercentOrDiff)return b.EmptyValue;if(x=A.indexList[s],v=a.IQc(g,c,h),k(+v)&&(v=0,y=!1),e.Fa(x))z=!1;else{if(!V.isNextOrPrevious&&a.RWc(x,c))return f.Errors.NotAvailable;w=a.IQc(x,c,h),k(+w)&&(z=!1)}return y||z?(y&&!z&&0!==v&&V.baseFieldItemType&&(w=v,z=!0),z?v/w:f.Errors.DivideByZero):b.EmptyValue;case d.PivotShowDataAs.percentOfParentRow:return B=a.xOc(o).indexList[n],v=a.IQc(g,c,h),w=a.IQc(B,c,h),k(+v)||k(+w)?f.Errors.Value:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percentOfParent:if(e.Fa(a.cRc[a.jOc[l].baseFieldName]))return f.Errors.NotAvailable;if(V.baseRootLevel>-1){if(V.baseRootLevel+1>=j)return 1;if(C=a.xOc(o),!C)return f.Errors.NotAvailable;if(D=C.indexList[t],v=a.IQc(g,c,h),w=a.IQc(D,c,h),k(+v)&&!k(+w))return f.Errors.Value;if(k(+w))return b.EmptyValue}else if(v=a.IQc(g,c,h),w=a.IQc(m,c,h),e.Fa(m))return k(+w)?b.EmptyValue:f.Errors.Value;return 0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.difference:if(e.Fa(a.cRc[a.jOc[l].baseFieldName]))return f.Errors.NotAvailable;if(E=void 0,y=!0,z=!0,V.baseRootLevel>j)return b.EmptyValue;if(F=a.xOc(r),!F)return f.Errors.NotAvailable;if(0===F.level&&V.isHeaderOfPercentOrDiff)return b.EmptyValue;if(E=F.indexList[s],v=a.IQc(g,c,h),k(+v)&&(v=0),e.Fa(E))z=!1;else{if(G=a.RWc(E,c),G&&!V.isNextOrPrevious)return f.Errors.NotAvailable;w=a.IQc(E,c,h),k(+w)&&(z=!1)}return z||(w=0),v-w;case d.PivotShowDataAs.percentDiff:if(e.Fa(a.cRc[a.jOc[l].baseFieldName]))return f.Errors.NotAvailable;if(H=void 0,V.baseRootLevel>j)return b.EmptyValue;if(I=a.xOc(r),!I)return f.Errors.NotAvailable;if(0===I.level&&V.isHeaderOfPercentOrDiff)return b.EmptyValue;if(H=I.indexList[s],H===g)return b.EmptyValue;if(v=a.IQc(g,c,h),k(+v)&&(v=0),e.Fa(H))w=0;else{if(!V.isNextOrPrevious&&a.RWc(H,c))return f.Errors.NotAvailable;w=a.IQc(H,c,h),k(+w)&&(w=0)}return(v-w)/w;case d.PivotShowDataAs.runTotal:if(e.Fa(a.cRc[a.jOc[l].baseFieldName]))return f.Errors.NotAvailable;if(v=a.IQc(g,c,h),V.baseRootLevel>-1){if(j<V.baseRootLevel+1)return b.EmptyValue}else if(J=a.xOc(o),J.level>V.baseHeaderLevel+1)return v;return e.Fa(v)&&(v=0),w=a.JQc(l,s,r),k(+w)?w:(k(+v)?w=v:w+=v,a.KQc(l,s,r,w),w);case d.PivotShowDataAs.percentOfRunningTotal:return e.Fa(a.cRc[a.jOc[l].baseFieldName])?f.Errors.NotAvailable:V.baseRootLevel>-1&&j<V.baseRootLevel+1?b.EmptyValue:(v=a.IQc(g,c,h),e.Fa(v)&&(v=0),w=a.JQc(l,s,r),k(+w)?w:(k(+v)?w=v:w+=v,a.KQc(l,s,r,w),K=a.LQc(l,s,r),0===K||k(+K)?(a.KQc(l,s,r,f.Errors.DivideByZero),f.Errors.DivideByZero):w/K));case d.PivotShowDataAs.rankAscending:return e.Fa(a.cRc[a.jOc[l].baseFieldName])?f.Errors.NotAvailable:V.baseRootLevel>-1&&j<V.baseRootLevel+1?b.EmptyValue:(L=a.IQc(g,c,h),M=a.MQc(l,s,r),M?M[L]:b.EmptyValue);case d.PivotShowDataAs.rankDescending:return e.Fa(a.cRc[a.jOc[l].baseFieldName])?f.Errors.NotAvailable:V.baseRootLevel>-1&&j<V.baseRootLevel+1?b.EmptyValue:(N=a.IQc(g,c,h),O=a.MQc(l,s,r),O?O[N]:b.EmptyValue);case d.PivotShowDataAs.index:return v=a.IQc(g,c,h),P=a.IQc(a.GQc,c,h),Q=a.IQc(p,c,h),R=a.IQc(q,c,h),0===v?0:k(+v)?v:k(+P)?P:k(+Q)?Q:k(+R)?R:(S=v*P,T=Q*R,0===T?f.Errors.DivideByZero:S/T)}},p=function(a,c){var f={};return e.vhc(c,function(c){f[d.SubtotalType[c]]=b.Okc(c)(a)}),f},q=function(a){return a===d.PivotShowDataAs.percentOfRunningTotal||a===d.PivotShowDataAs.rankAscending||a===d.PivotShowDataAs.rankDescending},r=function(a,c,d,f,g){var h,i,j,k;if(void 0===g&&(g=""),h=a.rjc,i=a.nodeName,j=g,d||(""!==j&&(j+=b.Separator),j+=i),e.vhc(h,function(a){r(a,c,!1,f,j)}),c[j]=a.AOc,!a.p1b&&f.NQc&&a.wOc)for(k in a.wOc)q(f.jOc[k].showDataAs)&&f.OQc(k,j,a.wOc[k].baseMinorPath)},s=function(a,b,c){var d,e,f,g,h,i=[];if(a.aN<b&&a.rjc.length>0)for(d=0,e=a.rjc;d<e.length;d++)f=e[d],g=s(f,b,c).slice(0),i.push.apply(i,g);else if(a.aN===b)return h={},r(a,h,!0,c),[h];return i},t=function(a,b,c,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=a.PQc;for(h in s)if(s.hasOwnProperty(h)){i=a.jOc[h],j=i.cacheName,k=i.subtotalText,l=i.showDataAs,m=s[h],n=f?c:m;for(o in n)n.hasOwnProperty(o)&&(p=void 0,q=b[h].baseMajorPath,p=f?m[o]||o:m[o],r=c[o],e.Fa(r)||(l===d.PivotShowDataAs.percentOfRunningTotal?a.QQc(h,p,q,r,j,k):a.RQc(h,p,q,r,j,k)))}},u=function(a,b,c,d,f,g,j){var k,l,m,n,o,q,r,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=s(b,c,a),M=a.NQc;if(L&&1===L.length)return a.SQc(b.yOc,{indexList:L[0],level:b.aN,visible:b.bz,collapse:b.SWc,baseSubtotalInfo:b.wOc,parentPath:f}),void(M&&t(a,b.wOc,L[0],!1,!1));for(k={},n=[],o={},e.vhc(d,function(a){n.push(a.cacheName),o[a.cacheName]=a.isCalculatedField}),q=0,r=L;q<r.length;q++){u=r[q];for(v in u)if(u.hasOwnProperty(v))for(k[v]||(k[v]={}),w=0,x=n;w<x.length;w++)y=x[w],z=a.TQc(k[v]),z||(z={}),l=z[y],m=a.TQc(u[v])&&a.TQc(u[v])[y],l||(l={}),m&&m.calc&&(l.calc?o[y]?(g.UQc(j,z,y),l.calc=z[y].calc):(A=l.calc,B=m.calc,l.calc={count:A.count+B.count,sum:A.sum+B.sum,max:i(A.max,B.max),min:h(A.min,B.min),sumx2:A.sumx2+B.sumx2,product:A.product*B.product,len:A.len+B.len}):l.calc=m.calc),C=a.VQc(),k[v]=C,z[y]=l,a.WQc(C,b.yOc,z)}for(v in k)if(k.hasOwnProperty(v))for(D=0,E=d;D<E.length;D++)F=E[D],G=F.subTotalTypes,y=F.cacheName,H=a.TQc(k[v]),H||(H={}),I=H[y],I.collapse=a.RWc(a.XQc[v],y),I.calcResult=p(I.calc,G),I.hasEffectChild=!0;M&&t(a,b.wOc,k,!0,b.Ajc),J=b.bz,K=b.SWc,a.SQc(b.yOc,{indexList:k,level:b.aN,visible:J,collapse:K,baseSubtotalInfo:b.wOc,parentPath:f})},v=function(){function a(a,b){this.XQc={},this.YQc={},this.ZQc={},this.jOc={},this.$Qc={},this._Qc={},this.aRc={},this.NQc=!1,this.FP=[],this.Jb=a,this.bRc=b}return a.prototype.bOc=function(a,b){var c=this.cRc[a]||a,d=b&&b[c];return d||this.bRc.$Sb(c).bOc()},a.prototype.dRc=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=!1,F=[],G={},H={},I=0;for(f=0,g=a;f<g.length;f++)h=g[f],i=!1,j=void 0,k=-1,l=h.showDataAs,m=h.baseFieldItemType,n=h.baseFieldName,o=h.baseFieldItem,p=h.baseFieldItemShared,q=h.fieldName,r=h.cacheName,s=h.subtotalType,E=!0,t=c.indexOf(n),u=b.indexOf(n),n&&(j=u>-1,k=c.concat(b).indexOf(n)+1),i=i||this.eRc(h),v=d.SubtotalType[s],w=l===d.PivotShowDataAs.percentOfParent,x=l===d.PivotShowDataAs.rankAscending||l===d.PivotShowDataAs.rankDescending,y=l===d.PivotShowDataAs.runTotal||l===d.PivotShowDataAs.percentOfRunningTotal,z=y||x,A=this.fRc(l,m),B=l===d.PivotShowDataAs.difference||l===d.PivotShowDataAs.percentDiff||l===d.PivotShowDataAs.percent,C=Math.pow(2,I),D={showDataAsIndex:C,needBuildBasePath:i,showDataAs:l,baseFieldItemType:m,isNextOrPrevious:A,baseFieldName:n,baseFieldItem:o,baseFieldItemShared:p,isDifferenceOrPercent:B,isRankShowDataAs:x,cacheName:r,isHeaderOfPercentOrDiff:j,subtotalText:v,baseRootLevel:t,baseHeaderLevel:u,fieldName:q,needBuildPercentOfPath:w,actualBaseLevel:k,needBuildRunningTotalOrRankPath:z},F.push(D),this.jOc[q]=D,y&&(this.$Qc[q]={}),x&&(this.NQc=!0,this.PQc||(this.PQc={}),this.PQc[q]={},this.aRc[q]={},H[r]||(H[r]=[]),H[r].push(q)),A&&(e.Fa(this.gRc)&&(this.gRc=[]),this.gRc.push(q)),l===d.PivotShowDataAs.percentOfRunningTotal&&(this.PQc||(this.PQc={}),this.PQc[q]={},this._Qc[q]={},this.NQc=!0,H[r]||(H[r]=[]),H[r].push(q));return this.hRc=G,this.iRc=H,this.jRc=E,F},a.prototype.fRc=function(a,b){var c=a===d.PivotShowDataAs.difference||a===d.PivotShowDataAs.percentDiff||a===d.PivotShowDataAs.percent;return!(!c||b===d.PivotShowDataAsBaseItemType.item)},a.prototype.OQc=function(a,b,c){this.PQc[a][b]=c},a.prototype.JQc=function(a,b,c){var d=this.$Qc[a],e=b+"||"+c;return d[e]||(d[e]={val:0}),d[e].val||0},a.prototype.LQc=function(a,b,c){var d=b+"||"+c;return this._Qc[a][d].cursor},a.prototype.QQc=function(a,b,c,d,e,f){var g,h;this.RWc(d,e)||(g=this.IQc(d,e,f),h=b+"||"+c,this._Qc[a][h]||(this._Qc[a][h]={cursor:0}),this._Qc[a][h].cursor+=g)},a.prototype.KQc=function(a,b,c,d){var e=b+"||"+c;this.$Qc[a][e].val=d},a.prototype.MQc=function(a,b,c){var d=b+"||"+c,e=this.aRc[a];return e[d]||(e[d]=0),e[d]},a.prototype.RQc=function(a,b,c,d,e,f){var g,h;this.RWc(d,e)||(g=this.IQc(d,e,f),h=b+"||"+c,this.aRc[a][h]||(this.aRc[a][h]={}),this.aRc[a][h][g]=1)},a.prototype.kRc=function(){var a,b,c,f,g;for(a in this.aRc)if(this.aRc.hasOwnProperty(a)){b=this.aRc[a],c=this.jOc[a].showDataAs,f=c===d.PivotShowDataAs.rankAscending?1:-1;for(g in b)b.hasOwnProperty(g)&&(b[g]=e.lRc(b[g],f))}},a.prototype.eRc=function(a){var b=a.showDataAs,c=a.baseFieldItemType,e=!1;return b!==d.PivotShowDataAs.percent&&b!==d.PivotShowDataAs.difference&&b!==d.PivotShowDataAs.percentDiff||(e=c===d.PivotShowDataAsBaseItemType.item),e},a.prototype.mRc=function(a){this.al=a,this.GQc=a.AOc,a.HQc=a.AOc},a.prototype.nRc=function(){return this.al},a.prototype.oRc=function(a){this.KW=a,this.pRc=a.AOc,a.HQc=a.AOc},a.prototype.SQc=function(a,b){this.ZQc[a]=b},a.prototype.xOc=function(a){return this.ZQc[a]},a.prototype.qRc=function(){return this.KW},a.prototype.VQc=function(){var a=this.Jb;return this.Jb=a+1,a},a.prototype.rRc=function(a){return this.jRc[a]},a.prototype.TQc=function(a){return this.FP[a]},a.prototype.IQc=function(a,b,c){return this.TQc(a)&&this.TQc(a)[b].calcResult&&this.TQc(a)[b].calcResult[c]||null},a.prototype.RWc=function(a,b){return this.TQc(a)&&this.TQc(a)[b].collapse},a.prototype.iOc=function(a,b,c,d,e,f){var g;return g=this.jOc[f]?o(this,b,a,c,d,e,f):this.IQc(a,b,c)},a.prototype.BOc=function(a,b){return b?this.YQc[a]:this.XQc[a]},a.prototype.sRc=function(a,b,c,d){d?this.WQc(a,b,c):this.tRc(a,b,c)},a.prototype.tRc=function(a,b,c){this.FP[a]=c,this.XQc[b]=a},a.prototype.uRc=function(a,b){this.FP[a]=b},a.prototype.WQc=function(a,b,c){this.FP[a]=c,this.YQc[b]=a},a.prototype.no=function(){var a=this;a.FP=g,a.Jb=0,a.XQc=g,a.YQc=g,a.al=g,a.KW=g,a.jOc=g,a.bRc=g,a.jRc=!1,a.vRc=g,a.cRc=g,a.$Qc=g,a._Qc=g,a.aRc=g,a.hRc=g,a.gRc=g,a.iRc=g,a.wRc=g,a.xRc=g,a.PQc=g},a}(),b.PivotSubtotalManager=v;function D(a,b){var c=b.getField(a);return!(!c||e.Fa(c.Yw))}w=function(){function a(a,b,c,d,f){var g,h;this.Pkc={},this._Fc={},g=this,h=[],e.vhc(a,function(a,b){var c=a.index,d=a.displayName,e=a.isDim,f=a.isGroupField,i=a.getGroupItem,j=a.databaseField,k=a.dataFieldIndex;e&&(h.push({index:c,fieldName:d,isGroupField:f,getGroupItem:i,databaseField:j,dataFieldIndex:k}),g.Pkc[d]=b,g._Fc[d]=b)}),g.Qkc=h,g.SIa=g.yRc(b,c),g.GFc=g.zRc(g.SIa),g.ARc=g.yRc(d,c),g.BRc=g.yRc(f,c,!0),g.Hjc={},g.hic=[]}return a.prototype.yRc=function(a,b,c){var f,g={},h=[];e.vhc(a,function(a,f){var h,i=a.cacheName,j=a.index,k=a.subTotalType;D(i,b)&&(k=d.SubtotalType.sum),g[j]?g[j].subTotalTypes.push(k):(g[j]={cacheName:i,index:j,subTotalTypes:[k],isCalculatedField:c},h=b.HL[i]&&!e.isEmptyObject(b.HL[i].dic)&&b.HL[i].Yic&&b.HL[i].Yic.length>0,h&&(g[j].itemsKeyList=b.HL[i].Yic))});for(f in g)g.hasOwnProperty(f)&&h.push(g[f]);return h},a.prototype.zRc=function(a){var b,c,d={};for(b=0,c=a.length;b<c;b++)d[a[b].cacheName]=b;return d},a.prototype.no=function(){var a=this;a.Hjc=g,a.SIa=g,a.GFc=g,a.ARc=g,a.BRc=g,a.hic=g,a.Qkc=g,a.Pkc=g,a._Fc=g},a.prototype.Rkc=function(a,c,d){var e,f,g,h,i,j,k,l=this.ARc,m={};for(e=0,f=l;e<f.length;e++)g=f[e],h=g.cacheName,i=g.index,j=g.itemsKeyList,m[h]||(m[h]=b.Nkc(j?j[a[i]]:a[i]));return k=[d],this.hic.push({
path:c,indexes:k,subtotal:m})-1},a.prototype.addItem=function(a,c){var d,f,g,h,i,j,k,l,m,n,o,p,q=this.Qkc,r=[],s=[];for(d=0,f=q;d<f.length;d++)g=f[d],h=g.fieldName,i=g.index,j=g.isGroupField,k=g.getGroupItem,l=g.databaseField,m=g.dataFieldIndex,n=l===!1?a[m]:a[i],j&&(n=k(n)),r.push(h+"&"+n),s.push(n);o=r.join(b.Separator),p=this.Hjc[o],e.Fa(p)?this.Hjc[o]=this.Rkc(a,s,c):this.Skc(p,a,c)},a.prototype.Skc=function(a,c,d){var e,f,g,h,i,j,k,l=this.hic[a];for(l.indexes.push(d),e=this.ARc,f=0,g=e;f<g.length;f++)h=g[f],i=h.cacheName,j=h.index,k=h.itemsKeyList,b.Mkc(k?k[c[j]]:c[j],l.subtotal[i])},a.prototype.Tkc=function(a){var b,c,d,f=this._Fc,g=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.Fa(f[d])||g.push(f[d]);return g},a.prototype.Ukc=function(a,b){var c=this;return a.map(function(a){return{pathStr:b[a],dimName:c.Qkc[a].fieldName}})},a.prototype.BFc=function(a,b,c,f,h,i,j,k,l,m,n,o){var p,q,r,s,t,u,w,x,y,z,A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S=this,T=new v(this.hic.length,a),U=new B("","",T,(!1),"","",""),V=new B("","",T,(!1),"","","");if(T.mRc(U),T.oRc(V),T.collapseItems=j,p=T.dRc(m,c,f),q=f.length,T.CRc=q,V.aN=0,U.aN=0,U.Ajc=!0,U.bz=!1,V.bz=!1,V.Ajc=!0,m&&m.length>0&&U.DRc(T,p,q,"",{},0),r=this.Tkc(b),s=this.Tkc(c.concat(f)),t=i.valuePositionInfo,u=i.insertBlankLineAfterEachItem,w=i.grandTotalPosition,x=i.subTotalsPosition,y=i.valueFieldLength,i=g,z=t.positionIndex,A=t.positionType,C=t.display,D=-1,E=-1,F=this.SIa.length,(F>1||1===F&&this.SIa[0].subTotalTypes.length>1)&&C&&(A===d.DataPosition.col&&(E=z,0===z&&(V.Bjc=!0)),A===d.DataPosition.row&&(D=z,0===z&&(U.Bjc=!0))),this.HFc(U,V,r,s,h,D,E,T,q,p,j),G=this.GFc,H={},I=!1,J={},K={},e.vhc(h,function(a){var b,c,d,e=a.displayName,f=a.sourceName,g=a.valueFilter,h=a.sortInfo;g&&(b=g.conditionBySourceName,c=g.condition,d=k[g.conditionByName],H[e]={valueFieldName:b,condition:c,subTotalType:d},I=!0),h&&h.sortValueFieldName&&(J[e]={subtotalText:h.sortValueSubtotalText,cacheName:h.cacheName}),K[e]=f}),h=g,T.vRc=J,T.cRc=K,T.wRc=n,T.xRc=o,L={},I)for(M=void 0,N=0;N<l.length;N++)O=l[N],P=H[l[N]],Q=this.SIa[G[P&&P.valueFieldName]],e.Fa(Q)||(M=c.indexOf(O),M>-1?V.IFc(Q,O,P,L,M,T):(M=f.indexOf(O),U.IFc(Q,O,P,L,M,T)));return R=S.ARc.concat(S.BRc),U.Vkc(R,L,T,!1,q,"",S,a),V.Vkc(R,L,T,!0,c.length,"",S,a),T.kRc(),V.pEc(c.length,{},{insertBlankLineAfterEachItem:u,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:E},!0,j,T),0===c.length&&(V.wjc=0,V.xjc=E!==-1?y:1,V.Njc=0,V.Ojc=E!==-1?y:1,V.$Dc=E!==-1?y:1,V.COc=E!==-1?y:1),V.vjc=c.length,U.pEc(r.length-c.length,{},{insertBlankLineAfterEachItem:u,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:D},!1,j,T),r.length-c.length===0&&(U.wjc=0,U.xjc=D!==-1?y:0,U.Njc=D!==-1?y:1,U.Ojc=D!==-1?y:0,U.$Dc=D!==-1?y:0,U.COc=D!==-1?y:1,0===y&&(U.COc=0,U.Njc=0)),T},a.prototype.HFc=function(a,b,c,d,f,g,h,i,j,k,l){var m,n=this,o=this.SIa.length,p=this.hic,q=Math.max(d.length-j,0);o>0?(m=this.ARc.concat(this.BRc),e.vhc(p,function(e,l){var o,p,r,s,t,u;for(o=0,p=m;o<p.length;o++)r=p[o].cacheName,s=e.path,t=e.subtotal,u=t[r],b.addChildItem(n.Ukc(d,s),u,l,i,r,f,h,q,!0,"",!1,0,b.wOc,k),a.addChildItem(n.Ukc(c,s),u,l,i,r,f,g,j,!1,"",!1,0,a.wOc,k)})):e.vhc(p,function(e,k){var l=e.path;b.addChildItem(n.Ukc(d,l),null,k,i,void 0,f,h,q,!0,"",!1,0),a.addChildItem(n.Ukc(c,l),null,k,i,void 0,f,g,j,!1,"",!1,0)})},a.prototype.ERc=function(a,b){var c,d,e,f,g=this,h=g.hic;for(c=0,d=h.length;c<d;c++)e=h[c],f=e.subtotal,g.FRc(a,f,b)},a.prototype.FRc=function(a,b,c){var d,e,f=this;for(d=0,e=c.length;d<e;d++)f.UQc(a,b,c[d].cacheName)},a.prototype.UQc=function(a,b,c){var d,e,g,h=a.Slc,i=h.calcService,j=h.calcSource;j.setMeasureNode(b),d=a.$Sb(c),e=d.C_b;try{g=i.lh.evaluateExpression(e,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(a){g=new f.CalcError("#REF!")}b[d.Cj]={calc:{sum:g}}},a}(),b.PivotQueryList=w;function E(a,b){e.vhc(b,function(b){var c,d=a.HL[b.sourceName],f=d;d.MFc===!1&&(b.databaseField=!1,b.dataFieldIndex=d.OFc,f=a.PFc(d.OFc)),d.Ykc&&(b.isGroupField=!0,c=e.isEmptyObject(f.dic),b.getGroupItem=function(a){var b=c?a:f.Yic[a];return d.QFc[d.Zkc(b)]})})}function F(a,b){var c,d,f,g=[],h=a.HL;for(c=0,d=b.length;c<d;c++)f=h[b[c].sourceName],f&&e.Fa(f.dic)&&g.push(f.Cj);a.GRc(g)}x=function(){function a(){}return a.prototype.Ha=function(a,b){var c,d=!0,f=[];return e.vhc(b,function(b){var c,g=!b.isALL;d&&g&&(d=!1),g&&(Array.isArray(b.items[0])?(c=[],e.vhc(b.items,function(a){c=c.concat(a)}),f.push(c)):f.push(a.$Sb(b.sourceName).getIndexesList(b.items)))}),c=e.kic(f),{isALL:d,indexes:c}},a.prototype.$kc=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q=b.isALL,r=b.indexes;if(F(a,c),E(a,c),f=a.HRc(d),g=f.normalFieldsInfos,h=f.calcFieldsInfos,i=[],j=new w(c,d,a,g,h),e.vhc(d,function(a){var b=a.index;i.indexOf(b)===-1&&i.push(b)}),k=a._kc,l=k.length,q)for(m=0;m<l;m++)j.addItem(k[m],m);else for(n=0,o=r;n<o.length;n++)p=o[n],j.addItem(k[p],p);return h.length>0&&j.ERc(a,h),j},a}(),b.DataAnalyzer=x,y=function(a,b){for(var c=b+1;c<a.length;c++)if(!a[c].SWc)return a[c];return g},z=function(a,b){for(var c=b-1;c<b&&c>=0;c--)if(!a[c].SWc)return a[c];return g},A=function(a){var b,c,d=[],e=[],f=a.length,h=g,i=g;for(b=0,c=f-1;b<f;b++,c--)e[b]=h,h=a[b].SWc?h:b,d[c]=i,i=a[c].SWc?i:c;return{preMap:e,nextMap:d}},B=function(){function a(a,b,c,d,e,f,g){this.TWc=0,this.fXc=0,this.Hjc={},this.rjc=[],this.Cjc=b,this.nodeName=a,this.$ic=g,this.yOc=e,this.FOc=f,d||(this.AOc=c.VQc())}return a.prototype.IRc=function(a,c){if(this.aN+1<=a){var d=this.yOc;return""!==d&&(d+=b.Separator),d+c||""}return this.yOc},a.prototype.JRc=function(a,c){if(this.aN+1>a){var d=this.FOc;return""!==d&&(d+=b.Separator),d+c||""}return this.FOc},a.prototype.KRc=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.$ic!==g.baseFieldName||(j=h?this.$ic:g.baseFieldItemShared),i=f&&f.baseMajorPath?f.baseMajorPath:"",this.aN<=d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.UWc=function(a,c,d,e,f){var g,h,i,j,k=this.aN;return e&&(j=e.childMajorPath||"",i=e.baseMajorPath||""),k<=d?(""!==j&&(j+=b.Separator),k>f.baseRootLevel?(g=j+this.nodeName,h=j+this.$ic):(g=j+this.nodeName,h=j+this.nodeName),{currentMajorPath:g,childMajorPath:h}):{currentMajorPath:i,childMajorPath:j}},a.prototype.LRc=function(a,b){var c;return c=b&&b.baseMajorPathList?[].concat(b.baseMajorPathList):[],this.aN<=a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.MRc=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.NRc=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.ORc=function(a,b,c){var d,e,f,g;return b.baseRootLevel>-1?(d=b.baseRootLevel+1,this.aN<=d?this.yOc:a.percentOfBasePath):(e=b.baseHeaderLevel+1,f=void 0,g=void 0,f=this.aN<=e+c?this.AOc:a.baseIndex,g=this.aN<=e?this.yOc:a.percentOfBasePath,{baseIndex:f,percentOfBasePath:g})},a.prototype.PRc=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.$ic!==g.baseFieldName||(j=h?this.$ic:g.baseFieldItemShared),i=f&&f.baseMinorPath?f.baseMinorPath:"",this.aN>d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.VWc=function(a,c,d,e,f){var g,h,i,j,k=this.aN;return e&&(j=e.childMinorPath||"",i=e.baseMinorPath||""),k>d?(""!==j&&(j+=b.Separator),k>f.baseHeaderLevel?(g=j+this.nodeName,h=j+this.$ic):(g=j+this.nodeName,h=j+this.nodeName),{currentMinorPath:g,childMinorPath:h}):{currentMinorPath:i,childMinorPath:j}},a.prototype.QRc=function(a,b){var c;return c=b&&b.baseMinorPathList?[].concat(b.baseMinorPathList):[],this.aN>a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.addChildItem=function(a,c,d,f,g,h,i,j,k,l,m,n,o,p){var q,r,s,t,u,v,w,x,y,z,A;a.length>0?(q=a[0],r=a.slice(1),s=q.pathStr,t=q.dimName,u=0===r.length,v=l,w=void 0,e.Fa(this.Hjc[s])&&(x=this.Cjc,""!==x&&(x+=b.Separator),this.Hjc[s]=this.d3a(s,x+s,f,u,j,s,k,t)),w=this.rjc[this.Hjc[s]],w.HQc=this.AOc,w.aN===i&&(w.Bjc=!0),w.bz=m,w.SWc=w.WWc(f.collapseItems,m),u?(w.p1b=!0,w.AOc=d,c&&void 0!==g&&(y=f.TQc(w.AOc),e.Fa(y)&&(y={}),e.Fa(y[g])&&(y[g]={calc:c.calc},f.uRc(w.AOc,y))),w.alc=d,p&&p.length>0&&(z=void 0,z=w.aN<j||w.aN===j&&(!w.rjc||w.rjc.length<1)?this.yOc:l,w.RRc(f,j,p,k),k?w.SRc(f,p,j,z,o,this.TWc):w.DRc(f,p,j,z,o,this.TWc))):(this.RRc(f,j,p,k),w.RRc(f,j,p,k),k||this.aN<j&&(v=this.yOc),!k&&p?(this.DRc(f,p,j,l,o,n),w.DRc(f,p,j,v,o,this.TWc)):p&&k&&(this.SRc(f,p,j,l,o,n),w.SRc(f,p,j,v,o,this.TWc)),w.addChildItem(r,c,d,f,g,h,i,j,k,v,w.WWc(f.collapseItems,m),this.TWc,w.wOc,p))):(this.p1b=!0,c&&void 0!==g&&(A=f.TQc(d),e.Fa(A)&&(A={}),this.alc=d,A[g]={calc:c.calc},f.sRc(d,this.yOc,A,k)),this.alc=d,this.AOc=d),p&&p.length>0&&(k?this.SRc(f,p,j,l,o,n):this.DRc(f,p,j,l,o,n))},a.prototype.RRc=function(a,b,c,d){c&&c.length&&this.aN<=b&&(d?a.YQc[this.yOc]=this.AOc:a.XQc[this.yOc]=this.AOc)},a.prototype.DRc=function(a,b,c,f,g,h){var i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;if(!this.wOc)for(this.wOc={},i=0,j=b;i<j.length;i++)k=j[i],l=k.fieldName,m=k.needBuildBasePath,o=k.needBuildPercentOfPath,p=k.needBuildRunningTotalOrRankPath,q=k.isNextOrPrevious,r=k.isDifferenceOrPercent,this.wOc[l]||(this.wOc[l]={}),s=this.wOc[l],t=g?g[l]:{},m&&(s.baseMajorPath=this.KRc(a,l,c,t,k),s.baseMinorPath=this.PRc(a,l,c,t,k),e.Fa(k.baseFieldName)||this.$ic!==k.baseFieldName||k.baseFieldItemShared!==this.nodeName?this.TWc=this.TWc|h:this.TWc=this.TWc|k.showDataAsIndex),q&&(s.baseMajorPathList=this.LRc(c,t),s.baseMinorPathList=this.QRc(c,t)),o&&(k.baseRootLevel>-1?s.percentOfBasePath=this.ORc(t,k,c):(u=this.ORc(t,k,c),v=u.percentOfBasePath,w=u.baseIndex,s.baseIndex=w,s.percentOfBasePath=v)),p&&(k.showDataAs===d.PivotShowDataAs.rankAscending||k.showDataAs===d.PivotShowDataAs.rankDescending?(x=this.UWc(a,l,c,t,k),y=x.currentMajorPath,z=x.childMajorPath,s.baseMajorPath=y,s.childMajorPath=z,A=this.VWc(a,l,c,t,k),B=A.currentMinorPath,C=A.childMinorPath,s.baseMinorPath=B,s.childMinorPath=C):(s.baseMinorPath=this.PRc(a,l,c,t,k,!0),s.baseMajorPath=this.KRc(a,l,c,t,k,!0))),q||(s.indexInfo=n(k,this,a,c,f,s))},a.prototype.WWc=function(a,b){if(b)return!0;var c=this;return!!(a&&a[c.$ic]&&a[c.$ic][c.nodeName])},a.prototype.SRc=function(a,b,c,d,f,g){var h,i,j,k,l,m,o,p,q,r,s,t,u;if(!this.wOc)for(this.wOc={},h=0,i=b;h<i.length;h++)j=i[h],k=j.fieldName,l=j.needBuildRunningTotalOrRankPath,m=j.needBuildPercentOfPath,o=j.isNextOrPrevious,p=j.needBuildBasePath,this.wOc[k]||(this.wOc[k]={}),q=this.wOc[k],r=f?f[k]:{},p&&(q.baseMajorPath=this.KRc(a,k,c,r,j),q.baseMinorPath=this.PRc(a,k,c,r,j),e.Fa(j.baseFieldName)||this.$ic!==j.baseFieldName||j.baseFieldItemShared!==this.nodeName?this.TWc=this.TWc|g:this.TWc=this.TWc|j.showDataAsIndex),l&&(this.wOc[k].baseMajorPath=this.KRc(a,k,c,r,j,!0),this.wOc[k].baseMinorPath=this.PRc(a,k,c,r,j,!0)),o&&(this.wOc[k].baseMajorPathList=this.LRc(c,r),this.wOc[k].baseMinorPathList=this.QRc(c,r)),m&&(j.baseRootLevel>-1?this.wOc[k].percentOfBasePath=this.ORc(r,j,c):(s=this.ORc(r,j,c),t=s.percentOfBasePath,u=s.baseIndex,this.wOc[k].baseIndex=u,this.wOc[k].percentOfBasePath=t)),o||(this.wOc[k].indexInfo=n(j,this,a,c,d,this.wOc[k]))},a.prototype.pEc=function(a,b,c,d,f,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this,Q=c.valuePosition,R=c.valueFieldLength;if(Q===-1&&(R=1),P.TRc(h),o=this.URc(h,d,i,j,k,l,m,n||0),P.rjc.length>0){for(p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=P.rjc,y=A(P.rjc),z=y.preMap,B=y.nextMap,C=x.length-1;C>=0;C--)D=x[z[C]],E=x[B[C]],F=P.rjc[C],G=F.pEc(a,b,c,d,f,h,D,E,P.rjc[C-1]||null,P.rjc[C+1]||null,o,this.TWc),e.Fa(G)||(H=G.volume,I=G.subtotalVolume,J=G.blankRowVolume,K=G.topBlankRowVolume,L=G.titleRowCount,M=G.topSubtotalVolume,N=G.tabularSubtotalVolume,O=G.tabularTitleRowCount,p+=H,q+=I,r+=J,s+=K,t+=L,u+=M,v+=N,w+=O,G=g);P.aN===a?(P.xjc=0,P.Ojc=0,P.mXc=0,P.lXc=0,P.Bjc?(P.wjc=R,P.Njc=1,P.mXc=1,P.lXc=1):(P.Ajc?P.wjc=0:P.wjc=1,P.Njc=0,P.$Dc=0,P.COc=0)):P.Bjc?(P.Ojc=R,P.wjc=p*R,P.xjc=(q+1)*R,P.mXc=(0===r?1:r)*R+(P.Ajc?0:1),P.lXc=(0===s?1:s)*R,P.COc=w*R,P.$Dc=(v+1)*R,P.Njc=(t+1)*R+(P.Ajc?0:1)):Q>P.aN?(P.wjc=p,P.COc=w,P.Ojc=u+R,P.xjc=q+R,P.mXc=r+(P.Ajc?0:1),P.lXc=s,P.$Dc=v+R,P.Njc=t+(P.Ajc?0:1)):(P.wjc=p,P.xjc=q+1,P.COc=w,P.$Dc=v+1,P.Njc=t+(P.Ajc?0:1),P.mXc=r+(P.Ajc?0:1),P.aN===a-1?P.lXc=s+(P.Ajc?0:1):P.lXc=s,Q===-1&&P.Ajc?P.Ojc=u+1:P.Ojc=0)}else Q===a?(P.wjc=R,P.Njc=1):P.Ajc&&0===R?P.wjc=0:P.wjc=1,P.xjc=0,P.mXc=P.Bjc?1:0,P.lXc=P.Bjc?1:0,P.$Dc=0,P.Njc=P.Njc||0,P.COc=0,P.Ojc=0;return f&&f[P.$ic]&&f[P.$ic][this.nodeName]&&(P.wjc=0,P.xjc=0,P.mXc=a>Q&&P.aN<=Q?R:1,P.lXc=a>Q&&P.aN<=Q?R:1,P.COc=P.aN<=Q?R:1,P.Njc=P.aN<=Q?R+1:1,P.Ojc=0,P.$Dc=0),{volume:P.wjc,subtotalVolume:P.xjc,blankRowVolume:P.mXc,topBlankRowVolume:P.lXc||0,titleRowCount:P.Njc||0,topSubtotalVolume:P.Ojc||0,tabularSubtotalVolume:P.$Dc||0,tabularTitleRowCount:P.COc||0}},a.prototype.d3a=function(b,c,d,e,f,g,h,i){var j=this.IRc(f,g),k=this.JRc(f,g),l=new a(b,c,d,e,j,k,i);return l.aN=this.aN+1,this.rjc.push(l)-1},a.prototype.Vkc=function(a,b,c,d,f,g,h,i){var j=this,k=this,l=c.TQc(k.AOc);return k.clc?l:(l||(l={}),e.vhc(a,function(e){var g,m,n,o,q,r,s=e.cacheName,t=e.subTotalTypes,u=e.isCalculatedField,v=k.dlc(s,k.Cjc,c,d).calc,w=v.count,x=v.sum,y=v.max,z=v.min,A=v.sumx2,B=v.product,D=v.len;if(k.rjc.length>0){if(g=!1,u)h.UQc(i,l,s),g=!!k.p1b,x=l[s].calc.sum;else for(m=k.rjc.length-1;m>-1;m--)n=k.rjc[m],n.elc=m,n.p1b&&1===b[n.alc]?k.rjc.splice(m,1):(o=n.Vkc(a,b,c,d,f,k.Cjc,h,i)[s],q=o.calc,r=o.hasEffectChild,g=g||r,q&&(w+=q.count,x=C(x,q.sum,0),B=C(B,q.product,2),y=C(y,q.max,5),z=C(z,q.min,6),A=C(A,q.sumx2,0),D+=q.len));j.VRc(s,c),d||j.WRc(c,s,f,k.rjc),l[s]={collapse:j.bz,hasEffectChild:g,calcResult:p({count:w,sum:x,max:y,min:z,sumx2:A,product:B,len:D},t),calc:{count:w,sum:x,max:y,min:z,sumx2:A,product:B,len:D}}}else l[s]=l[s]?l[s]:{},l[s].collapse=j.bz,l[s].calcResult=p({count:w,sum:x,max:y,min:z,sumx2:A,product:B,len:D},t),l[s].hasEffectChild=!!k.p1b;c.sRc(k.AOc,k.Cjc,l,d)}),d&&this.aN<=f&&u(c,k,f,a,g,h,i),k.clc=!0,l)},a.prototype.WRc=function(a,b,c,d){d.length>0&&this.XRc(a,b,d)},a.prototype.URc=function(a,b,c,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(a){if(k=a.gRc){for(l={},m=0,n=k;m<n.length;m++)o=n[m],p=a.jOc[o],q=p.baseFieldItemType,r=p.baseHeaderLevel,s=p.baseRootLevel,t=p.actualBaseLevel,q!==d.PivotShowDataAsBaseItemType.item&&(u=q===d.PivotShowDataAsBaseItemType.next,v=void 0,w=void 0,x=b?r:t,b&&r+1===this.aN||!b&&t===this.aN?(u?(v=f&&f.nodeName,w=h&&h.nodeName,f?this.TWc=this.TWc|j:(this.TWc=this.TWc|p.showDataAsIndex,this.fXc=this.fXc|p.showDataAsIndex)):(v=c&&c.nodeName,w=g&&g.nodeName,c?this.TWc=this.TWc|j:(this.TWc=this.TWc|p.showDataAsIndex,this.fXc=this.fXc|p.showDataAsIndex)),l[o]=v):x<this.aN&&i&&(v=i[o],l=i,this.TWc=this.TWc|j),y=v,e.Fa(w)||(y=w),z=this.MRc(this.wOc[o].baseMajorPathList||[],y,b?r:s),A=this.NRc(this.wOc[o].baseMinorPathList||[],y,b?s:r),this.wOc[o].baseMajorPath=z,this.wOc[o].baseMinorPath=A,delete this.wOc[o].baseMajorPathList,delete this.wOc[o].baseMajorPathList,this.wOc[o].indexInfo={baseMajorPath:z,baseMinorPath:A});return l}return i}},a.prototype.YRc=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.hRc[b];if(n)for(d=0,e=n;d<e.length;d++)for(f=e[d],g=a.jOc[f].subtotalText,h=0,i=c;h<i.length;h++)j=i[h],k=j.wOc[f],l=k.baseMinorPath,m=k.baseMajorPath,a.RQc(f,m,l,j.AOc,b,g)},a.prototype.XRc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(0!==c.length&&(e=c[0].p1b,f=a.iRc[b]))for(g=0,h=f;g<h.length;g++)if(i=h[g],j=a.jOc[i],k=j.subtotalText,l=j.baseHeaderLevel,m=j.showDataAs,(e||!(l>-1))&&!(c[0].aN<a.CRc))for(n=0,o=c;n<o.length;n++)p=o[n],q=p.wOc[i],r=q.baseMajorPath,s=q.baseMinorPath,m===d.PivotShowDataAs.percentOfRunningTotal?a.QQc(i,r,s,p.AOc,b,k):a.RQc(i,r,s,p.AOc,b,k)},a.prototype.TRc=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.Hjc&&0!==this.rjc.length){if(b=[],c=this.rjc[0].$ic,d=a.wRc,e=a.xRc,f=a.bOc(c,d),g=a.cRc[c]||c,h=e[g],f){for(i=0,j=this.rjc;i<j.length;i++)k=j[i],l=k.nodeName,b[f[l]]=k;return 1===h&&b.reverse(),this.rjc=b.filter(function(a){return a}),b=null,delete this.Hjc,!0}return!1}},a.prototype.VRc=function(a,b){if(this.Hjc&&0!==this.rjc.length){var c;return b.vRc&&b.vRc[this.$ic]&&(c=b.vRc[this.$ic].subtotalText),!(!c||a!==b.vRc[this.$ic].cacheName)&&(this.rjc.sort(function(d,e){return b.TQc(d.AOc)[a].calcResult[c]-b.TQc(e.AOc)[a].calcResult[c]}),delete this.Hjc,!0)}},a.prototype.IFc=function(a,b,c,f,h,i){var j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z,A,B,D,E,F=this,G=null,H=!1,I=a.cacheName,J=0,K=0,L=[],M=0,N=-(1/0),O=1/0,P=0,Q=1;if(F.rjc.length>0)if(F.rjc[0].$ic===b&&(j=c,G=j.condition,k=j.subTotalType,H=G.glc===d.PivotConditionType.top10),H){for(l=[],m=void 0,n=[],e.vhc(F.rjc,function(e,j){var m,o,q=e.IFc(a,b,c,f,h,i),r=q.calc,s=q.indexList;n.push({calc:r,indexList:s}),m=p(r,[k]),o=m[d.SubtotalType[k]],l.push({index:j,value:o}),m=g}),m=G.evaluate(l),o=F.rjc.length-1;o>-1;o--)if(m[o])q=n[o].calc,J+=q.count,M=C(M,q.sum,0),Q=C(Q,q.product,2),N=C(N,q.max,5),O=C(O,q.min,6),P=C(P,q.sumx2,0),K+=q.len;else{for(r=0,s=n[o].indexList;r<s.length;r++)t=s[r],f[t]=1;F.rjc.splice(o,1)}n=g}else for(o=F.rjc.length-1;o>-1;o--)if(u=F.rjc[o],u.p1b&&1===f[u.alc])F.rjc.splice(o,1);else if(v=u.IFc(a,b,c,f,h,i),q=v.calc,w=v.indexList,0!==u.rjc.length||u.p1b){if(!(F.aN<h)&&w&&q){if(x=!0,G&&(y=p(q,[k]),z=y[d.SubtotalType[k]],x=j.condition.evaluate(z),y=g),x)J+=q.count,M=C(M,q.sum,0),Q=C(Q,q.product,2),N=C(N,q.max,5),O=C(O,q.min,6),P=C(P,q.sumx2,0),K+=q.len,L=L.concat(w);else{for(A=0,B=w;A<B.length;A++)t=B[A],f[t]=1;F.rjc.splice(o,1)}w=g,q=g}}else F.rjc.splice(o,1);else if(F.p1b)return D=i.TQc(F.AOc)[I].calc,E=!0,G&&(y=p(D,[k]),z=y[d.SubtotalType[k]],E=j.condition.evaluate(z),y=g),E?{calc:D,indexList:[F.alc]}:(f[F.alc]=1,g);return{calc:{count:J,sum:M,product:Q,max:N,min:O,sumx2:P,len:K},indexList:L}},a.prototype.dlc=function(a,b,c,d){var e,f,g,h,i,j,k,l=c.TQc(this.AOc);return l||(l={}),l[a]&&this.p1b||(e=1,f=0,g=0,h=0,i=-(1/0),j=1/0,k=0,l[a]={calc:{count:f,sum:h,max:i,min:j,sumx2:k,product:e,len:g}}),c.sRc(this.AOc,b,l,d),l[a]},a.prototype.HDc=function(a,b,c){var d,e,f,h=g,i=b[a.$ic];return i&&(d=i.conditionBySourceName,e=i.condition,f=c[i.conditionByName],h={valueFieldName:d,condition:e,subTotalType:f}),h},a.prototype.GDc=function(){var a={};e.vhc(this.rjc,function(b,c){a[b.nodeName]=c}),this.Hjc=a},a}(),b.QueryNode=B},"./src/pivot-cache.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./pivot-entry.ts"),e=c("Common"),f=c("./src/pivot-interface.ts"),g=c("./src/pivot-util.ts"),h=c("./src/pivot-sort.ts"),i=c("./src/pivot-calc-engine.ts"),j=null,k=new e.Common.ResourceManager(d.SR),l=k.getResource.bind(k),m=e.Common.D,n=function(){function a(a){var b=this;b.ny=a.dataType,b.Cj=a.name,b.hlc={},b.ny!==f.PivotDataType.number&&(b.dic={}),b.Yic=[],b.mi=a.index}return a.prototype.ilc=function(a){return this.ny!==f.PivotDataType.date||g.Fa(a)?a:g.oIc(a)+""},a.prototype.jlc=function(a,b){var c=this;return c.ny!==f.PivotDataType.number?c.mlc(a,b):void c.llc(a,b)},a.prototype.klc=function(a,b){var c,d,e,h,i=this,j=i.ny,k=i.Yic,l=i.dic,m=l&&l.length>0;if(k&&k.length>0){for(d=void 0===k[0],e=0;e<k.length;e++)h=m?l[k[e]]:k[e],"number"==typeof h?(a.containsNumber=!0,isFinite(h)&&Math.floor(h)===h||(c=!1),g.Fa(a.minValue)?a.minValue=h:a.minValue=Math.min(h,a.minValue),g.Fa(a.maxValue)?a.maxValue=h:a.maxValue=Math.max(h,a.maxValue)):j===f.PivotDataType.date?"string"!=typeof h||isNaN(Date.parse(h))?g.Fa(h)||(a.containsNonDate=!0):(a.containsDate=!0,g.Fa(a.minDate)?a.minDate=h:a.minDate=h<a.minDate?h:a.minDate,g.Fa(a.maxDate)?a.maxDate=h:a.maxDate=h>a.maxDate?h:a.maxDate):"string"==typeof h&&(a.containsString=!0),g.Fa(h)&&(a.containsBlank=!0);a.containsNumber===!0&&c!==!1&&(a.containsInteger=!0),(j!==f.PivotDataType.string||d)&&g.Fa(a.containsString)&&(a.containsString=!1),j===f.PivotDataType.date&&g.Fa(a.containsNonDate)&&(a.containsNonDate=!1)}},a.prototype.nlc=function(a){var b=this,c=a.containsString,d=a.containsNumber,e=a.containsDate,g=a.containsBlank,h=0;c&&h++,d&&h++,e&&h++,h>1&&(a.containsMixedTypes=!0),a.containsString&&a.containsMixedTypes?a.containsSemiMixedTypes=!0:b.ny===f.PivotDataType.string||g||(a.containsSemiMixedTypes=!1)},a.prototype.llc=function(a,b){var c=this,d=c.hlc,e=c.ilc(a),f=c.Yic;g.Fa(c.Ulc)&&(c.Ulc=a),g.Fa(c.Tlc)&&(c.Tlc=a),c.Ulc=c.Ulc<a?a:c.Ulc,c.Tlc=c.Tlc>a?a:c.Tlc,d[e]||(d[e]=[],f.push(e)),d[e].push(b)},a.prototype.mlc=function(a,b,c){var d,e,f,h=this,i=h.hlc,j=h.dic,k=h.Yic;return c&&2===h.ny&&!isNaN(Date.parse(a))&&(a=new Date(a)),g.Fa(a)?d=l().blank:2===h.ny?(h.Ulc=h.Ulc<a?a:h.Ulc,h.Tlc=h.Tlc>a?a:h.Tlc,d="string"==typeof a?d:g.formatDateToString(a)):d=h.ilc(a),g.Fa(d)&&(d=l().blank),f=j[d],g.Fa(f)?(e=k.push(d)-1,j[d]=e,i[e]=[]):e=f,i[e].push(b),e},a.prototype.olc=function(a,b){var c=this,d=c.hlc;c.ny===f.PivotDataType.number?(g.Fa(c.Ulc)&&(c.Ulc=a),g.Fa(c.Tlc)&&(c.Tlc=a),c.Ulc=c.Ulc<a?a:c.Ulc,c.Tlc=c.Tlc>a?a:c.Tlc):c.ny===f.PivotDataType.date&&c.ZRc(),d[a]||(d[a]=[]),d[a].push(b)},a.prototype.ZRc=function(){for(var a,b,c=this,d=c.Yic,e=0,f=d[e];!f||isNaN(Date.parse(f));)e++,f=d[e];for(a=f,b=f;e<d.length;e++)f=d[e],a=f<a?f:a,b=f>b?f:b;c.Tlc=new Date(a),c.Ulc=new Date(b)},a.prototype.getFieldsItemList=function(){return this.plc().concat()},a.prototype.getIndexesList=function(a){var b,c,d,e=this.qlc(),f=[];for(b=0,c=a;b<c.length;b++)d=c[b],f=f.concat(e[d]);return f},a.prototype.plc=function(){return[].concat(this.Ykc?this.Ykc:this.Yic)},a.prototype.qlc=function(){return this.rlc?this.rlc:this.hlc},a.prototype.TFc=function(){return this.QFc?this.QFc:this.dic},a.prototype.Zkc=function(a){var b=this,c=b.ny;return b.slc?b.slc[a]:c===f.PivotDataType.number?g.getNumberGroupItemKey(b,a):c===f.PivotDataType.date?g.getDateGroupItemKey(b,a):void 0},a.prototype.tlc=function(a,b){var c,d=this;d.tnb=a,c=d.slc={},g.vhc(Object.keys(a),function(b){g.vhc(a[b],function(a){c[a]=b})}),g.vhc(b,function(a){g.Fa(c[a])&&(c[a]=a)})},a.prototype.YFc=function(){var a=this;delete a.Tlc,delete a.Ulc,delete a.Vlc,delete a.IDc,delete a.Ykc,delete a.rlc,delete a.QFc,delete a.MFc,delete a.OFc,delete a.ZFc},a.prototype.$Rc=function(){var a,b,c,d=this,e={},i=d.ny,k=d.plc(),l=d.TFc();if(a=k.length>1e3?k.concat():h._Rc(k.concat(),{sortType:f.SortType.asc,isDate:i===f.PivotDataType.date,isNumberGroup:i===f.PivotDataType.number&&!g.Fa(d.Ykc),by:d.Vlc}),a&&a.length>0){for(b=0,c=a.length;b<c;b++)e[l[a[b]]]=b;d.aSc=e}else d.aSc=j},a.prototype.dispose=function(){var a=this;a.hlc=j,a.Yic=j,a.aSc=j,a.dic=j,a.Ykc=j,a.rlc=j,a.QFc=j,a.slc=j,a.ilc=j,a.HWc=j,a.Lqa=j,a.tnb=j,a.slc=j,a.ZFc=j,a.gSc=j},a.prototype.fromJson=function(a,b){var c,d,e,f,h=this;if(g.Fa(a.name)||(h.Cj=a.name),g.Fa(h.ny)&&!g.Fa(b)&&(h.ny=w(b.type)),c=a.entities,c&&c.length>0)for(h.dic||(h.dic={}),h.Yic=[],d=l().blank,e=void 0,f=0;f<c.length;f++)e=c[f].value,g.Fa(e)&&(e=d),2===h.ny&&(e=g.formatDateToString(new Date(e))),h.Yic.push(e),h.dic[e]=f},a.prototype.toJson=function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=g.Fa(n.Lqa)?{}:n.Lqa;if(g.Fa(n.Cj)||(o.name=n.Cj),g.Fa(n.mi)||(o.mi=n.mi),g.Fa(n.Yw)||(o.formula=n.Yw,o.databaseField=!1),n.MFc===!1&&(o.databaseField=!1),o.databaseField!==!1&&(n.klc(o,a),n.nlc(o)),g.isEmptyObject(n.dic))o.entities=[];else if(b=o.entities=[],c=n.Yic,c&&c.length>0)for(d=x(n.ny),e={},f=0;f<c.length;f++)h=c[f],i=(h+"").toLowerCase(),j=y(h,d),e[i]||(g.Fa(h)?b.push({type:"m"}):b.push({type:j,value:h}),e[i]=!0);return k=a&&a.getField(n.IDc),l=k&&k.mi,n.Ykc&&(g.Fa(n.Tlc)?g.isEmptyObject(n.tnb)||(o.fieldGroup={base:l},s(n,k,o)):"number"==typeof n.Tlc?(o.fieldGroup={startNum:n.Tlc,endNum:n.Ulc,groupInterval:n.Vlc,base:l,hasRangeGroup:!0},o.fieldGroup.groupItems=q(n.Tlc,n.Ulc,n.Vlc)):n.Tlc instanceof Date&&(o.fieldGroup={startDate:n.Tlc.getTime(),endDate:n.Ulc.getTime(),groupBy:K(n.Vlc),base:l,hasRangeGroup:!0},n.Ykc&&(m=n.Ykc.concat(),m=r(n.Tlc,n.Ulc,m,o.fieldGroup),o.fieldGroup.groupItems=m))),o},a.prototype.bOc=function(){return this.aSc},a}(),b.PivotCacheField=n;function q(a,b,c){var d=[];for(d.push({type:"s",value:"&lt;"+a});a-1+c<=b;)d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c;return d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c,d.push({type:"s",value:"&gt;"+a}),d}function r(a,b,c,e){var f,h;for(c&&c[0]===d.LESS+g.formatDateToString(a)?(c[0]="&lt;"+g.formatDateToString(a),e.autoStart=!1):c.unshift("&lt;"+g.formatDateToString(a)),c&&c[c.length-1]===d.MORE+g.formatDateToString(b)?(c[c.length-1]="&gt;"+g.formatDateToString(b),e.autoEnd=!1):c.push("&gt;"+g.formatDateToString(b)),f=[],h=0;h<c.length;h++)f.push({type:"s",value:c[h]});return f}function s(a,b,c){var d,e,f,g=a.tnb,h=c.fieldGroup.groupItems=[],i={},j=c.fieldGroup.discreteGroup=[];for(d in g)g.hasOwnProperty(d)&&(h.push({type:"s",value:d}),i[d]=h.length-1);for(e=0;e<b.Yic.length;e++)f=b.Yic[e],j.push(i[a.slc[f]])}function t(a,b,c,d){if(g.Fa(d[b.Cj+c])){var e=a.push({cacheName:b.Cj,index:b.mi,dataFieldIndex:b.OFc,subTotalType:c})-1;d[b.Cj+c]=e}}o=function(){function a(a,b,c,d){var e,f=this;f._kc=c?Array(c.length):[],f.Cj=a,f.ulc=b,f.HL={},f.NFc=0,f.TDc=d,b&&c&&(e=b.map(function(a){return f.vlc(a)}),f.zY(e,c)),f.ev()}return a.prototype.ev=function(){var a=this;a.Slc=new i.PivotCalcService,a.bSc=new i.PivotCalcSource(a.Slc),a.bSc.setPivotCache(a),a.Slc.cSc(a.bSc)},a.prototype.getDataRefer=function(){return this.TDc},a.prototype.getHeaderList=function(){var a,b,c,d=this,e=d.HL,h=[];for(c in e)m(e,c)&&(a=e[c],b={name:a.Cj,dataType:a.ny,index:a.mi},g.Fa(a.Yw)||(b.fieldType=f.PivotSourceFieldType.isCalcField),g.Fa(a.IDc)||(b.fieldType=f.PivotSourceFieldType.isGroupField),h[a.mi]=b);return h.slice()},a.prototype.eSc=function(){var a,b,c,d,e=this;if(g.Fa(e.ulc)){b=e.HL,c=void 0,a=[];for(d in b)m(b,d)&&(c=b[d],a[c.mi]={name:c.Cj,dataType:c.ny,index:c.mi});e.ulc=a}},a.prototype.CNc=function(a,b){var c,d,e,f,h,i,j,k,m,n,o,p,q,r,s=this,t=[],u=[],v=s.getHeaderList(),w=s._kc,x=[],y=s.HL,z=[],A=[],B=l().blank;for(i=0,j=v;i<j.length;i++)k=j[i],g.Fa(y[k.name].IDc)&&g.Fa(y[k.name].Yw)?x.push(k.name):u.push(k.index),z.push(y[k.name].Yic),h=y[k.name].dic,h&&Object.keys(h).length>0?A.push(1):A.push(0);if(t.push(x),x=[],b)for(m=0,n=w;m<n.length;m++){for(k=n[m],d=k.slice(0),e=d.length,c=0,o=0;o<e;o++)u.indexOf(o)>-1||(A[o]?(f=z[o][d[o]],f===B&&(f=null),x[c]=f):x[c]=d[o]===B?null:d[o],c++);t.push(x),x=[]}else for(p=0,q=a;p<q.length;p++){for(r=q[p],d=w[r].slice(),e=d.length,c=0,o=0;o<e;o++)u.indexOf(o)>-1||(A[o]?(f=z[o][d[o]],f===B&&(f=null),x[c]=f):x[c]=d[o]===B?null:d[o],c++);t.push(x),x=[]}return t},a.prototype.oNc=function(a,b){var c,d,e,f,h=this,i=h.VNc,j=h.UNc(),k=[];for(c=0;c<j.length;c++)j[c]&&k.push({name:j[c].Cj,formula:j[c].Yw});if(d=h.Slc,e=h.TDc,h.dispose(),h.Slc=d,h.TDc=e,h._kc=[],h.ulc=a,h.NFc=0,a&&b&&(f=a.map(function(a){return h.vlc(a)}),h.zY(f,b)),h.ev(),g.Fa(i)||h.fSc(i),k.length>0)for(c=0;c<k.length;c++)h.addCalcField(k[c].name,k[c].formula)},a.prototype.fSc=function(a){var b,c=this;for(b in a)m(a,b)&&c.uic(a[b])},a.prototype.wlc=function(a){return this.TDc===a},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldsNames=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&(b[c[a].mi]=c[a].Cj);return b},a.prototype.zY=function(a,b){var c,d,e=this,h=l().blank,i=b.length||0;g.vhc(a,function(a,c){var d,e;if(a.ny===f.PivotDataType.number||a.ny===f.PivotDataType.date){for(d=a.ny===f.PivotDataType.number?function(a){return"number"==typeof a}:function(a){return a instanceof Date},e=0;(!b[e]||g.Fa(b[e][c])||!d(b[e][c]))&&e<i;)e++;a.Tlc=b[e][c],a.Ulc=b[e][c]}}),g.vhc(b,function(b,f){g.vhc(a,function(a,e){d=b[e],(g.Fa(d)||""===d)&&(b[e]=h),c=a.jlc(d,f),g.Fa(c)||(b[e]=c)}),e._kc[f]=b}),g.vhc(a,function(a){a.ny!==f.PivotDataType.string&&a.ny!==f.PivotDataType.date||a.$Rc()})},a.prototype.xlc=function(a,b){var c,d,e=this,h=b.pivotCacheRecords;h&&h.length>0&&(c=h[0],d=l().blank,g.vhc(h,function(b,h){var i=[];g.vhc(a,function(a,e){var j,k=b[e]&&b[e].value;g.Fa(k)&&(k=d),j=c[e]&&c[e].type||w(a.ny),"x"===j?a.olc(k,h):"m"===j||g.Fa(j)?(g.Fa(k)||(a.ny=f.PivotDataType.string),k=a.mlc(k,h,!0)):"n"!==j?k=a.mlc(k,h,!0):a.llc(k,h),i[e]=k}),e._kc.push(i)}),g.vhc(a,function(a){a.ny===f.PivotDataType.date&&a.ZRc(),(a.ny===f.PivotDataType.string||a.ny===f.PivotDataType.date||a.ny===f.PivotDataType.number&&!g.Fa(a.dic))&&a.$Rc()}),delete b.pivotCacheRecords)},a.prototype.getField=function(a){return this.HL[a]},a.prototype.vlc=function(a){var b=this,c=new n(a);return g.Fa(c.mi)&&(c.mi=b.NFc),g.Fa(b.HL[c.Cj])&&b.NFc++,b.HL[c.Cj]=c,c},a.prototype.$Sb=function(a){return this.HL[a]},a.prototype.ylc=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},a.prototype.zlc=function(a,b){var c=this.HL[a];return b.reduce(function(a,b){return a.concat(c.hlc[b]||[])},[])},a.prototype.Alc=function(a){var b=this,c=a.map(function(a){var c=a.sourceName,d=a.items,e=b.$Sb(c);return e?e.getIndexesList(d):[]});return this.Blc(g.kic(c))},a.prototype.Blc=function(a){var b,c,d,e=[];for(b=0,c=a;b<c.length;b++)d=c[b],e.push(this._kc[d]);return e},a.prototype.addField=function(a){var b=this;a&&!g.Fa(a.Cj)&&(g.Fa(b.HL[a.Cj])?(g.Fa(a.mi)&&(a.mi=b.NFc),g.Fa(b.HL[a.Cj])&&b.NFc++):a.mi=b.HL[a.Cj].mi,b.HL[a.Cj]=a)},a.prototype.removeField=function(a){var b=this;!a||g.Fa(a.Cj)||g.Fa(b.HL[a.Cj])||(g.Fa(a.mi)||b.$Fc(a.mi),delete b.HL[a.Cj],b.NFc--)},a.prototype.removeCalcField=function(a){var b=this,c=b.getField(a);c&&!g.Fa(c.Yw)&&b.removeField(c)},a.prototype.$Fc=function(a){var b,c,d=this,e=d.HL;for(b in e)e.hasOwnProperty(b)&&(c=e[b],c&&!g.Fa(c.mi)&&c.mi>a&&c.mi--)},a.prototype.dispose=function(){var a,b=this;b._kc=j,b.Slc=j,b.bSc=j;for(a in b.HL)b.HL.hasOwnProperty(a)&&(b.HL[a].dispose(),delete b.HL[a]);b.ulc=j,b.TDc=j,b.Lqa=j,b.VNc=j},a.prototype.Clc=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)e.push(d.HL[a[b].fieldName].hlc[a[b].item]);return c=g.kic(e),d.Blc(c)},a.prototype.lic=function(a){var b,c,d,e,f,h,i=this,j=[];for(b=0;b<a.length;b++)if(c=i.HL[a[b].fieldName],g.Fa(c.HWc))j.push(c.hlc[a[b].item]);else{for(d=c.HWc[a[b].item],e=!1,f=c._baseFieldName,h=0;h<a.length;h++)f===a[h].fieldName&&g.Dlc(d,a[h].item)&&(e=!0);if(!e)return[]}return g.kic(j)},a.prototype.mic=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)c=d.$Sb(a[b].sourceName),c&&e.push(c.getIndexesList(a[b].items));return g.kic(e)},a.prototype.Elc=function(a){var b=this;return!!b.HL[a]},a.prototype.PFc=function(a){var b,c=this.HL;for(b in c)if(c.hasOwnProperty(b)&&c[b].mi===a)return c[b]},a.prototype.Flc=function(a){this.HL[a.Cj]=a},a.prototype.uic=function(a){var b,c,e,h,i,j,k,l=this;return g.Fa(l.VNc)&&(l.VNc={}),b=l.VNc,c=d.GNc(a),e=l.getField(a.originFieldName),!g.Fa(e)&&(b[a.originFieldName]=c,h=a.textGroup,h?(i=h.groupItems,j=new n({dataType:e.ny,name:h.fieldName,index:e.mi}),z(i,e.Yic),j.Ykc=[],j.rlc={},j.QFc={},g.vhc(Object.keys(i),function(a,b){j.Ykc.push(a),j.QFc[a]=b,j.rlc[a]=[],g.vhc(i[a],function(b){j.rlc[a]=g.uIc(j.rlc[a],e.hlc[e.dic[b]])})}),j.tlc(i,e.Yic),j.tnb=i,j.IDc=e.Cj,j.MFc=!1,j.OFc=e.mi,delete j.mi,j.$Rc(),l.addField(j)):e.ny!==f.PivotDataType.number||g.Fa(a.numberGroup)?e.ny===f.PivotDataType.date&&I(l,e,a.dateGroups):(k=a.numberGroup,C(e,k.start,k.end,k.by)),!0)},a.prototype.zWc=function(a,b,c){var d,e,f,h,i=this;return!g.Fa(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(h=i.$Sb(a),h.IDc!==b))))},a.prototype.XFc=function(a){var b,c,d,e,f,h,i,j,k,l=this,n=l.VNc;if(!g.Fa(n))for(b in n)if(m(n,b)&&(c=n[b],l.zWc(a,b,c))){delete n[b];break}if(d=l.getField(a),e=[],g.Fa(d.rlc))return e;if(d.tnb)e.push(d.Cj),l.removeField(d);else if("number"==typeof d.Tlc)d.YFc();else if(d.Tlc instanceof Date){for(f=d,!g.Fa(d.OFc)&&g.Fa(d.ZFc)&&(f=l.PFc(d.OFc)),h=f.ZFc,i=0,j=h.length;i<j;i++)k=l.getField(h[i]),l.removeField(k);delete n[f.Cj],e=e.concat(h),f.YFc(),f.$Rc()}return e},a.prototype.bGc=function(a){var b,c,d,e,f=this,h=f.getField(a),i=[];if(!g.Fa(h)&&(b=h,g.Fa(b._baseFieldName)||(b=f.getField(b._baseFieldName)),!g.Fa(b)&&!g.Fa(b.ZFc)&&b.ZFc.length>0))for(i.push(b),c=b.ZFc,d=0,e=c.length;d<e;d++)i.push(f.getField(c[d]));
return i},a.prototype.UNc=function(){var a,b=this.HL,c=[];for(a in b)b.hasOwnProperty(a)&&!g.Fa(b[a].Yw)&&c.push(b[a]);return c},a.prototype.addCalcField=function(a,b){var c,d,e=this,g=new n({dataType:f.PivotDataType.number,name:a});g.Yw=b,g.MFc=!1,c=e.Slc,d=e.bSc,g.gSc=c.parseFormulaToCalcRelatedFieldNames(b),g.C_b=c.calcService.parse(d,b,0,0),e.addField(g)},a.prototype.HRc=function(a){var b,c,d,e,h,i,j,k=this,l=[],m={},n=[],o={},p=[],q=[],r={normalFieldsInfos:l,calcFieldsInfos:n};for(b=0,c=a.length;b<c;b++)d=k.getField(a[b].cacheName),g.Fa(d.Yw)?t(l,d,a[b].subTotalType,m):k.hSc(d.Cj,p,q);for(e=0,h=p.length;e<h;e++)i=k.getField(p[e]),t(l,i,f.SubtotalType.sum,m);for(e=0,h=q.length;e<h;e++)j=k.getField(q[e]),t(n,j,f.SubtotalType.sum,o);return r},a.prototype.iSc=function(a){var b,c,d,e=this,f=[];for(b=0,c=a.length;b<c;b++)d=e.getField(a[b].cacheName),g.Fa(d.Yw)||f.push(d);return f},a.prototype.hSc=function(a,b,c){var d,e,f,h,i=this,j=i.getField(a),k=j.gSc;for(d=0,e=k.length;d<e;d++)f=k[d],h=i.getField(f),g.Fa(h.Yw)?b.push(f):i.hSc(f,b,c);c.push(j.Cj)},a.prototype.GRc=function(a){var b,c=this,d=c.HL,e=[];g.vhc(a,function(a){var b=d[a];b&&g.Fa(b.dic)&&(b.hlc={},b.dic={},b.Yic=[],e.push(b))}),b=c._kc,g.vhc(b,function(a,b){g.vhc(e,function(c){var d=c.mi;a[d]=c.mlc(a[d],b,!1)})}),g.vhc(e,function(a){a.$Rc()})},a.prototype.fromJson=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,v,x,y,z,A,B,C,D,E=this;if(E.Lqa=b,g.Fa(b.name)?E.Cj=a:E.Cj=b.name,g.Fa(a)||(E.mEc=+a),g.Fa(b.recordCount)||(E.recordCount=b.recordCount),g.Fa(b.sourceType)||(E.sourceType=b.sourceType,E.TDc="",g.Fa(b.sheet)||(E.TDc=b.sheet,E.sheet=b.sheet,g.Fa(b.ref)||(E.TDc=E.TDc+"!"+b.ref,E.ref=b.ref)),g.Fa(b.sourceName)||(E.TDc=b.sourceName,E.sourceName=b.sourceName)),d=b.fields,e=[],f=[],h=[],d&&d.length>0)for(i=0;i<d.length;i++){if(j=d[i],k=j.fieldGroup,j.mi=i,k){if(!g.Fa(k.base)&&(g.Fa(j.entities)||0===j.entities.length)&&!g.Fa(k.startDate)){g.Fa(d[k.base])||g.Fa(d[k.base].fieldGroup)||!g.Fa(d[k.base].fieldGroup.JDc)||(d[k.base].fieldGroup.JDc=[]),d[k.base].fieldGroup.JDc.push(j);continue}if(f.push(j),!g.Fa(k.discreteGroup))continue}if(g.Fa(j.formula)){if(l=j.entities,m={},m.name=j.name,m.index=i,l&&l.length>0)m.dataType=w(l[0].type);else if(b.ulc)for(n=0,o=b.ulc;n<o.length;n++)p=o[n],p.name===m.name&&(m.dataType=p.dataType);q=E.vlc(m),q.fromJson(j,b.pivotCacheRecords[0][i]),e.push(q)}else h.push(j)}if(E.xlc(e,b),f.length>0)for(i=0;i<f.length;i++)if(j=f[i],k=j.fieldGroup,k&&(r=g.Fa(k.base)?j:d[k.base]))if(s={},s.originFieldName=r.name,g.Fa(k.groupInterval))if(g.Fa(k.groupBy)){if(g.Fa(k.parent)){if(z=k.discreteGroup,A=k.groupItems,z&&z.length>0&&A&&A.length>0)for(s.textGroup={fieldName:j.name,groupItems:{}},B=s.textGroup.groupItems,x=0;x<z.length;x++)C=!g.Fa(z[x])&&A[z[x]]&&A[z[x]].value,g.Fa(B[C])&&(B[C]=[]),B[C].push(r.entities[x]&&r.entities[x].value);E.uic(s)}}else{if(t=[{start:new Date(k.startDate),end:new Date(k.endDate),by:J(k.groupBy)}],v=k.JDc,v&&v.length>0)for(x=0;x<v.length;x++)y=v[x].fieldGroup,t.push({start:new Date(y.startDate),end:new Date(y.endDate),by:J(y.groupBy)});s.dateGroups=t,E.uic(s)}else s.numberGroup={start:k.startNum,end:k.endNum,by:k.groupInterval},E.uic(s);if(h.length>0)for(i=0;i<h.length;i++)D=h[i],E.addCalcField(D.name,D.formula);u(d,E.HL),E.eSc()},a.prototype.toJson=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,n=g.Fa(m.Lqa)?{}:m.Lqa;if(g.Fa(m.mEc)||(n.cacheId=m.mEc),g.Fa(m.Cj)||(n.name=m.Cj),g.Fa(m.recordCount)||(n.recordCount=m._kc&&m._kc.length),g.Fa(m.TDc)||(n.TDc=m.TDc),g.Fa(m.sourceType)||(n.sourceType=m.sourceType,g.Fa(m.sheet)||(n.sheet=m.sheet),g.Fa(m.ref)||(n.ref=m.ref),g.Fa(m.sourceName)||(n.sourceName=m.sourceName)),m.HL&&!g.isEmptyObject(m.HL)){b=[];for(c in a)a.hasOwnProperty(c)&&b.push(c);m.GRc(b),v(m,a),d=n.fields=[],e={};for(f in m.HL)m.HL.hasOwnProperty(f)&&d.push(m.HL[f].toJson(m));for(d.sort(function(a,b){return a.mi-b.mi}),h=[],i=0;i<d.length;i++)d[i].entities&&d[i].entities.length>0?h.push("x"):g.Fa(d[i].type)?h.push("n"):h.push(d[i].type),g.Fa(d[i].formula)||(e[i]=!0);for(j=[],i=0;i<m._kc.length;i++){for(k=[],l=0;l<m._kc[i].length;l++)e[l]!==!0&&k.push({type:h[l],value:m._kc[i][l]});j.push(k)}n.pivotCacheRecords=j,n.ulc=m.ulc}return n},a}(),b.PivotCache=o;function u(a,b){if(a)for(var c=0;c<a.length;c++)g.Fa(a[c].name)||!b[a[c].name]||g.Fa(a[c].mi)||(b[a[c].name].mi=a[c].mi)}function v(a,b){var c,d,e,f,h,i=a.HL;for(c in b)if(b.hasOwnProperty(c)&&i[c]&&(d=i[c],d&&g.Fa(d.dic)))for(d.hlc={},d.dic={},d.Yic=[],e=a._kc,f=d.mi,h=0;h<e.length;h++)e[h][f]=d.mlc(e[h][f],h,!1)}function w(a){switch(a){case"b":return f.PivotDataType.boolean;case"d":return f.PivotDataType.date;case"e":return f.PivotDataType.errorValue;case"m":return f.PivotDataType.noValue;case"n":return f.PivotDataType.number;case"s":return f.PivotDataType.string;default:return}}function x(a){switch(a){case f.PivotDataType.boolean:return"b";case f.PivotDataType.date:return"d";case f.PivotDataType.errorValue:return"e";case f.PivotDataType.noValue:return"m";case f.PivotDataType.number:return"n";case f.PivotDataType.string:return"s";default:return"n"}}function y(a,b){var c=typeof a;return void 0===a?"m":"boolean"===c?"b":"number"===c?"n":"string"===c?"d"!==b||isNaN(Date.parse(a))?"s":"d":"e"}function z(a,b){var c,d={};for(g.vhc(Object.keys(a),function(b){for(var c=0;c<a[b].length;c++)d[a[b][c]]=1}),c=0;c<b.length;c++)g.Fa(d[b[c]])&&(a[b[c]]=[b[c]])}p=function(){function a(a,b,c,d){var e=this;e.Tlc=a,e.Ulc=b,e.groupItemsIndexMap={},e.groupItemsKeyIndexes={},"number"===d?(g.Fa(a)||g.Fa(c)?e.jSc=b:e.jSc=a+Math.ceil((b-a)/c)*c,B(e,c,a,e.jSc)):A(e,c,a,b),e.Vlc=c,e.type=d,e.name=this.getName(c)}return a.prototype.getName=function(a){var b=l().dateResource;switch(a){case f.DateGroupType.seconds:return b.Seconds;case f.DateGroupType.minutes:return b.Minutes;case f.DateGroupType.hours:return b.Hours;case f.DateGroupType.days:return b.Days;case f.DateGroupType.months:return b.Months;case f.DateGroupType.quarters:return b.Quarters;case f.DateGroupType.years:return b.Years}},a.prototype.insertIndexToIndexMap=function(a,b){var c,d=this,e=d.groupItemsKeyList,f=d.groupItemsIndexMap,h=d.groupItemsKeyIndexes;c="number"===d.type?g.getNumberGroupItemKey(d,a):g.getDateGroupItemKey(d,a),g.Fa(f[c])&&(f[c]=[],e.push(c),h[c]=e.length-1),f[c]=g.uIc(f[c],b)},a}();function A(a,b,c,e){var h,i,j,k,l;switch(b){case f.DateGroupType.seconds:a.groupItemsKeyList=g.SECOND_GROUP_ITEMS;break;case f.DateGroupType.minutes:a.groupItemsKeyList=g.SECOND_GROUP_ITEMS;break;case f.DateGroupType.hours:a.groupItemsKeyList=g.HOUR_GROUP_ITEMS;break;case f.DateGroupType.days:a.groupItemsKeyList=g.vIc();break;case f.DateGroupType.months:a.groupItemsKeyList=g.wIc();break;case f.DateGroupType.quarters:a.groupItemsKeyList=g.xIc();break;case f.DateGroupType.years:if(c&&e){for(h=[],i=c.getFullYear(),j=e.getFullYear(),k=i;k<=j;k++)h.push(""+k);a.groupItemsKeyList=h}break;default:a.groupItemsKeyList=[]}for(c&&a.groupItemsKeyList.unshift(d.LESS+g.formatDateToString(c)),e&&a.groupItemsKeyList.push(d.MORE+g.formatDateToString(e)),k=0;k<a.groupItemsKeyList.length;k++)l=a.groupItemsKeyList[k],a.groupItemsIndexMap[l]=[],a.groupItemsKeyIndexes[l]=k}function B(a,b,c,e){var f,g,h;for(a.groupItemsKeyList=[],a.groupItemsKeyList.push(d.LESS+c),f=c;f<e;)a.groupItemsKeyList.push(f+"-"+(f+b-1)),f+=b;for(a.groupItemsKeyList.push(d.MORE+e),g=0;g<a.groupItemsKeyList.length;g++)h=a.groupItemsKeyList[g],a.groupItemsIndexMap[h]=[],a.groupItemsKeyIndexes[h]=g}function C(a,b,c,d){var e,f,h,i,j;if(!(c-b<=0)&&d>0){for(e=a.hlc,f=a.Yic,h=a.dic,g.Fa(b)&&(b=a.Tlc||D(a.Yic)),g.Fa(c)&&(c=a.Ulc||E(a.Yic)),a.Tlc=b,a.Ulc=c,a.Vlc=d,a.IDc=a.Cj,i=new p(b,c,d,"number"),a.jSc=i.jSc,j=0;j<f.length;j++)i.insertIndexToIndexMap(f[j],e[g.isEmptyObject(h)?""+f[j]:h[""+f[j]]]);a.Ykc=i.groupItemsKeyList,a.rlc=i.groupItemsIndexMap,a.QFc=i.groupItemsKeyIndexes,a.$Rc()}}function D(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.min(d,+a[b]);return d}function E(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.max(d,+a[b]);return d}function F(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d<a[b]?d:a[b];return new Date(d)}function G(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d>a[b]?d:a[b];return new Date(d)}function H(a,b,c){return g.Fa(c)?(c=1,a.$Sb(b)?a.$Sb(b+c)?void 0:b+c:b):H(a,b,c+1)}function I(a,b,c){var d,e,f,h,i,j,k,l,m,o,q,r,s,t;if(c){for(c.sort(function(a,b){return a.by-b.by}),d=[],h=0;h<c.length;h++){if(i=c[h].start,j=c[h].end,k=c[h].by,g.Fa(i)&&(i=g.Fa(e)?e=b.Tlc||F(b.Yic):e),g.Fa(j)&&(j=g.Fa(f)?f=b.Ulc||G(b.Yic):f),j<=i)return;d.push(new p(i,j,k,"date"))}for(l=b.hlc,m=b.Yic,o=b.dic,q=0,r=b.Yic.length;q<r;q++)for(s=0;s<d.length;s++)d[s].insertIndexToIndexMap(b.Yic[q],l[o[m[q]]]);for(b.Ykc=d[0].groupItemsKeyList,b.rlc=d[0].groupItemsIndexMap,b.QFc=d[0].groupItemsKeyIndexes,b.Tlc=d[0].Tlc,b.Ulc=d[0].Ulc,b.Vlc=d[0].Vlc,b.IDc=b.Cj,b.$Rc(),b.ZFc=[],s=1;s<d.length;s++)t=new n({dataType:b.ny,name:H(a,d[s].name)}),t.Ykc=d[s].groupItemsKeyList,t.rlc=d[s].groupItemsIndexMap,t.QFc=d[s].groupItemsKeyIndexes,t.Tlc=d[s].Tlc,t.Ulc=d[s].Ulc,t.Vlc=d[s].Vlc,t.IDc=b.Cj,t.MFc=!1,t.OFc=b.mi,t.$Rc(),b.ZFc.push(t.Cj),a.addField(t)}}function J(a){switch(a){case"seconds":return f.DateGroupType.seconds;case"minutes":return f.DateGroupType.minutes;case"hours":return f.DateGroupType.hours;case"days":return f.DateGroupType.days;case"months":return f.DateGroupType.months;case"quarters":return f.DateGroupType.quarters;case"years":return f.DateGroupType.years}}function K(a){switch(a){case f.DateGroupType.seconds:return"seconds";case f.DateGroupType.minutes:return"minutes";case f.DateGroupType.hours:return"hours";case f.DateGroupType.days:return"days";case f.DateGroupType.months:return"months";case f.DateGroupType.quarters:return"quarters";case f.DateGroupType.years:return"years"}}},"./src/pivot-calc-engine.ts":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./src/pivot-util.ts"),f=function(a){i(b,a);function b(b){return a.call(this,b)||this}return b.prototype.setPivotCache=function(a){this.pivotCache=a},b.prototype.resolveToken=function(a,b,c,e,f){var g,h=c[e],i=this.pivotCache.HL;if(0===h.Nc&&i[h.ni])return g=new d.Expression(14),g.value=h.ni,{expr:g,index:e+1}},b}(d.TokenResolver),g=function(a){i(b,a);function b(b){var c=a.call(this,b)||this;return c.resolvers=[new d.DefaultTokenResolver(5e3)],c}return b.prototype.setPivotCache=function(a){this.pivotCache=a;var b=new f(6e3);b.setPivotCache(a),this.resolvers.unshift(b)},b.prototype.getResolver=function(){return this.resolvers},b.prototype.getField=function(a){var b=this.measureNode;if(!e.Fa(b))return b[a]&&b[a].calc&&b[a].calc.sum},b.prototype.setMeasureNode=function(a){this.measureNode=a},b}(d.CalcSource),b.PivotCalcSource=g;function j(a,b){var c;if(14===a.type)b.push(a.value);else if(a.value instanceof d.Expression)j(a.value,b);else if(Array.isArray(a.value))for(c=0;c<a.value.length;c++)a.value[c]instanceof d.Expression&&j(a.value[c],b);else if(Array.isArray(a.arguments))for(c=0;c<a.arguments.length;c++)a.arguments[c]instanceof d.Expression&&j(a.arguments[c],b)}h=function(){function a(){this.calcService=new d.CalcService}return a.prototype.cSc=function(a){this.calcSource=a},a.prototype.parseFormulaToCalcRelatedFieldNames=function(a){var b,c,d,e,f,g,h,i=this,k=i.calcService,l=i.calcSource,m=k.getParserContext(l);for(m.useR1C1=k.useR1C1,m.row=0,m.column=0,b=k.kh,c=a.split(""),d=b.parseToTokens(m,c,!0),e=b.ii(m,d,!0),f=[],g=0,h=e.length;g<h;g++)j(e[g],f);return f},a.prototype.getResolvers=function(){return this.calcSource.getResolver()},a}(),b.PivotCalcService=h},"./src/pivot-condition.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=void 0;function k(a,b,c){switch(a){case d.PivotValueFilterOperator.equalsTo:return function(a){return b===+a};case d.PivotValueFilterOperator.notEqualsTo:return function(a){return b!==+a};case d.PivotValueFilterOperator.greaterThan:return function(a){return+a>b};case d.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(a){return+a>=b};case d.PivotValueFilterOperator.lessThan:return function(a){return+a<b};case d.PivotValueFilterOperator.lessThanOrEqualsTo:return function(a){return+a<=b};case d.PivotValueFilterOperator.between:return function(a){return+a>=b&&+a<=c};case d.PivotValueFilterOperator.notBetween:return function(a){return+a<b||+a>c}}}g=function(){function a(a,b,c){var g,h,i;this.glc=d.PivotConditionType.value,g=this,g.Glc=a,h=isNaN(+b)?NaN:+b,e.Fa(c)?(g.aRa=f,g._Qa=h):(i=isNaN(+c)?NaN:+c,g._Qa=Math.min(h,i),g.aRa=Math.max(h,i)),g.evaluate=k(a,g._Qa,g.aRa)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c;return c=a.Glc===d.PivotValueFilterOperator.between||d.PivotValueFilterOperator.notBetween?[a._Qa,a.aRa]:[a._Qa],{conType:d.PivotConditionType.value,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.Glc=c,b instanceof Array?(d._Qa=b[0],d.aRa=b[1]):(d._Qa=b,d.aRa=f),d.evaluate=k(d.Glc,d._Qa,d.aRa)},a}(),b.PivotFilterValueCondition=g;function l(a){var b,c,f,g,h,i,j,k,l=this.Glc,m=this.Nc,n=this.Hlc;if(a){if(a.sort(function(a,b){return a.value-b.value}),b=a.length,c=void 0,f=0,g=l===d.PivotTop10FilterOperator.top,m===d.PivotTop10FilterType.count)f=n;else if(m===d.PivotTop10FilterType.sum)for(h=0;h<n;)f++,h+=a[g?b-f:f].value;else if(m===d.PivotTop10FilterType.percent){for(h=0,i=0,j=0;j<b;j++)i+=a[j].value;for(;h/i<n/100;)f++,h+=a[b-f].value}return c=g?a.slice(-1*f):a.slice(0,f),k={},e.vhc(c,function(a){k[a.index]=!0}),k}}h=function(){function a(a,b,c){this.glc=d.PivotConditionType.top10;var e=this;e.Glc=a,e.Nc=b,e.Hlc=c,e.evaluate=l}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=a.Hlc,e=a.Nc;return{conType:d.PivotConditionType.top10,val:c,type:e,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.type,e=this;e.Glc=c,e.Nc=d,e.Hlc=b},a}(),b.PivotFilterTop10Condition=h;function m(a,b,c){switch(a){case d.PivotCaptionFilterOperator.equalsTo:return function(a){return e._Dc(b,a)};case d.PivotCaptionFilterOperator.notEqualsTo:return function(a){return!e._Dc(b,a)};case d.PivotCaptionFilterOperator.beginsWith:return function(a){return e.Ilc(b,a)};case d.PivotCaptionFilterOperator.doesNotBeginWith:return function(a){return!e.Ilc(b,a)};case d.PivotCaptionFilterOperator.endsWith:return function(a){return e.Jlc(b,a)};case d.PivotCaptionFilterOperator.doesNotEndWith:return function(a){return!e.Jlc(b,a)};case d.PivotCaptionFilterOperator.contains:return function(a){return e.Klc(b,a)};case d.PivotCaptionFilterOperator.doesNotContain:return function(a){return!e.Klc(b,a)};case d.PivotCaptionFilterOperator.greaterThan:return function(a){return(a+"").localeCompare(b)>0};case d.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(a){return(a+"").localeCompare(b)>=0};case d.PivotCaptionFilterOperator.lessThan:return function(a){return(a+"").localeCompare(b)<0};case d.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(a){return(a+"").localeCompare(b)<=0};case d.PivotCaptionFilterOperator.between:return function(a){return(a+"").localeCompare(b)>=0&&(a+"").localeCompare(c)<=0};case d.PivotCaptionFilterOperator.notBetween:return function(a){return(a+"").localeCompare(b)<0||(a+"").localeCompare(c)>0}}}i=function(){function a(a,b,c){this.glc=d.PivotConditionType.caption;var e=this;this.Glc=a,e._Qa=b?b+"":b,e.aRa=c?c+"":c,e.evaluate=m(a,e._Qa,e.aRa)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa];return{conType:d.PivotConditionType.caption,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.Glc=c,d._Qa=b[0],d.aRa=b[1],d.evaluate=m(d.Glc,d._Qa,d.aRa)},a}(),b.PivotFilterCaptionCondition=i;function n(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.Llc(c).getTime():c.getTime?c.getTime():b}function o(a,b,c,d){return n(d,a)>=n(d,b)&&n(d,a)<=n(d,c)}function p(a,b,c,f){if(a<=d.PivotDateFilterOperator.notBetween)switch(a){case d.PivotDateFilterOperator.equalsTo:return function(a){return n(f,b)===n(f,a)};case d.PivotDateFilterOperator.notEqualsTo:return function(a){return n(f,b)!==n(f,a)};case d.PivotDateFilterOperator.before:return function(a){return n(f,b)>n(f,a)};case d.PivotDateFilterOperator.beforeEqualsTo:return function(a){return n(f,b)>=n(f,a)};case d.PivotDateFilterOperator.after:return function(a){return n(f,b)<n(f,a)};case d.PivotDateFilterOperator.afterEqualsTo:return function(a){return n(f,b)<=n(f,a)};case d.PivotDateFilterOperator.Between:return function(a){return o(a,b,c,f)};case d.PivotDateFilterOperator.notBetween:return function(a){return n(f,a)<n(f,b)||n(f,a)>n(f,c)}}if(a>=8&&a<=23)switch(a){case d.PivotDateFilterOperator.today:return function(a){return n(f)===n(f,a)};case d.PivotDateFilterOperator.yesterday:return function(a){return n(f)-e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.tomorrow:return function(a){return n(f)+e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.last7Days:return function(a){var b=n(f),c=n(f,a);return b-7*e.PRE_DAY>=c&&c<b};case d.PivotDateFilterOperator.thisMonth:return function(a){var b=new Date;return b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.lastMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()-1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.nextMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()+1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.thisWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()),c.setDate(c.getDate()-c.getDay()+6),a>=b&&a<=c};case d.PivotDateFilterOperator.lastWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()-7),c.setDate(c.getDate()-c.getDay()),a>=b&&a<=c};case d.PivotDateFilterOperator.nextWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()+7),c.setDate(c.getDate()-c.getDay()+14),a>=b&&a<=c};case d.PivotDateFilterOperator.nextQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g+3),b=e.Llc(new Date),b.setMonth(f-g+6),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<e.Llc(b)};case d.PivotDateFilterOperator.thisQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g),b=e.Llc(new Date),b.setMonth(f-g+3),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<=e.Llc(b)};case d.PivotDateFilterOperator.lastQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g-3),b=e.Llc(new Date),b.setMonth(f-g),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<e.Llc(b)};case d.PivotDateFilterOperator.nextYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()+1===a.getFullYear()};case d.PivotDateFilterOperator.thisYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()===a.getFullYear()};case d.PivotDateFilterOperator.lastYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()-1===a.getFullYear()}}return a>=d.PivotDateFilterOperator.Q1&&a<=d.PivotDateFilterOperator.Q4?function(b){return a-d.PivotDateFilterOperator.Q1===Math.floor(b.getMonth()/3)}:a>=d.PivotDateFilterOperator.M1&&a<=d.PivotDateFilterOperator.M12?function(b){return a-d.PivotDateFilterOperator.M1===b.getMonth()}:a===d.PivotDateFilterOperator.yearToDate?function(a){var b=new Date,c=new Date;return b.setMonth(0,1),b.setHours(0,0,0,0),c.setHours(23,59,59,59),a>=b&&a<=c}:void 0}j=function(){function a(a,b,c,e){this.glc=d.PivotConditionType.date;var f=this;f.Glc=a,f._Qa=c,f.aRa=e,f.Mlc=b,f.evaluate=p(a,f._Qa,f.aRa,b)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=a.Mlc,f;return f=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa],{conType:d.PivotConditionType.date,val:f,operator:b,isWholeDay:c}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.isWholeDay,e=this;e.Glc=c,e.Mlc=d,b instanceof Array?(e._Qa=b[0],e.aRa=b[1]):(e._Qa=b,e.aRa=f),e.evaluate=p(e.Glc,e._Qa,e.aRa,d)},a}(),b.PivotFilterDateCondition=j},"./src/pivot-engine.ts":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-cache.ts"),e=c("./src/data-analyzer.ts"),f=c("./src/pivot-util.ts");function h(a,b){var c,d=b[0].length;for(c=0;c<b.length;c++)b[c][d]=a.getValue(c,0);return b}g=function(){function a(){var a=this;a.Plc={},a.Rlc=new e.DataAnalyzer,a.nEc=1}return a.prototype.hasPivotCache=function(a){return!!this.Plc[a]},a.prototype.addPivotCache=function(a){var b=this;return b.Plc[a.getName()]=a,f.Fa(a.mEc)?(a.mEc=b.nEc,b.nEc++):a.mEc>b.nEc&&(b.nEc=a.mEc),a},a.prototype.getPivotCacheByName=function(a){return this.Plc[a]},a.prototype.getPivotCacheByCacheId=function(a){var b,c=this,d=c.Plc;for(b in d)if(d.hasOwnProperty(b)&&d[b].mEc===a)return d[b]},a.prototype.fkc=function(a){var b,c=this;for(b in c.Plc)if(c.Plc.hasOwnProperty(b)&&c.Plc[b].wlc(a))return c.Plc[b];return null},a.prototype.dispose=function(){var a,b=this;for(a in b.Plc)b.Plc.hasOwnProperty(a)&&b.Plc[a].dispose();b.Plc={},b.Rlc=null},a.prototype.reset=function(){this.Plc={}},a.prototype.update=function(){},a.prototype.queryItem=function(a,b,c){var d=this.getPivotCacheByName(a);return this.Rlc.$kc(d,this.Rlc.Ha(d,b),b,c)},a.prototype.getCalcFields=function(a){var b=this.getPivotCacheByName(a);return b?b.UNc():[]},a.prototype.addGroup=function(a,b){var c=this.getPivotCacheByName(a);return!!c&&c.uic(b)},a.prototype.fromJson=function(a){var b,c,f=this;this.Rlc=new e.DataAnalyzer;for(b in a)a.hasOwnProperty(b)&&(c=new d.PivotCache,c.fromJson(b,a[b],f),f.addPivotCache(c))},a.prototype.toJson=function(a,b){var c,d,e,g,h=this.Plc,i={};for(c=0,d=b;c<d.length;c++)e=d[c],g=h[e],f.Fa(g)||(i[g.mEc]=g.toJson(a[e]));return i},a}(),b.PivotEngine=g},"./src/pivot-interface.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.item=0]="item",a[a.next=1]="next",a[a.previous=2]="previous"}(d=b.PivotShowDataAsBaseItemType||(b.PivotShowDataAsBaseItemType={})),function(a){a[a.isCalcField=0]="isCalcField",a[a.isGroupField=1]="isGroupField"}(e=b.PivotSourceFieldType||(b.PivotSourceFieldType={})),function(a){a[a.average=0]="average",a[a.count=1]="count",a[a.countNums=2]="countNums",a[a.max=3]="max",a[a.min=4]="min",a[a.product=5]="product",a[a.stdDev=6]="stdDev",a[a.stdDevp=7]="stdDevp",a[a.sum=8]="sum",a[a.varr=9]="varr",a[a.varp=10]="varp"}(f=b.SubtotalType||(b.SubtotalType={})),function(a){a[a.number=0]="number",a[a.string=1]="string",a[a.date=2]="date",a[a.boolean=3]="boolean",a[a.errorValue=4]="errorValue",a[a.noValue=5]="noValue"}(g=b.PivotDataType||(b.PivotDataType={})),function(a){a[a.caption=0]="caption",a[a.date=1]="date",a[a.value=2]="value",a[a.top10=3]="top10"}(h=b.PivotConditionType||(b.PivotConditionType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(i=b.PivotValueFilterOperator||(b.PivotValueFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain",a[a.greaterThan=8]="greaterThan",a[a.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",a[a.lessThan=10]="lessThan",a[a.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",a[a.between=12]="between",a[a.notBetween=13]="notBetween"}(j=b.PivotCaptionFilterOperator||(b.PivotCaptionFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo",a[a.Between=6]="Between",a[a.notBetween=7]="notBetween",a[a.today=8]="today",a[a.yesterday=9]="yesterday",a[a.tomorrow=10]="tomorrow",a[a.last7Days=11]="last7Days",a[a.thisMonth=12]="thisMonth",a[a.lastMonth=13]="lastMonth",a[a.nextMonth=14]="nextMonth",a[a.thisWeek=15]="thisWeek",a[a.lastWeek=16]="lastWeek",a[a.nextWeek=17]="nextWeek",a[a.nextQuarter=18]="nextQuarter",a[a.thisQuarter=19]="thisQuarter",a[a.lastQuarter=20]="lastQuarter",a[a.nextYear=21]="nextYear",a[a.thisYear=22]="thisYear",a[a.lastYear=23]="lastYear",a[a.Q1=24]="Q1",a[a.Q2=25]="Q2",a[a.Q3=26]="Q3",a[a.Q4=27]="Q4",a[a.M1=28]="M1",a[a.M2=29]="M2",a[a.M3=30]="M3",a[a.M4=31]="M4",a[a.M5=32]="M5",a[a.M6=33]="M6",a[a.M7=34]="M7",a[a.M8=35]="M8",a[a.M9=36]="M9",a[a.M10=37]="M10",a[a.M11=38]="M11",a[a.M12=39]="M12",a[a.yearToDate=40]="yearToDate"}(k=b.PivotDateFilterOperator||(b.PivotDateFilterOperator={})),function(a){a[a.count=0]="count",a[a.percent=1]="percent",a[a.sum=2]="sum"}(l=b.PivotTop10FilterType||(b.PivotTop10FilterType={})),function(a){a[a.top=1]="top",a[a.bottom=-1]="bottom"}(m=b.PivotTop10FilterOperator||(b.PivotTop10FilterOperator={})),function(a){a[a.row=0]="row",a[a.col=1]="col",a[a.none=2]="none"}(n=b.DataPosition||(b.DataPosition={})),function(a){a[a.seconds=0]="seconds",a[a.minutes=1]="minutes",a[a.hours=2]="hours",a[a.days=3]="days",a[a.months=4]="months",a[a.quarters=5]="quarters",a[a.years=6]="years"}(o=b.DateGroupType||(b.DateGroupType={})),function(a){a[a.normal=0]="normal",a[a.percentOfTotal=1]="percentOfTotal",a[a.percentOfRow=2]="percentOfRow",a[a.percentOfCol=3]="percentOfCol",a[a.percent=4]="percent",a[a.percentOfParentRow=5]="percentOfParentRow",a[a.percentOfParentCol=6]="percentOfParentCol",a[a.percentOfParent=7]="percentOfParent",a[a.difference=8]="difference",a[a.percentDiff=9]="percentDiff",a[a.runTotal=10]="runTotal",a[a.percentOfRunningTotal=11]="percentOfRunningTotal",a[a.rankAscending=12]="rankAscending",a[a.rankDescending=13]="rankDescending",a[a.index=14]="index"}(p=b.PivotShowDataAs||(b.PivotShowDataAs={})),function(a){a[a.asc=0]="asc",a[a.desc=1]="desc",a[a.custom=2]="custom"}(q=b.SortType||(b.SortType={}))},"./src/pivot-sort.ts":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./src/pivot-util.ts"),g=c("./pivot-entry.ts"),h=new d.Common.ResourceManager(g.SR),i=h.getResource.bind(h),b.kSc=function(a,b){var c,d;return a===b?0:(c=+a,d=+b,d&&c?c>d?1:-1:(""+a).localeCompare(b+""))},b.lSc=function(a,b){return a>=b?1:-1},b.mSc=function(a,b){return a.getMonth()>=b.getMonth()?1:-1},b.nSc=function(a,b){return Math.floor(a.getMonth()/3)>=Math.floor(b.getMonth()/3)?1:-1},b.oSc=function(a,b){return a>=b?1:-1},b.pSc=function(a,c){var d,g,h,k,l,m,n,o=i().blank;switch(c){case e.DateGroupType.years:a.sort(b.kSc),d=a;break;default:g=j(c),d=g.concat([])}for(l=0,m=!1,n=0;n<a.length;n++)a[n]&&a[n]!==o?a[n].indexOf(f.LESS)>-1?(h=a[n],l++):a[n].indexOf(f.MORE)>-1&&(k=a[n],l++):m=!0;return c===e.DateGroupType.years&&(d=d.splice(l)),h&&d.unshift(h),k&&d.push(k),m&&d.unshift(o),d},b.jWc=function(a){var c,d,e,g,h=[],i={},j=[];for(c=0,d=a.length;c<d;c++)e=void 0,e=a[c].indexOf(f.LESS)>-1?f.LESS:a[c].indexOf(f.MORE)>-1?f.MORE:f.NUMBER_GROUP_SEPARATOR,g=a[c].split(e)[1],h.push(g),i[g]=c;for(h.sort(b.kSc),c=0,d=h.length;c<d;c++)j.push(a[i[h[c]]]);return j};function j(a){var b,c,d=[];switch(a){case e.DateGroupType.quarters:for(b=0;b<f.quartersGroupItemsKey.length;b++)d.push(i().dateResource[f.quartersGroupItemsKey[b]]);break;case e.DateGroupType.months:for(b=0;b<f.monthsGroupItemsKey.length;b++)d.push(i().dateResource[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.days:for(b=0;b<f.monthsGroupItemsKey.length;b++)for(c=1;c<f.dayCountPerMonth[b];c++)d.push(c+"-"+i().dateResource[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.hours:for(b=0;b<f.HOUR_GROUP_ITEMS.length;b++)d.push(f.HOUR_GROUP_ITEMS[b]);break;case e.DateGroupType.minutes:case e.DateGroupType.seconds:for(b=0;b<f.SECOND_GROUP_ITEMS.length;b++)d.push(f.SECOND_GROUP_ITEMS[b])}return d}b._Rc=function(a,c){var d,e,h,j;if(c.isDate)f.Fa(c.by)?a.sort(function(a,b){return new Date(a)>new Date(b)?1:-1}):a=b.pSc(a,c.by);else if(c.isNumberGroup)a=b.jWc(a);else{for(d=[],e=[],h=[],j=0;j<a.length;j++)a[j]!==i().blank?"number"==typeof a[j]?d.push(a[j]):e.push(a[j]):h.push(a[j]);d.length>1&&d.sort(function(a,b){return a-b}),e.length>1&&e.sort(function(a,b){return g.JWc(a,b)}),a=d.concat(e,h)}return a}},"./src/pivot-util.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./pivot-entry.ts"),g=Math.min,h=Math.max,i=Math.abs,j=Math.pow,k=Math.sqrt,l=Math.floor,m=Math.ceil,n=!0,o=new d.Common.ResourceManager(f.SR),p=o.getResource.bind(o),b.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],b.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],b.SECOND_GROUP_ITEMS=[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],b.HOUR_GROUP_ITEMS=[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23"],q=d.Common.CultureManager,r=d.Common.l,b.LESS="<",b.MORE=">",b.NUMBER_GROUP_SEPARATOR="-",s=function(){function a(){}return a.qb=function(b){var c=a.rb[b];return c||(c=a.rb[b]=RegExp(b,"g")),c.lastIndex=0,c},a.ub=function(b,c,d){var e,f,g,h,i,j;if(a.vb[b])return a.wb[b];if(e="[~?*]+",a.qb(e).test(b)){for(f=[],g=b.split(""),h=void 0,i={".":n,"+":n,$:n,"^":n,"[":n,"]":n,"(":n,")":n,"{":n,"}":n,"|":n,"/":n},j=0;j<g.length;j++)h=g[j],"~"===h&&j<g.length-1?(j++,h=g[j],"*"===h||"?"===h?f.push("\\"):c&&f.push("~"),f.push(h)):"?"===h?f.push("."):"*"===h?(f.push("[\\s\\S]"),d?f.push("+"):f.push("*")):i[h]?(f.push("\\"),f.push(h)):f.push(h);return f.join("")}return null},a.zb=function(b,c,d){var e=a.ub(b,c,d);return e&&(e="^"+e+"$"),e},a.Ab=function(a){return a.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},a.rb={},a.vb={},a.wb={},a}(),b.aEc=s;function t(a,b,c,d,e){var f=s.ub(b);return f?(f=c+f+d,s.qb(f).test(a)):e()}function u(a,b){return a.splice.apply(a,[a.length,b.length].concat(b)),a.sort(function(a,b){return a-b}),a}b.uIc=u;function v(a){var b,c,d,e,f,g;if(!a||a&&0===a.length)return[];for(b=a[0],c=a.length,d={},z(b,function(a){d[a]=1}),e=function(b){var c={},e=!0;if(z(a[b],function(a){d[a]&&(c[a]=1,e=!1)}),d=c,e)return{value:[]}},f=1;f<c;f++)if(g=e(f),"object"==typeof g)return g.value;return Object.keys(d)}b.kic=v;function w(a,b){var c,d=[],e=0;for(c=0;c<a.length;c++)for(;e<b.length;){if(!(a[c]>b[e])){if(a[c]===b[e]){d.push(a[c]);break}break}e++}return d;
}function x(a){var b,c,d=a[0];for(b=1,c=a.length;b<c&&(d=w(d,a[b]),0!==d.length);b++);return d}function y(a,b){var c,d,e=!1;for(c=0,d=a.length;c<d;c++)b===a[c]&&(e=!0);return e}b.Dlc=y;function z(a,b){var c,d,e=a.length;for(c=0;c<e&&!(d=b(a[c],c));c++);}b.vhc=z;function A(a){var b,c=[];for(b=0;b<a.length;b++)c=c.concat(a[b]);return c}b.Wlc=A;function B(a){return void 0===a||null===a}b.Fa=B;function C(a){return"string"==typeof a}b.jk=C;function D(a){return!B(a)&&(C(a)&&(a=parseFloat(a)),a===a&&isFinite(a))}b.Da=D;function E(a){return a<10?"0"+a:a+""}function F(a){var b;try{b=a.getFullYear()+"-"+E(a.getMonth()+1)+"-"+E(a.getDate())+"T"+E(a.getHours())+":"+E(a.getMinutes())+":"+E(a.getSeconds())}catch(a){}return b}b.oIc=F;function G(a){return a.getUTCFullYear()+"/"+E(a.getUTCMonth()+1)+"/"+E(a.getUTCDate())}b.pIc=G;function H(a,b){return b.slice(0,a.length).toLowerCase()===a.toLowerCase()}b.bEc=H;function I(a,b){return t(a,b,"^","",function(){return H(a,b)})}b.Ilc=I;function J(a,b){return b.slice(-a.length).toLowerCase()===a.toLowerCase()}b.cEc=J;function K(a,b){return t(a,b,"","$",function(){return J(a,b)})}b.Jlc=K;function L(a,b){return""===b||a.toLowerCase().indexOf(b.toLowerCase())>=0}b.dEc=L;function M(a,b){return t(a,b,"","",function(){return L(b,B(a)?"":a)})}b.Klc=M;function N(a,b){return a.toLowerCase()===b.toLowerCase()}b.eEc=N;function O(a,b){return t(b,a,"","",function(){return N(b,B(a)?"":a)})}b._Dc=O,b.PRE_DAY=864e5;function P(a){var b,c,d;return a&&a instanceof Date?(b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),new Date(b,c,d)):a}b.Llc=P;function Q(a){return"string"==typeof a}b.isString=Q;function R(a){var c=p().dateResource;return c[b.monthsGroupItemsKey[a.getMonth()]]}function S(a){var c=p().dateResource;return c[b.quartersGroupItemsKey[Math.floor(a.getMonth()/3)]]}function T(){var a,c,d=[],e=p().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)d.push(e[b.monthsGroupItemsKey[a]]);return d}b.wIc=T;function U(){var a,c,d,e,f=[],g=p().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)for(d=0,e=b.dayCountPerMonth[a];d<e;d++)f.push(d+1+"-"+g[b.monthsGroupItemsKey[a]]);return f}b.vIc=U;function V(){var a,c,d=[],e=p().dateResource;for(a=0,c=b.quartersGroupItemsKey.length;a<c;a++)d.push(e[b.quartersGroupItemsKey[a]]);return d}b.xIc=V;function W(a,c){var d,e,f,g;return B(c)?p().blank:(d=a.Tlc,e=a.jSc,f=a.Vlc,c<d?b.LESS+d:c>=e?b.MORE+e:(g=d+Math.floor((c-d)/f)*f,g+"-"+(g+f-1)))}b.getNumberGroupItemKey=W;function X(a,b){var c,d;switch(a){case e.DateGroupType.seconds:return c=b.getSeconds(),c<10?":0"+c:":"+c;case e.DateGroupType.minutes:return d=b.getMinutes(),d<10?":0"+d:":"+d;case e.DateGroupType.hours:return""+b.getHours();case e.DateGroupType.days:return b.getDate()+"-"+R(b);case e.DateGroupType.months:return R(b);case e.DateGroupType.quarters:return S(b);case e.DateGroupType.years:return""+b.getFullYear();default:return F(b)}}function Y(a){var b=q.q4(q.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),r.Vb(a,c)}b.formatDateToString=Y;function Z(a,b){if(B(b)||b===p().blank)return p().blank;var c=a.Tlc,d=a.Ulc,e=a.Vlc,f=new Date;return"number"!=typeof b&&"string"!=typeof b||(f=new Date(b)),f<c?"<"+Y(c):f>d?">"+Y(d):X(e,f)}b.getDateGroupItemKey=Z;function $(a){if(!a||"object"!=typeof a)return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}b.isEmptyObject=$,b.lRc=function(a,b){var c,d,e,f,g;if(!a)return a;c=[];for(d in a)a.hasOwnProperty(d)&&c.push(+d);for(c.sort(function(a,c){return(a-c)*b}),e={},f=0,g=c.length;f<g;f++)e[c[f]]=f+1;return e};function _(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=_(a[c]);return b}if(e){b=void 0;for(c in a)B(a[c])||(void 0===b&&(b={}),b[c]=_(a[c]));return b}return a}b.GNc=_;function aa(a,b){var c,e;try{e=d.Common.CultureManager.getCultureInfo(),c=e.localeCompare?e.localeCompare(a,b):a.localeCompare(b,"en")}catch(d){c=a.localeCompare(b)}return c}b.JWc=aa},"./src/pivotEngine.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years"},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),function(c){"object"==typeof a.exports?a.exports=c.Pivot:(d=[],e=function(){return c.Pivot}.apply(b,d),!(void 0!==e&&(a.exports=e)))}(f||{})},"@grapecity/js-calc":function(b,c){b.exports=a.Spread.CalcEngine},"@grapecity/js-sheets-common":function(b,c){b.exports=a.Spread},CellTypes:function(b,c){b.exports=a.Spread.Sheets.CellTypes},ConditionalFormatting:function(b,c){b.exports=a.Spread.Sheets.ConditionalFormatting},Core:function(b,c){b.exports=a.Spread.Sheets},Pivot:function(b,c){b.exports=a.Pivot},SheetsCalc:function(b,c){b.exports=a.Spread.Sheets.CalcEngine}})});